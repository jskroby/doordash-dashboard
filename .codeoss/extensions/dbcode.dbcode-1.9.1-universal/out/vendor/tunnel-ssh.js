var je=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Fr=je((_d,Lo)=>{Lo.exports={newInvalidAsn1Error:function(n){var t=new Error;return t.name="InvalidAsn1Error",t.message=n||"",t}}});var Qr=je((Hd,mo)=>{mo.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var Pi=je((Ed,No)=>{"use strict";var Mr=require("buffer"),Pn=Mr.Buffer,Qt={},Mt;for(Mt in Mr)Mr.hasOwnProperty(Mt)&&(Mt==="SlowBuffer"||Mt==="Buffer"||(Qt[Mt]=Mr[Mt]));var Un=Qt.Buffer={};for(Mt in Pn)Pn.hasOwnProperty(Mt)&&(Mt==="allocUnsafe"||Mt==="allocUnsafeSlow"||(Un[Mt]=Pn[Mt]));Qt.Buffer.prototype=Pn.prototype;(!Un.from||Un.from===Uint8Array.from)&&(Un.from=function(n,t,e){if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof n);if(n&&typeof n.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);return Pn(n,t,e)});Un.alloc||(Un.alloc=function(n,t,e){if(typeof n!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof n);if(n<0||n>=2*(1<<30))throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=Pn(n);return!t||t.length===0?r.fill(0):typeof e=="string"?r.fill(t,e):r.fill(t),r});if(!Qt.kStringMaxLength)try{Qt.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}Qt.constants||(Qt.constants={MAX_LENGTH:Qt.kMaxLength},Qt.kStringMaxLength&&(Qt.constants.MAX_STRING_LENGTH=Qt.kStringMaxLength));No.exports=Qt});var Ro=je((gd,ko)=>{var Ac=require("assert"),Bo=Pi().Buffer,ar=Qr(),_c=Fr(),On=_c.newInvalidAsn1Error;function Nt(n){if(!n||!Bo.isBuffer(n))throw new TypeError("data must be a node Buffer");this._buf=n,this._size=n.length,this._len=0,this._offset=0}Object.defineProperty(Nt.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(Nt.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(Nt.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Nt.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Nt.prototype.readByte=function(n){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return n||(this._offset+=1),t};Nt.prototype.peek=function(){return this.readByte(!0)};Nt.prototype.readLength=function(n){if(n===void 0&&(n=this._offset),n>=this._size)return null;var t=this._buf[n++]&255;if(t===null)return null;if((t&128)===128){if(t&=127,t===0)throw On("Indefinite length not supported");if(t>4)throw On("encoding too long");if(this._size-n<t)return null;this._len=0;for(var e=0;e<t;e++)this._len=(this._len<<8)+(this._buf[n++]&255)}else this._len=t;return n};Nt.prototype.readSequence=function(n){var t=this.peek();if(t===null)return null;if(n!==void 0&&n!==t)throw On("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);return e===null?null:(this._offset=e,t)};Nt.prototype.readInt=function(){return this._readTag(ar.Integer)};Nt.prototype.readBoolean=function(){return this._readTag(ar.Boolean)!==0};Nt.prototype.readEnumeration=function(){return this._readTag(ar.Enumeration)};Nt.prototype.readString=function(n,t){n||(n=ar.OctetString);var e=this.peek();if(e===null)return null;if(e!==n)throw On("Expected 0x"+n.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(r===null||this.length>this._size-r)return null;if(this._offset=r,this.length===0)return t?Bo.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?i:i.toString("utf8")};Nt.prototype.readOID=function(n){n||(n=ar.OID);var t=this.readString(n,!0);if(t===null)return null;for(var e=[],r=0,i=0;i<t.length;i++){var s=t[i]&255;r<<=7,r+=s&127,(s&128)===0&&(e.push(r),r=0)}return r=e.shift(),e.unshift(r%40),e.unshift(r/40>>0),e.join(".")};Nt.prototype._readTag=function(n){Ac.ok(n!==void 0);var t=this.peek();if(t===null)return null;if(t!==n)throw On("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);if(e===null)return null;if(this.length>4)throw On("Integer too long: "+this.length);if(this.length>this._size-e)return null;this._offset=e;for(var r=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(r&128)===128&&s!==4&&(i-=1<<s*8),i>>0};ko.exports=Nt});var Do=je((pd,vo)=>{var an=require("assert"),Gr=Pi().Buffer,cn=Qr(),Hc=Fr(),Kr=Hc.newInvalidAsn1Error,Ec={size:1024,growthFactor:8};function gc(n,t){an.ok(n),an.equal(typeof n,"object"),an.ok(t),an.equal(typeof t,"object");var e=Object.getOwnPropertyNames(n);return e.forEach(function(r){if(!t[r]){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i)}}),t}function Lt(n){n=gc(Ec,n||{}),this._buf=Gr.alloc(n.size||1024),this._size=this._buf.length,this._offset=0,this._options=n,this._seq=[]}Object.defineProperty(Lt.prototype,"buffer",{get:function(){if(this._seq.length)throw Kr(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Lt.prototype.writeByte=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=n};Lt.prototype.writeInt=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");typeof t!="number"&&(t=cn.Integer);for(var e=4;((n&4286578688)===0||(n&4286578688)===-8388608)&&e>1;)e--,n<<=8;if(e>4)throw Kr("BER ints cannot be > 0xffffffff");for(this._ensure(2+e),this._buf[this._offset++]=t,this._buf[this._offset++]=e;e-- >0;)this._buf[this._offset++]=(n&4278190080)>>>24,n<<=8};Lt.prototype.writeNull=function(){this.writeByte(cn.Null),this.writeByte(0)};Lt.prototype.writeEnumeration=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");return typeof t!="number"&&(t=cn.Enumeration),this.writeInt(n,t)};Lt.prototype.writeBoolean=function(n,t){if(typeof n!="boolean")throw new TypeError("argument must be a Boolean");typeof t!="number"&&(t=cn.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=n?255:0};Lt.prototype.writeString=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string (was: "+typeof n+")");typeof t!="number"&&(t=cn.OctetString);var e=Gr.byteLength(n);this.writeByte(t),this.writeLength(e),e&&(this._ensure(e),this._buf.write(n,this._offset),this._offset+=e)};Lt.prototype.writeBuffer=function(n,t){if(typeof t!="number")throw new TypeError("tag must be a number");if(!Gr.isBuffer(n))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(n.length),this._ensure(n.length),n.copy(this._buf,this._offset,0,n.length),this._offset+=n.length};Lt.prototype.writeStringArray=function(n){if(!n instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;n.forEach(function(e){t.writeString(e)})};Lt.prototype.writeOID=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string");if(typeof t!="number"&&(t=cn.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(n))throw new Error("argument is not a valid OID string");function e(o,f){f<128?o.push(f):f<16384?(o.push(f>>>7|128),o.push(f&127)):f<2097152?(o.push(f>>>14|128),o.push((f>>>7|128)&255),o.push(f&127)):f<268435456?(o.push(f>>>21|128),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127)):(o.push((f>>>28|128)&255),o.push((f>>>21|128)&255),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127))}var r=n.split("."),i=[];i.push(parseInt(r[0],10)*40+parseInt(r[1],10)),r.slice(2).forEach(function(o){e(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};Lt.prototype.writeLength=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),n<=127)this._buf[this._offset++]=n;else if(n<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=n;else if(n<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else if(n<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=n>>16,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else throw Kr("Length too long (> 4 bytes)")};Lt.prototype.startSequence=function(n){typeof n!="number"&&(n=cn.Sequence|cn.Constructor),this.writeByte(n),this._seq.push(this._offset),this._ensure(3),this._offset+=3};Lt.prototype.endSequence=function(){var n=this._seq.pop(),t=n+3,e=this._offset-t;if(e<=127)this._shift(t,e,-2),this._buf[n]=e;else if(e<=255)this._shift(t,e,-1),this._buf[n]=129,this._buf[n+1]=e;else if(e<=65535)this._buf[n]=130,this._buf[n+1]=e>>8,this._buf[n+2]=e;else if(e<=16777215)this._shift(t,e,1),this._buf[n]=131,this._buf[n+1]=e>>16,this._buf[n+2]=e>>8,this._buf[n+3]=e;else throw Kr("Sequence too long")};Lt.prototype._shift=function(n,t,e){an.ok(n!==void 0),an.ok(t!==void 0),an.ok(e),this._buf.copy(this._buf,n+e,n,n+t),this._offset+=e};Lt.prototype._ensure=function(n){if(an.ok(n),this._size-this._offset<n){var t=this._size*this._options.growthFactor;t-this._offset<n&&(t+=n);var e=Gr.alloc(t);this._buf.copy(e,0,0,this._offset),this._buf=e,this._size=t}};vo.exports=Lt});var To=je((Id,Xr)=>{var Ui=Fr(),Oi=Qr(),pc=Ro(),Ic=Do();Xr.exports={Reader:pc,Writer:Ic};for(Wr in Oi)Oi.hasOwnProperty(Wr)&&(Xr.exports[Wr]=Oi[Wr]);var Wr;for(qr in Ui)Ui.hasOwnProperty(qr)&&(Xr.exports[qr]=Ui[qr]);var qr});var cr=je((bd,Po)=>{var Fi=To();Po.exports={Ber:Fi,BerReader:Fi.Reader,BerWriter:Fi.Writer}});var Uo=je((xd,Vr)=>{(function(n){"use strict";var t=function(u){var _,A=new Float64Array(16);if(u)for(_=0;_<u.length;_++)A[_]=u[_];return A},e=function(){throw new Error("no PRNG")},r=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var s=t(),o=t([1]),f=t([56129,1]),a=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),H=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(u,_,A,c){u[_]=A>>24&255,u[_+1]=A>>16&255,u[_+2]=A>>8&255,u[_+3]=A&255,u[_+4]=c>>24&255,u[_+5]=c>>16&255,u[_+6]=c>>8&255,u[_+7]=c&255}function I(u,_,A,c,E){var C,N=0;for(C=0;C<E;C++)N|=u[_+C]^A[c+C];return(1&N-1>>>8)-1}function b(u,_,A,c){return I(u,_,A,c,16)}function L(u,_,A,c){return I(u,_,A,c,32)}function B(u,_,A,c){for(var E=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,C=A[0]&255|(A[1]&255)<<8|(A[2]&255)<<16|(A[3]&255)<<24,N=A[4]&255|(A[5]&255)<<8|(A[6]&255)<<16|(A[7]&255)<<24,W=A[8]&255|(A[9]&255)<<8|(A[10]&255)<<16|(A[11]&255)<<24,ne=A[12]&255|(A[13]&255)<<8|(A[14]&255)<<16|(A[15]&255)<<24,he=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,fe=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,$e=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,ce=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,me=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,Ne=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,De=A[16]&255|(A[17]&255)<<8|(A[18]&255)<<16|(A[19]&255)<<24,ve=A[20]&255|(A[21]&255)<<8|(A[22]&255)<<16|(A[23]&255)<<24,Be=A[24]&255|(A[25]&255)<<8|(A[26]&255)<<16|(A[27]&255)<<24,Re=A[28]&255|(A[29]&255)<<8|(A[30]&255)<<16|(A[31]&255)<<24,ke=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,ue=E,Ee=C,ae=N,de=W,_e=ne,oe=he,v=fe,D=$e,X=ce,K=me,q=Ne,j=De,xe=ve,Te=Be,Ue=Re,Pe=ke,p,Fe=0;Fe<20;Fe+=2)p=ue+xe|0,_e^=p<<7|p>>>25,p=_e+ue|0,X^=p<<9|p>>>23,p=X+_e|0,xe^=p<<13|p>>>19,p=xe+X|0,ue^=p<<18|p>>>14,p=oe+Ee|0,K^=p<<7|p>>>25,p=K+oe|0,Te^=p<<9|p>>>23,p=Te+K|0,Ee^=p<<13|p>>>19,p=Ee+Te|0,oe^=p<<18|p>>>14,p=q+v|0,Ue^=p<<7|p>>>25,p=Ue+q|0,ae^=p<<9|p>>>23,p=ae+Ue|0,v^=p<<13|p>>>19,p=v+ae|0,q^=p<<18|p>>>14,p=Pe+j|0,de^=p<<7|p>>>25,p=de+Pe|0,D^=p<<9|p>>>23,p=D+de|0,j^=p<<13|p>>>19,p=j+D|0,Pe^=p<<18|p>>>14,p=ue+de|0,Ee^=p<<7|p>>>25,p=Ee+ue|0,ae^=p<<9|p>>>23,p=ae+Ee|0,de^=p<<13|p>>>19,p=de+ae|0,ue^=p<<18|p>>>14,p=oe+_e|0,v^=p<<7|p>>>25,p=v+oe|0,D^=p<<9|p>>>23,p=D+v|0,_e^=p<<13|p>>>19,p=_e+D|0,oe^=p<<18|p>>>14,p=q+K|0,j^=p<<7|p>>>25,p=j+q|0,X^=p<<9|p>>>23,p=X+j|0,K^=p<<13|p>>>19,p=K+X|0,q^=p<<18|p>>>14,p=Pe+Ue|0,xe^=p<<7|p>>>25,p=xe+Pe|0,Te^=p<<9|p>>>23,p=Te+xe|0,Ue^=p<<13|p>>>19,p=Ue+Te|0,Pe^=p<<18|p>>>14;ue=ue+E|0,Ee=Ee+C|0,ae=ae+N|0,de=de+W|0,_e=_e+ne|0,oe=oe+he|0,v=v+fe|0,D=D+$e|0,X=X+ce|0,K=K+me|0,q=q+Ne|0,j=j+De|0,xe=xe+ve|0,Te=Te+Be|0,Ue=Ue+Re|0,Pe=Pe+ke|0,u[0]=ue>>>0&255,u[1]=ue>>>8&255,u[2]=ue>>>16&255,u[3]=ue>>>24&255,u[4]=Ee>>>0&255,u[5]=Ee>>>8&255,u[6]=Ee>>>16&255,u[7]=Ee>>>24&255,u[8]=ae>>>0&255,u[9]=ae>>>8&255,u[10]=ae>>>16&255,u[11]=ae>>>24&255,u[12]=de>>>0&255,u[13]=de>>>8&255,u[14]=de>>>16&255,u[15]=de>>>24&255,u[16]=_e>>>0&255,u[17]=_e>>>8&255,u[18]=_e>>>16&255,u[19]=_e>>>24&255,u[20]=oe>>>0&255,u[21]=oe>>>8&255,u[22]=oe>>>16&255,u[23]=oe>>>24&255,u[24]=v>>>0&255,u[25]=v>>>8&255,u[26]=v>>>16&255,u[27]=v>>>24&255,u[28]=D>>>0&255,u[29]=D>>>8&255,u[30]=D>>>16&255,u[31]=D>>>24&255,u[32]=X>>>0&255,u[33]=X>>>8&255,u[34]=X>>>16&255,u[35]=X>>>24&255,u[36]=K>>>0&255,u[37]=K>>>8&255,u[38]=K>>>16&255,u[39]=K>>>24&255,u[40]=q>>>0&255,u[41]=q>>>8&255,u[42]=q>>>16&255,u[43]=q>>>24&255,u[44]=j>>>0&255,u[45]=j>>>8&255,u[46]=j>>>16&255,u[47]=j>>>24&255,u[48]=xe>>>0&255,u[49]=xe>>>8&255,u[50]=xe>>>16&255,u[51]=xe>>>24&255,u[52]=Te>>>0&255,u[53]=Te>>>8&255,u[54]=Te>>>16&255,u[55]=Te>>>24&255,u[56]=Ue>>>0&255,u[57]=Ue>>>8&255,u[58]=Ue>>>16&255,u[59]=Ue>>>24&255,u[60]=Pe>>>0&255,u[61]=Pe>>>8&255,u[62]=Pe>>>16&255,u[63]=Pe>>>24&255}function U(u,_,A,c){for(var E=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,C=A[0]&255|(A[1]&255)<<8|(A[2]&255)<<16|(A[3]&255)<<24,N=A[4]&255|(A[5]&255)<<8|(A[6]&255)<<16|(A[7]&255)<<24,W=A[8]&255|(A[9]&255)<<8|(A[10]&255)<<16|(A[11]&255)<<24,ne=A[12]&255|(A[13]&255)<<8|(A[14]&255)<<16|(A[15]&255)<<24,he=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,fe=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,$e=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,ce=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,me=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,Ne=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,De=A[16]&255|(A[17]&255)<<8|(A[18]&255)<<16|(A[19]&255)<<24,ve=A[20]&255|(A[21]&255)<<8|(A[22]&255)<<16|(A[23]&255)<<24,Be=A[24]&255|(A[25]&255)<<8|(A[26]&255)<<16|(A[27]&255)<<24,Re=A[28]&255|(A[29]&255)<<8|(A[30]&255)<<16|(A[31]&255)<<24,ke=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,ue=E,Ee=C,ae=N,de=W,_e=ne,oe=he,v=fe,D=$e,X=ce,K=me,q=Ne,j=De,xe=ve,Te=Be,Ue=Re,Pe=ke,p,Fe=0;Fe<20;Fe+=2)p=ue+xe|0,_e^=p<<7|p>>>25,p=_e+ue|0,X^=p<<9|p>>>23,p=X+_e|0,xe^=p<<13|p>>>19,p=xe+X|0,ue^=p<<18|p>>>14,p=oe+Ee|0,K^=p<<7|p>>>25,p=K+oe|0,Te^=p<<9|p>>>23,p=Te+K|0,Ee^=p<<13|p>>>19,p=Ee+Te|0,oe^=p<<18|p>>>14,p=q+v|0,Ue^=p<<7|p>>>25,p=Ue+q|0,ae^=p<<9|p>>>23,p=ae+Ue|0,v^=p<<13|p>>>19,p=v+ae|0,q^=p<<18|p>>>14,p=Pe+j|0,de^=p<<7|p>>>25,p=de+Pe|0,D^=p<<9|p>>>23,p=D+de|0,j^=p<<13|p>>>19,p=j+D|0,Pe^=p<<18|p>>>14,p=ue+de|0,Ee^=p<<7|p>>>25,p=Ee+ue|0,ae^=p<<9|p>>>23,p=ae+Ee|0,de^=p<<13|p>>>19,p=de+ae|0,ue^=p<<18|p>>>14,p=oe+_e|0,v^=p<<7|p>>>25,p=v+oe|0,D^=p<<9|p>>>23,p=D+v|0,_e^=p<<13|p>>>19,p=_e+D|0,oe^=p<<18|p>>>14,p=q+K|0,j^=p<<7|p>>>25,p=j+q|0,X^=p<<9|p>>>23,p=X+j|0,K^=p<<13|p>>>19,p=K+X|0,q^=p<<18|p>>>14,p=Pe+Ue|0,xe^=p<<7|p>>>25,p=xe+Pe|0,Te^=p<<9|p>>>23,p=Te+xe|0,Ue^=p<<13|p>>>19,p=Ue+Te|0,Pe^=p<<18|p>>>14;u[0]=ue>>>0&255,u[1]=ue>>>8&255,u[2]=ue>>>16&255,u[3]=ue>>>24&255,u[4]=oe>>>0&255,u[5]=oe>>>8&255,u[6]=oe>>>16&255,u[7]=oe>>>24&255,u[8]=q>>>0&255,u[9]=q>>>8&255,u[10]=q>>>16&255,u[11]=q>>>24&255,u[12]=Pe>>>0&255,u[13]=Pe>>>8&255,u[14]=Pe>>>16&255,u[15]=Pe>>>24&255,u[16]=v>>>0&255,u[17]=v>>>8&255,u[18]=v>>>16&255,u[19]=v>>>24&255,u[20]=D>>>0&255,u[21]=D>>>8&255,u[22]=D>>>16&255,u[23]=D>>>24&255,u[24]=X>>>0&255,u[25]=X>>>8&255,u[26]=X>>>16&255,u[27]=X>>>24&255,u[28]=K>>>0&255,u[29]=K>>>8&255,u[30]=K>>>16&255,u[31]=K>>>24&255}function J(u,_,A,c){B(u,_,A,c)}function T(u,_,A,c){U(u,_,A,c)}var Z=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ee(u,_,A,c,E,C,N){var W=new Uint8Array(16),ne=new Uint8Array(64),he,fe;for(fe=0;fe<16;fe++)W[fe]=0;for(fe=0;fe<8;fe++)W[fe]=C[fe];for(;E>=64;){for(J(ne,W,N,Z),fe=0;fe<64;fe++)u[_+fe]=A[c+fe]^ne[fe];for(he=1,fe=8;fe<16;fe++)he=he+(W[fe]&255)|0,W[fe]=he&255,he>>>=8;E-=64,_+=64,c+=64}if(E>0)for(J(ne,W,N,Z),fe=0;fe<E;fe++)u[_+fe]=A[c+fe]^ne[fe];return 0}function $(u,_,A,c,E){var C=new Uint8Array(16),N=new Uint8Array(64),W,ne;for(ne=0;ne<16;ne++)C[ne]=0;for(ne=0;ne<8;ne++)C[ne]=c[ne];for(;A>=64;){for(J(N,C,E,Z),ne=0;ne<64;ne++)u[_+ne]=N[ne];for(W=1,ne=8;ne<16;ne++)W=W+(C[ne]&255)|0,C[ne]=W&255,W>>>=8;A-=64,_+=64}if(A>0)for(J(N,C,E,Z),ne=0;ne<A;ne++)u[_+ne]=N[ne];return 0}function x(u,_,A,c,E){var C=new Uint8Array(32);T(C,c,E,Z);for(var N=new Uint8Array(8),W=0;W<8;W++)N[W]=c[W+16];return $(u,_,A,N,C)}function S(u,_,A,c,E,C,N){var W=new Uint8Array(32);T(W,C,N,Z);for(var ne=new Uint8Array(8),he=0;he<8;he++)ne[he]=C[he+16];return ee(u,_,A,c,E,ne,W)}var R=function(u){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var _,A,c,E,C,N,W,ne;_=u[0]&255|(u[1]&255)<<8,this.r[0]=_&8191,A=u[2]&255|(u[3]&255)<<8,this.r[1]=(_>>>13|A<<3)&8191,c=u[4]&255|(u[5]&255)<<8,this.r[2]=(A>>>10|c<<6)&7939,E=u[6]&255|(u[7]&255)<<8,this.r[3]=(c>>>7|E<<9)&8191,C=u[8]&255|(u[9]&255)<<8,this.r[4]=(E>>>4|C<<12)&255,this.r[5]=C>>>1&8190,N=u[10]&255|(u[11]&255)<<8,this.r[6]=(C>>>14|N<<2)&8191,W=u[12]&255|(u[13]&255)<<8,this.r[7]=(N>>>11|W<<5)&8065,ne=u[14]&255|(u[15]&255)<<8,this.r[8]=(W>>>8|ne<<8)&8191,this.r[9]=ne>>>5&127,this.pad[0]=u[16]&255|(u[17]&255)<<8,this.pad[1]=u[18]&255|(u[19]&255)<<8,this.pad[2]=u[20]&255|(u[21]&255)<<8,this.pad[3]=u[22]&255|(u[23]&255)<<8,this.pad[4]=u[24]&255|(u[25]&255)<<8,this.pad[5]=u[26]&255|(u[27]&255)<<8,this.pad[6]=u[28]&255|(u[29]&255)<<8,this.pad[7]=u[30]&255|(u[31]&255)<<8};R.prototype.blocks=function(u,_,A){for(var c=this.fin?0:2048,E,C,N,W,ne,he,fe,$e,ce,me,Ne,De,ve,Be,Re,ke,ue,Ee,ae,de=this.h[0],_e=this.h[1],oe=this.h[2],v=this.h[3],D=this.h[4],X=this.h[5],K=this.h[6],q=this.h[7],j=this.h[8],xe=this.h[9],Te=this.r[0],Ue=this.r[1],Pe=this.r[2],p=this.r[3],Fe=this.r[4],Ye=this.r[5],Ze=this.r[6],Oe=this.r[7],qe=this.r[8],Xe=this.r[9];A>=16;)E=u[_+0]&255|(u[_+1]&255)<<8,de+=E&8191,C=u[_+2]&255|(u[_+3]&255)<<8,_e+=(E>>>13|C<<3)&8191,N=u[_+4]&255|(u[_+5]&255)<<8,oe+=(C>>>10|N<<6)&8191,W=u[_+6]&255|(u[_+7]&255)<<8,v+=(N>>>7|W<<9)&8191,ne=u[_+8]&255|(u[_+9]&255)<<8,D+=(W>>>4|ne<<12)&8191,X+=ne>>>1&8191,he=u[_+10]&255|(u[_+11]&255)<<8,K+=(ne>>>14|he<<2)&8191,fe=u[_+12]&255|(u[_+13]&255)<<8,q+=(he>>>11|fe<<5)&8191,$e=u[_+14]&255|(u[_+15]&255)<<8,j+=(fe>>>8|$e<<8)&8191,xe+=$e>>>5|c,ce=0,me=ce,me+=de*Te,me+=_e*(5*Xe),me+=oe*(5*qe),me+=v*(5*Oe),me+=D*(5*Ze),ce=me>>>13,me&=8191,me+=X*(5*Ye),me+=K*(5*Fe),me+=q*(5*p),me+=j*(5*Pe),me+=xe*(5*Ue),ce+=me>>>13,me&=8191,Ne=ce,Ne+=de*Ue,Ne+=_e*Te,Ne+=oe*(5*Xe),Ne+=v*(5*qe),Ne+=D*(5*Oe),ce=Ne>>>13,Ne&=8191,Ne+=X*(5*Ze),Ne+=K*(5*Ye),Ne+=q*(5*Fe),Ne+=j*(5*p),Ne+=xe*(5*Pe),ce+=Ne>>>13,Ne&=8191,De=ce,De+=de*Pe,De+=_e*Ue,De+=oe*Te,De+=v*(5*Xe),De+=D*(5*qe),ce=De>>>13,De&=8191,De+=X*(5*Oe),De+=K*(5*Ze),De+=q*(5*Ye),De+=j*(5*Fe),De+=xe*(5*p),ce+=De>>>13,De&=8191,ve=ce,ve+=de*p,ve+=_e*Pe,ve+=oe*Ue,ve+=v*Te,ve+=D*(5*Xe),ce=ve>>>13,ve&=8191,ve+=X*(5*qe),ve+=K*(5*Oe),ve+=q*(5*Ze),ve+=j*(5*Ye),ve+=xe*(5*Fe),ce+=ve>>>13,ve&=8191,Be=ce,Be+=de*Fe,Be+=_e*p,Be+=oe*Pe,Be+=v*Ue,Be+=D*Te,ce=Be>>>13,Be&=8191,Be+=X*(5*Xe),Be+=K*(5*qe),Be+=q*(5*Oe),Be+=j*(5*Ze),Be+=xe*(5*Ye),ce+=Be>>>13,Be&=8191,Re=ce,Re+=de*Ye,Re+=_e*Fe,Re+=oe*p,Re+=v*Pe,Re+=D*Ue,ce=Re>>>13,Re&=8191,Re+=X*Te,Re+=K*(5*Xe),Re+=q*(5*qe),Re+=j*(5*Oe),Re+=xe*(5*Ze),ce+=Re>>>13,Re&=8191,ke=ce,ke+=de*Ze,ke+=_e*Ye,ke+=oe*Fe,ke+=v*p,ke+=D*Pe,ce=ke>>>13,ke&=8191,ke+=X*Ue,ke+=K*Te,ke+=q*(5*Xe),ke+=j*(5*qe),ke+=xe*(5*Oe),ce+=ke>>>13,ke&=8191,ue=ce,ue+=de*Oe,ue+=_e*Ze,ue+=oe*Ye,ue+=v*Fe,ue+=D*p,ce=ue>>>13,ue&=8191,ue+=X*Pe,ue+=K*Ue,ue+=q*Te,ue+=j*(5*Xe),ue+=xe*(5*qe),ce+=ue>>>13,ue&=8191,Ee=ce,Ee+=de*qe,Ee+=_e*Oe,Ee+=oe*Ze,Ee+=v*Ye,Ee+=D*Fe,ce=Ee>>>13,Ee&=8191,Ee+=X*p,Ee+=K*Pe,Ee+=q*Ue,Ee+=j*Te,Ee+=xe*(5*Xe),ce+=Ee>>>13,Ee&=8191,ae=ce,ae+=de*Xe,ae+=_e*qe,ae+=oe*Oe,ae+=v*Ze,ae+=D*Ye,ce=ae>>>13,ae&=8191,ae+=X*Fe,ae+=K*p,ae+=q*Pe,ae+=j*Ue,ae+=xe*Te,ce+=ae>>>13,ae&=8191,ce=(ce<<2)+ce|0,ce=ce+me|0,me=ce&8191,ce=ce>>>13,Ne+=ce,de=me,_e=Ne,oe=De,v=ve,D=Be,X=Re,K=ke,q=ue,j=Ee,xe=ae,_+=16,A-=16;this.h[0]=de,this.h[1]=_e,this.h[2]=oe,this.h[3]=v,this.h[4]=D,this.h[5]=X,this.h[6]=K,this.h[7]=q,this.h[8]=j,this.h[9]=xe},R.prototype.finish=function(u,_){var A=new Uint16Array(10),c,E,C,N;if(this.leftover){for(N=this.leftover,this.buffer[N++]=1;N<16;N++)this.buffer[N]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(c=this.h[1]>>>13,this.h[1]&=8191,N=2;N<10;N++)this.h[N]+=c,c=this.h[N]>>>13,this.h[N]&=8191;for(this.h[0]+=c*5,c=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=c,c=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=c,A[0]=this.h[0]+5,c=A[0]>>>13,A[0]&=8191,N=1;N<10;N++)A[N]=this.h[N]+c,c=A[N]>>>13,A[N]&=8191;for(A[9]-=8192,E=(c^1)-1,N=0;N<10;N++)A[N]&=E;for(E=~E,N=0;N<10;N++)this.h[N]=this.h[N]&E|A[N];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,C=this.h[0]+this.pad[0],this.h[0]=C&65535,N=1;N<8;N++)C=(this.h[N]+this.pad[N]|0)+(C>>>16)|0,this.h[N]=C&65535;u[_+0]=this.h[0]>>>0&255,u[_+1]=this.h[0]>>>8&255,u[_+2]=this.h[1]>>>0&255,u[_+3]=this.h[1]>>>8&255,u[_+4]=this.h[2]>>>0&255,u[_+5]=this.h[2]>>>8&255,u[_+6]=this.h[3]>>>0&255,u[_+7]=this.h[3]>>>8&255,u[_+8]=this.h[4]>>>0&255,u[_+9]=this.h[4]>>>8&255,u[_+10]=this.h[5]>>>0&255,u[_+11]=this.h[5]>>>8&255,u[_+12]=this.h[6]>>>0&255,u[_+13]=this.h[6]>>>8&255,u[_+14]=this.h[7]>>>0&255,u[_+15]=this.h[7]>>>8&255},R.prototype.update=function(u,_,A){var c,E;if(this.leftover){for(E=16-this.leftover,E>A&&(E=A),c=0;c<E;c++)this.buffer[this.leftover+c]=u[_+c];if(A-=E,_+=E,this.leftover+=E,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(A>=16&&(E=A-A%16,this.blocks(u,_,E),_+=E,A-=E),A){for(c=0;c<A;c++)this.buffer[this.leftover+c]=u[_+c];this.leftover+=A}};function M(u,_,A,c,E,C){var N=new R(C);return N.update(A,c,E),N.finish(u,_),0}function O(u,_,A,c,E,C){var N=new Uint8Array(16);return M(N,0,A,c,E,C),b(u,_,N,0)}function re(u,_,A,c,E){var C;if(A<32)return-1;for(S(u,0,_,0,A,c,E),M(u,16,u,32,A-32,u),C=0;C<16;C++)u[C]=0;return 0}function z(u,_,A,c,E){var C,N=new Uint8Array(32);if(A<32||(x(N,0,32,c,E),O(_,16,_,32,A-32,N)!==0))return-1;for(S(u,0,_,0,A,c,E),C=0;C<32;C++)u[C]=0;return 0}function Y(u,_){var A;for(A=0;A<16;A++)u[A]=_[A]|0}function te(u){var _,A,c=1;for(_=0;_<16;_++)A=u[_]+c+65535,c=Math.floor(A/65536),u[_]=A-c*65536;u[0]+=c-1+37*(c-1)}function ie(u,_,A){for(var c,E=~(A-1),C=0;C<16;C++)c=E&(u[C]^_[C]),u[C]^=c,_[C]^=c}function k(u,_){var A,c,E,C=t(),N=t();for(A=0;A<16;A++)N[A]=_[A];for(te(N),te(N),te(N),c=0;c<2;c++){for(C[0]=N[0]-65517,A=1;A<15;A++)C[A]=N[A]-65535-(C[A-1]>>16&1),C[A-1]&=65535;C[15]=N[15]-32767-(C[14]>>16&1),E=C[15]>>16&1,C[14]&=65535,ie(N,C,1-E)}for(A=0;A<16;A++)u[2*A]=N[A]&255,u[2*A+1]=N[A]>>8}function Q(u,_){var A=new Uint8Array(32),c=new Uint8Array(32);return k(A,u),k(c,_),L(A,0,c,0)}function F(u){var _=new Uint8Array(32);return k(_,u),_[0]&1}function V(u,_){var A;for(A=0;A<16;A++)u[A]=_[2*A]+(_[2*A+1]<<8);u[15]&=32767}function le(u,_,A){for(var c=0;c<16;c++)u[c]=_[c]+A[c]}function He(u,_,A){for(var c=0;c<16;c++)u[c]=_[c]-A[c]}function Ae(u,_,A){var c,E,C=0,N=0,W=0,ne=0,he=0,fe=0,$e=0,ce=0,me=0,Ne=0,De=0,ve=0,Be=0,Re=0,ke=0,ue=0,Ee=0,ae=0,de=0,_e=0,oe=0,v=0,D=0,X=0,K=0,q=0,j=0,xe=0,Te=0,Ue=0,Pe=0,p=A[0],Fe=A[1],Ye=A[2],Ze=A[3],Oe=A[4],qe=A[5],Xe=A[6],At=A[7],et=A[8],ut=A[9],lt=A[10],dt=A[11],gt=A[12],yt=A[13],Ct=A[14],wt=A[15];c=_[0],C+=c*p,N+=c*Fe,W+=c*Ye,ne+=c*Ze,he+=c*Oe,fe+=c*qe,$e+=c*Xe,ce+=c*At,me+=c*et,Ne+=c*ut,De+=c*lt,ve+=c*dt,Be+=c*gt,Re+=c*yt,ke+=c*Ct,ue+=c*wt,c=_[1],N+=c*p,W+=c*Fe,ne+=c*Ye,he+=c*Ze,fe+=c*Oe,$e+=c*qe,ce+=c*Xe,me+=c*At,Ne+=c*et,De+=c*ut,ve+=c*lt,Be+=c*dt,Re+=c*gt,ke+=c*yt,ue+=c*Ct,Ee+=c*wt,c=_[2],W+=c*p,ne+=c*Fe,he+=c*Ye,fe+=c*Ze,$e+=c*Oe,ce+=c*qe,me+=c*Xe,Ne+=c*At,De+=c*et,ve+=c*ut,Be+=c*lt,Re+=c*dt,ke+=c*gt,ue+=c*yt,Ee+=c*Ct,ae+=c*wt,c=_[3],ne+=c*p,he+=c*Fe,fe+=c*Ye,$e+=c*Ze,ce+=c*Oe,me+=c*qe,Ne+=c*Xe,De+=c*At,ve+=c*et,Be+=c*ut,Re+=c*lt,ke+=c*dt,ue+=c*gt,Ee+=c*yt,ae+=c*Ct,de+=c*wt,c=_[4],he+=c*p,fe+=c*Fe,$e+=c*Ye,ce+=c*Ze,me+=c*Oe,Ne+=c*qe,De+=c*Xe,ve+=c*At,Be+=c*et,Re+=c*ut,ke+=c*lt,ue+=c*dt,Ee+=c*gt,ae+=c*yt,de+=c*Ct,_e+=c*wt,c=_[5],fe+=c*p,$e+=c*Fe,ce+=c*Ye,me+=c*Ze,Ne+=c*Oe,De+=c*qe,ve+=c*Xe,Be+=c*At,Re+=c*et,ke+=c*ut,ue+=c*lt,Ee+=c*dt,ae+=c*gt,de+=c*yt,_e+=c*Ct,oe+=c*wt,c=_[6],$e+=c*p,ce+=c*Fe,me+=c*Ye,Ne+=c*Ze,De+=c*Oe,ve+=c*qe,Be+=c*Xe,Re+=c*At,ke+=c*et,ue+=c*ut,Ee+=c*lt,ae+=c*dt,de+=c*gt,_e+=c*yt,oe+=c*Ct,v+=c*wt,c=_[7],ce+=c*p,me+=c*Fe,Ne+=c*Ye,De+=c*Ze,ve+=c*Oe,Be+=c*qe,Re+=c*Xe,ke+=c*At,ue+=c*et,Ee+=c*ut,ae+=c*lt,de+=c*dt,_e+=c*gt,oe+=c*yt,v+=c*Ct,D+=c*wt,c=_[8],me+=c*p,Ne+=c*Fe,De+=c*Ye,ve+=c*Ze,Be+=c*Oe,Re+=c*qe,ke+=c*Xe,ue+=c*At,Ee+=c*et,ae+=c*ut,de+=c*lt,_e+=c*dt,oe+=c*gt,v+=c*yt,D+=c*Ct,X+=c*wt,c=_[9],Ne+=c*p,De+=c*Fe,ve+=c*Ye,Be+=c*Ze,Re+=c*Oe,ke+=c*qe,ue+=c*Xe,Ee+=c*At,ae+=c*et,de+=c*ut,_e+=c*lt,oe+=c*dt,v+=c*gt,D+=c*yt,X+=c*Ct,K+=c*wt,c=_[10],De+=c*p,ve+=c*Fe,Be+=c*Ye,Re+=c*Ze,ke+=c*Oe,ue+=c*qe,Ee+=c*Xe,ae+=c*At,de+=c*et,_e+=c*ut,oe+=c*lt,v+=c*dt,D+=c*gt,X+=c*yt,K+=c*Ct,q+=c*wt,c=_[11],ve+=c*p,Be+=c*Fe,Re+=c*Ye,ke+=c*Ze,ue+=c*Oe,Ee+=c*qe,ae+=c*Xe,de+=c*At,_e+=c*et,oe+=c*ut,v+=c*lt,D+=c*dt,X+=c*gt,K+=c*yt,q+=c*Ct,j+=c*wt,c=_[12],Be+=c*p,Re+=c*Fe,ke+=c*Ye,ue+=c*Ze,Ee+=c*Oe,ae+=c*qe,de+=c*Xe,_e+=c*At,oe+=c*et,v+=c*ut,D+=c*lt,X+=c*dt,K+=c*gt,q+=c*yt,j+=c*Ct,xe+=c*wt,c=_[13],Re+=c*p,ke+=c*Fe,ue+=c*Ye,Ee+=c*Ze,ae+=c*Oe,de+=c*qe,_e+=c*Xe,oe+=c*At,v+=c*et,D+=c*ut,X+=c*lt,K+=c*dt,q+=c*gt,j+=c*yt,xe+=c*Ct,Te+=c*wt,c=_[14],ke+=c*p,ue+=c*Fe,Ee+=c*Ye,ae+=c*Ze,de+=c*Oe,_e+=c*qe,oe+=c*Xe,v+=c*At,D+=c*et,X+=c*ut,K+=c*lt,q+=c*dt,j+=c*gt,xe+=c*yt,Te+=c*Ct,Ue+=c*wt,c=_[15],ue+=c*p,Ee+=c*Fe,ae+=c*Ye,de+=c*Ze,_e+=c*Oe,oe+=c*qe,v+=c*Xe,D+=c*At,X+=c*et,K+=c*ut,q+=c*lt,j+=c*dt,xe+=c*gt,Te+=c*yt,Ue+=c*Ct,Pe+=c*wt,C+=38*Ee,N+=38*ae,W+=38*de,ne+=38*_e,he+=38*oe,fe+=38*v,$e+=38*D,ce+=38*X,me+=38*K,Ne+=38*q,De+=38*j,ve+=38*xe,Be+=38*Te,Re+=38*Ue,ke+=38*Pe,E=1,c=C+E+65535,E=Math.floor(c/65536),C=c-E*65536,c=N+E+65535,E=Math.floor(c/65536),N=c-E*65536,c=W+E+65535,E=Math.floor(c/65536),W=c-E*65536,c=ne+E+65535,E=Math.floor(c/65536),ne=c-E*65536,c=he+E+65535,E=Math.floor(c/65536),he=c-E*65536,c=fe+E+65535,E=Math.floor(c/65536),fe=c-E*65536,c=$e+E+65535,E=Math.floor(c/65536),$e=c-E*65536,c=ce+E+65535,E=Math.floor(c/65536),ce=c-E*65536,c=me+E+65535,E=Math.floor(c/65536),me=c-E*65536,c=Ne+E+65535,E=Math.floor(c/65536),Ne=c-E*65536,c=De+E+65535,E=Math.floor(c/65536),De=c-E*65536,c=ve+E+65535,E=Math.floor(c/65536),ve=c-E*65536,c=Be+E+65535,E=Math.floor(c/65536),Be=c-E*65536,c=Re+E+65535,E=Math.floor(c/65536),Re=c-E*65536,c=ke+E+65535,E=Math.floor(c/65536),ke=c-E*65536,c=ue+E+65535,E=Math.floor(c/65536),ue=c-E*65536,C+=E-1+37*(E-1),E=1,c=C+E+65535,E=Math.floor(c/65536),C=c-E*65536,c=N+E+65535,E=Math.floor(c/65536),N=c-E*65536,c=W+E+65535,E=Math.floor(c/65536),W=c-E*65536,c=ne+E+65535,E=Math.floor(c/65536),ne=c-E*65536,c=he+E+65535,E=Math.floor(c/65536),he=c-E*65536,c=fe+E+65535,E=Math.floor(c/65536),fe=c-E*65536,c=$e+E+65535,E=Math.floor(c/65536),$e=c-E*65536,c=ce+E+65535,E=Math.floor(c/65536),ce=c-E*65536,c=me+E+65535,E=Math.floor(c/65536),me=c-E*65536,c=Ne+E+65535,E=Math.floor(c/65536),Ne=c-E*65536,c=De+E+65535,E=Math.floor(c/65536),De=c-E*65536,c=ve+E+65535,E=Math.floor(c/65536),ve=c-E*65536,c=Be+E+65535,E=Math.floor(c/65536),Be=c-E*65536,c=Re+E+65535,E=Math.floor(c/65536),Re=c-E*65536,c=ke+E+65535,E=Math.floor(c/65536),ke=c-E*65536,c=ue+E+65535,E=Math.floor(c/65536),ue=c-E*65536,C+=E-1+37*(E-1),u[0]=C,u[1]=N,u[2]=W,u[3]=ne,u[4]=he,u[5]=fe,u[6]=$e,u[7]=ce,u[8]=me,u[9]=Ne,u[10]=De,u[11]=ve,u[12]=Be,u[13]=Re,u[14]=ke,u[15]=ue}function st(u,_){Ae(u,_,_)}function St(u,_){var A=t(),c;for(c=0;c<16;c++)A[c]=_[c];for(c=253;c>=0;c--)st(A,A),c!==2&&c!==4&&Ae(A,A,_);for(c=0;c<16;c++)u[c]=A[c]}function nr(u,_){var A=t(),c;for(c=0;c<16;c++)A[c]=_[c];for(c=250;c>=0;c--)st(A,A),c!==1&&Ae(A,A,_);for(c=0;c<16;c++)u[c]=A[c]}function mn(u,_,A){var c=new Uint8Array(32),E=new Float64Array(80),C,N,W=t(),ne=t(),he=t(),fe=t(),$e=t(),ce=t();for(N=0;N<31;N++)c[N]=_[N];for(c[31]=_[31]&127|64,c[0]&=248,V(E,A),N=0;N<16;N++)ne[N]=E[N],fe[N]=W[N]=he[N]=0;for(W[0]=fe[0]=1,N=254;N>=0;--N)C=c[N>>>3]>>>(N&7)&1,ie(W,ne,C),ie(he,fe,C),le($e,W,he),He(W,W,he),le(he,ne,fe),He(ne,ne,fe),st(fe,$e),st(ce,W),Ae(W,he,W),Ae(he,ne,$e),le($e,W,he),He(W,W,he),st(ne,W),He(he,fe,ce),Ae(W,he,f),le(W,W,fe),Ae(he,he,W),Ae(W,fe,ce),Ae(fe,ne,E),st(ne,$e),ie(W,ne,C),ie(he,fe,C);for(N=0;N<16;N++)E[N+16]=W[N],E[N+32]=he[N],E[N+48]=ne[N],E[N+64]=fe[N];var me=E.subarray(32),Ne=E.subarray(16);return St(me,me),Ae(Ne,Ne,me),k(u,Ne),0}function Nn(u,_){return mn(u,_,i)}function zt(u,_){return e(_,32),Nn(u,_)}function Bn(u,_,A){var c=new Uint8Array(32);return mn(c,A,_),T(u,r,c,Z)}var rr=re,Ur=z;function ir(u,_,A,c,E,C){var N=new Uint8Array(32);return Bn(N,E,C),rr(u,_,A,c,N)}function kn(u,_,A,c,E,C){var N=new Uint8Array(32);return Bn(N,E,C),Ur(u,_,A,c,N)}var Rn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function G(u,_,A,c){for(var E=new Int32Array(16),C=new Int32Array(16),N,W,ne,he,fe,$e,ce,me,Ne,De,ve,Be,Re,ke,ue,Ee,ae,de,_e,oe,v,D,X,K,q,j,xe=u[0],Te=u[1],Ue=u[2],Pe=u[3],p=u[4],Fe=u[5],Ye=u[6],Ze=u[7],Oe=_[0],qe=_[1],Xe=_[2],At=_[3],et=_[4],ut=_[5],lt=_[6],dt=_[7],gt=0;c>=128;){for(_e=0;_e<16;_e++)oe=8*_e+gt,E[_e]=A[oe+0]<<24|A[oe+1]<<16|A[oe+2]<<8|A[oe+3],C[_e]=A[oe+4]<<24|A[oe+5]<<16|A[oe+6]<<8|A[oe+7];for(_e=0;_e<80;_e++)if(N=xe,W=Te,ne=Ue,he=Pe,fe=p,$e=Fe,ce=Ye,me=Ze,Ne=Oe,De=qe,ve=Xe,Be=At,Re=et,ke=ut,ue=lt,Ee=dt,v=Ze,D=dt,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=(p>>>14|et<<18)^(p>>>18|et<<14)^(et>>>9|p<<23),D=(et>>>14|p<<18)^(et>>>18|p<<14)^(p>>>9|et<<23),X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,v=p&Fe^~p&Ye,D=et&ut^~et&lt,X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,v=Rn[_e*2],D=Rn[_e*2+1],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,v=E[_e%16],D=C[_e%16],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,ae=q&65535|j<<16,de=X&65535|K<<16,v=ae,D=de,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=(xe>>>28|Oe<<4)^(Oe>>>2|xe<<30)^(Oe>>>7|xe<<25),D=(Oe>>>28|xe<<4)^(xe>>>2|Oe<<30)^(xe>>>7|Oe<<25),X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,v=xe&Te^xe&Ue^Te&Ue,D=Oe&qe^Oe&Xe^qe&Xe,X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,me=q&65535|j<<16,Ee=X&65535|K<<16,v=he,D=Be,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=ae,D=de,X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,he=q&65535|j<<16,Be=X&65535|K<<16,Te=N,Ue=W,Pe=ne,p=he,Fe=fe,Ye=$e,Ze=ce,xe=me,qe=Ne,Xe=De,At=ve,et=Be,ut=Re,lt=ke,dt=ue,Oe=Ee,_e%16===15)for(oe=0;oe<16;oe++)v=E[oe],D=C[oe],X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=E[(oe+9)%16],D=C[(oe+9)%16],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,ae=E[(oe+1)%16],de=C[(oe+1)%16],v=(ae>>>1|de<<31)^(ae>>>8|de<<24)^ae>>>7,D=(de>>>1|ae<<31)^(de>>>8|ae<<24)^(de>>>7|ae<<25),X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,ae=E[(oe+14)%16],de=C[(oe+14)%16],v=(ae>>>19|de<<13)^(de>>>29|ae<<3)^ae>>>6,D=(de>>>19|ae<<13)^(ae>>>29|de<<3)^(de>>>6|ae<<26),X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,E[oe]=q&65535|j<<16,C[oe]=X&65535|K<<16;v=xe,D=Oe,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[0],D=_[0],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[0]=xe=q&65535|j<<16,_[0]=Oe=X&65535|K<<16,v=Te,D=qe,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[1],D=_[1],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[1]=Te=q&65535|j<<16,_[1]=qe=X&65535|K<<16,v=Ue,D=Xe,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[2],D=_[2],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[2]=Ue=q&65535|j<<16,_[2]=Xe=X&65535|K<<16,v=Pe,D=At,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[3],D=_[3],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[3]=Pe=q&65535|j<<16,_[3]=At=X&65535|K<<16,v=p,D=et,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[4],D=_[4],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[4]=p=q&65535|j<<16,_[4]=et=X&65535|K<<16,v=Fe,D=ut,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[5],D=_[5],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[5]=Fe=q&65535|j<<16,_[5]=ut=X&65535|K<<16,v=Ye,D=lt,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[6],D=_[6],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[6]=Ye=q&65535|j<<16,_[6]=lt=X&65535|K<<16,v=Ze,D=dt,X=D&65535,K=D>>>16,q=v&65535,j=v>>>16,v=u[7],D=_[7],X+=D&65535,K+=D>>>16,q+=v&65535,j+=v>>>16,K+=X>>>16,q+=K>>>16,j+=q>>>16,u[7]=Ze=q&65535|j<<16,_[7]=dt=X&65535|K<<16,gt+=128,c-=128}return c}function se(u,_,A){var c=new Int32Array(8),E=new Int32Array(8),C=new Uint8Array(256),N,W=A;for(c[0]=1779033703,c[1]=3144134277,c[2]=1013904242,c[3]=2773480762,c[4]=1359893119,c[5]=2600822924,c[6]=528734635,c[7]=1541459225,E[0]=4089235720,E[1]=2227873595,E[2]=4271175723,E[3]=1595750129,E[4]=2917565137,E[5]=725511199,E[6]=4215389547,E[7]=327033209,G(c,E,_,A),A%=128,N=0;N<A;N++)C[N]=_[W-A+N];for(C[A]=128,A=256-128*(A<112?1:0),C[A-9]=0,g(C,A-8,W/536870912|0,W<<3),G(c,E,C,A),N=0;N<8;N++)g(u,8*N,c[N],E[N]);return 0}function ge(u,_){var A=t(),c=t(),E=t(),C=t(),N=t(),W=t(),ne=t(),he=t(),fe=t();He(A,u[1],u[0]),He(fe,_[1],_[0]),Ae(A,A,fe),le(c,u[0],u[1]),le(fe,_[0],_[1]),Ae(c,c,fe),Ae(E,u[3],_[3]),Ae(E,E,h),Ae(C,u[2],_[2]),le(C,C,C),He(N,c,A),He(W,C,E),le(ne,C,E),le(he,c,A),Ae(u[0],N,W),Ae(u[1],he,ne),Ae(u[2],ne,W),Ae(u[3],N,he)}function Le(u,_,A){var c;for(c=0;c<4;c++)ie(u[c],_[c],A)}function Ke(u,_){var A=t(),c=t(),E=t();St(E,_[2]),Ae(A,_[0],E),Ae(c,_[1],E),k(u,c),u[31]^=F(A)<<7}function _t(u,_,A){var c,E;for(Y(u[0],s),Y(u[1],o),Y(u[2],o),Y(u[3],s),E=255;E>=0;--E)c=A[E/8|0]>>(E&7)&1,Le(u,_,c),ge(_,u),ge(u,u),Le(u,_,c)}function $t(u,_){var A=[t(),t(),t(),t()];Y(A[0],d),Y(A[1],l),Y(A[2],o),Ae(A[3],d,l),_t(u,A,_)}function Tt(u,_,A){var c=new Uint8Array(64),E=[t(),t(),t(),t()],C;for(A||e(_,32),se(c,_,32),c[0]&=248,c[31]&=127,c[31]|=64,$t(E,c),Ke(u,E),C=0;C<32;C++)_[C+32]=u[C];return 0}var vn=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Je(u,_){var A,c,E,C;for(c=63;c>=32;--c){for(A=0,E=c-32,C=c-12;E<C;++E)_[E]+=A-16*_[c]*vn[E-(c-32)],A=_[E]+128>>8,_[E]-=A*256;_[E]+=A,_[c]=0}for(A=0,E=0;E<32;E++)_[E]+=A-(_[31]>>4)*vn[E],A=_[E]>>8,_[E]&=255;for(E=0;E<32;E++)_[E]-=A*vn[E];for(c=0;c<32;c++)_[c+1]+=_[c]>>8,u[c]=_[c]&255}function pt(u){var _=new Float64Array(64),A;for(A=0;A<64;A++)_[A]=u[A];for(A=0;A<64;A++)u[A]=0;Je(u,_)}function Et(u,_,A,c){var E=new Uint8Array(64),C=new Uint8Array(64),N=new Uint8Array(64),W,ne,he=new Float64Array(64),fe=[t(),t(),t(),t()];se(E,c,32),E[0]&=248,E[31]&=127,E[31]|=64;var $e=A+64;for(W=0;W<A;W++)u[64+W]=_[W];for(W=0;W<32;W++)u[32+W]=E[32+W];for(se(N,u.subarray(32),A+32),pt(N),$t(fe,N),Ke(u,fe),W=32;W<64;W++)u[W]=c[W];for(se(C,u,A+64),pt(C),W=0;W<64;W++)he[W]=0;for(W=0;W<32;W++)he[W]=N[W];for(W=0;W<32;W++)for(ne=0;ne<32;ne++)he[W+ne]+=C[W]*E[ne];return Je(u.subarray(32),he),$e}function ct(u,_){var A=t(),c=t(),E=t(),C=t(),N=t(),W=t(),ne=t();return Y(u[2],o),V(u[1],_),st(E,u[1]),Ae(C,E,a),He(E,E,u[2]),le(C,u[2],C),st(N,C),st(W,N),Ae(ne,W,N),Ae(A,ne,E),Ae(A,A,C),nr(A,A),Ae(A,A,E),Ae(A,A,C),Ae(A,A,C),Ae(u[0],A,C),st(c,u[0]),Ae(c,c,C),Q(c,E)&&Ae(u[0],u[0],H),st(c,u[0]),Ae(c,c,C),Q(c,E)?-1:(F(u[0])===_[31]>>7&&He(u[0],s,u[0]),Ae(u[3],u[0],u[1]),0)}function rt(u,_,A,c){var E,C,N=new Uint8Array(32),W=new Uint8Array(64),ne=[t(),t(),t(),t()],he=[t(),t(),t(),t()];if(C=-1,A<64||ct(he,c))return-1;for(E=0;E<A;E++)u[E]=_[E];for(E=0;E<32;E++)u[E+32]=c[E];if(se(W,u,A),pt(W),_t(ne,he,W),$t(he,_.subarray(32)),ge(ne,he),Ke(N,ne),A-=64,L(_,0,N,0)){for(E=0;E<A;E++)u[E]=0;return-1}for(E=0;E<A;E++)u[E]=_[E+64];return C=A,C}var Ft=32,ht=24,In=32,Dn=16,sr=32,Or=32,or=32,fr=32,vi=32,yo=ht,uc=In,lc=Dn,Jt=64,bn=32,Tn=64,Di=32,Ti=64;n.lowlevel={crypto_core_hsalsa20:T,crypto_stream_xor:S,crypto_stream:x,crypto_stream_salsa20_xor:ee,crypto_stream_salsa20:$,crypto_onetimeauth:M,crypto_onetimeauth_verify:O,crypto_verify_16:b,crypto_verify_32:L,crypto_secretbox:re,crypto_secretbox_open:z,crypto_scalarmult:mn,crypto_scalarmult_base:Nn,crypto_box_beforenm:Bn,crypto_box_afternm:rr,crypto_box:ir,crypto_box_open:kn,crypto_box_keypair:zt,crypto_hash:se,crypto_sign:Et,crypto_sign_keypair:Tt,crypto_sign_open:rt,crypto_secretbox_KEYBYTES:Ft,crypto_secretbox_NONCEBYTES:ht,crypto_secretbox_ZEROBYTES:In,crypto_secretbox_BOXZEROBYTES:Dn,crypto_scalarmult_BYTES:sr,crypto_scalarmult_SCALARBYTES:Or,crypto_box_PUBLICKEYBYTES:or,crypto_box_SECRETKEYBYTES:fr,crypto_box_BEFORENMBYTES:vi,crypto_box_NONCEBYTES:yo,crypto_box_ZEROBYTES:uc,crypto_box_BOXZEROBYTES:lc,crypto_sign_BYTES:Jt,crypto_sign_PUBLICKEYBYTES:bn,crypto_sign_SECRETKEYBYTES:Tn,crypto_sign_SEEDBYTES:Di,crypto_hash_BYTES:Ti};function Co(u,_){if(u.length!==Ft)throw new Error("bad key size");if(_.length!==ht)throw new Error("bad nonce size")}function dc(u,_){if(u.length!==or)throw new Error("bad public key size");if(_.length!==fr)throw new Error("bad secret key size")}function Pt(){var u,_;for(_=0;_<arguments.length;_++)if((u=Object.prototype.toString.call(arguments[_]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+u+", use Uint8Array")}function wo(u){for(var _=0;_<u.length;_++)u[_]=0}n.util||(n.util={},n.util.decodeUTF8=n.util.encodeUTF8=n.util.encodeBase64=n.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),n.randomBytes=function(u){var _=new Uint8Array(u);return e(_,u),_},n.secretbox=function(u,_,A){Pt(u,_,A),Co(A,_);for(var c=new Uint8Array(In+u.length),E=new Uint8Array(c.length),C=0;C<u.length;C++)c[C+In]=u[C];return re(E,c,c.length,_,A),E.subarray(Dn)},n.secretbox.open=function(u,_,A){Pt(u,_,A),Co(A,_);for(var c=new Uint8Array(Dn+u.length),E=new Uint8Array(c.length),C=0;C<u.length;C++)c[C+Dn]=u[C];return c.length<32||z(E,c,c.length,_,A)!==0?!1:E.subarray(In)},n.secretbox.keyLength=Ft,n.secretbox.nonceLength=ht,n.secretbox.overheadLength=Dn,n.scalarMult=function(u,_){if(Pt(u,_),u.length!==Or)throw new Error("bad n size");if(_.length!==sr)throw new Error("bad p size");var A=new Uint8Array(sr);return mn(A,u,_),A},n.scalarMult.base=function(u){if(Pt(u),u.length!==Or)throw new Error("bad n size");var _=new Uint8Array(sr);return Nn(_,u),_},n.scalarMult.scalarLength=Or,n.scalarMult.groupElementLength=sr,n.box=function(u,_,A,c){var E=n.box.before(A,c);return n.secretbox(u,_,E)},n.box.before=function(u,_){Pt(u,_),dc(u,_);var A=new Uint8Array(vi);return Bn(A,u,_),A},n.box.after=n.secretbox,n.box.open=function(u,_,A,c){var E=n.box.before(A,c);return n.secretbox.open(u,_,E)},n.box.open.after=n.secretbox.open,n.box.keyPair=function(){var u=new Uint8Array(or),_=new Uint8Array(fr);return zt(u,_),{publicKey:u,secretKey:_}},n.box.keyPair.fromSecretKey=function(u){if(Pt(u),u.length!==fr)throw new Error("bad secret key size");var _=new Uint8Array(or);return Nn(_,u),{publicKey:_,secretKey:new Uint8Array(u)}},n.box.publicKeyLength=or,n.box.secretKeyLength=fr,n.box.sharedKeyLength=vi,n.box.nonceLength=yo,n.box.overheadLength=n.secretbox.overheadLength,n.sign=function(u,_){if(Pt(u,_),_.length!==Tn)throw new Error("bad secret key size");var A=new Uint8Array(Jt+u.length);return Et(A,u,u.length,_),A},n.sign.open=function(u,_){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(Pt(u,_),_.length!==bn)throw new Error("bad public key size");var A=new Uint8Array(u.length),c=rt(A,u,u.length,_);if(c<0)return null;for(var E=new Uint8Array(c),C=0;C<E.length;C++)E[C]=A[C];return E},n.sign.detached=function(u,_){for(var A=n.sign(u,_),c=new Uint8Array(Jt),E=0;E<c.length;E++)c[E]=A[E];return c},n.sign.detached.verify=function(u,_,A){if(Pt(u,_,A),_.length!==Jt)throw new Error("bad signature size");if(A.length!==bn)throw new Error("bad public key size");var c=new Uint8Array(Jt+u.length),E=new Uint8Array(Jt+u.length),C;for(C=0;C<Jt;C++)c[C]=_[C];for(C=0;C<u.length;C++)c[C+Jt]=u[C];return rt(E,c,c.length,A)>=0},n.sign.keyPair=function(){var u=new Uint8Array(bn),_=new Uint8Array(Tn);return Tt(u,_),{publicKey:u,secretKey:_}},n.sign.keyPair.fromSecretKey=function(u){if(Pt(u),u.length!==Tn)throw new Error("bad secret key size");for(var _=new Uint8Array(bn),A=0;A<_.length;A++)_[A]=u[32+A];return{publicKey:_,secretKey:new Uint8Array(u)}},n.sign.keyPair.fromSeed=function(u){if(Pt(u),u.length!==Di)throw new Error("bad seed size");for(var _=new Uint8Array(bn),A=new Uint8Array(Tn),c=0;c<32;c++)A[c]=u[c];return Tt(_,A,!0),{publicKey:_,secretKey:A}},n.sign.publicKeyLength=bn,n.sign.secretKeyLength=Tn,n.sign.seedLength=Di,n.sign.signatureLength=Jt,n.hash=function(u){Pt(u);var _=new Uint8Array(Ti);return se(_,u,u.length),_},n.hash.hashLength=Ti,n.verify=function(u,_){return Pt(u,_),u.length===0||_.length===0||u.length!==_.length?!1:I(u,0,_,0,u.length)===0},n.setPRNG=function(u){e=u},function(){var u=typeof self<"u"?self.crypto||self.msCrypto:null;if(u&&u.getRandomValues){var _=65536;n.setPRNG(function(A,c){var E,C=new Uint8Array(c);for(E=0;E<c;E+=_)u.getRandomValues(C.subarray(E,E+Math.min(c-E,_)));for(E=0;E<c;E++)A[E]=C[E];wo(C)})}else typeof require<"u"&&(u=require("crypto"),u&&u.randomBytes&&n.setPRNG(function(A,c){var E,C=u.randomBytes(c);for(E=0;E<c;E++)A[E]=C[E];wo(C)}))}()})(typeof Vr<"u"&&Vr.exports?Vr.exports:self.nacl=self.nacl||{})});var Ki=je((Sd,Oo)=>{"use strict";var Qi=Uo().lowlevel.crypto_hash,en=0,Sn=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function Yr(n,t,e){return(n[0][t[e+3]]+n[1][t[e+2]]^n[2][t[e+1]])+n[3][t[e]]}Sn.prototype.encipher=function(n,t){t===void 0&&(t=new Uint8Array(n.buffer),n.byteOffset!==0&&(t=t.subarray(n.byteOffset))),n[0]^=this.P[0];for(var e=1;e<16;e+=2)n[1]^=Yr(this.S,t,0)^this.P[e],n[0]^=Yr(this.S,t,4)^this.P[e+1];var r=n[0];n[0]=n[1]^this.P[17],n[1]=r};Sn.prototype.decipher=function(n){var t=new Uint8Array(n.buffer);n.byteOffset!==0&&(t=t.subarray(n.byteOffset)),n[0]^=this.P[17];for(var e=16;e>0;e-=2)n[1]^=Yr(this.S,t,0)^this.P[e],n[0]^=Yr(this.S,t,4)^this.P[e-1];var r=n[0];n[0]=n[1]^this.P[0],n[1]=r};function xn(n,t){var e,r=0;for(e=0;e<4;e++,en++)en>=t&&(en=0),r=r<<8|n[en];return r}Sn.prototype.expand0state=function(n,t){var e=new Uint32Array(2),r,i,s=new Uint8Array(e.buffer);for(r=0,en=0;r<18;r++)this.P[r]^=xn(n,t);for(en=0,r=0;r<18;r+=2)this.encipher(e,s),this.P[r]=e[0],this.P[r+1]=e[1];for(r=0;r<4;r++)for(i=0;i<256;i+=2)this.encipher(e,s),this.S[r][i]=e[0],this.S[r][i+1]=e[1]};Sn.prototype.expandstate=function(n,t,e,r){var i=new Uint32Array(2),s,o;for(s=0,en=0;s<18;s++)this.P[s]^=xn(e,r);for(s=0,en=0;s<18;s+=2)i[0]^=xn(n,t),i[1]^=xn(n,t),this.encipher(i),this.P[s]=i[0],this.P[s+1]=i[1];for(s=0;s<4;s++)for(o=0;o<256;o+=2)i[0]^=xn(n,t),i[1]^=xn(n,t),this.encipher(i),this.S[s][o]=i[0],this.S[s][o+1]=i[1];en=0};Sn.prototype.enc=function(n,t){for(var e=0;e<t;e++)this.encipher(n.subarray(e*2))};Sn.prototype.dec=function(n,t){for(var e=0;e<t;e++)this.decipher(n.subarray(e*2))};var $r=8,Mi=32;function Gi(n,t,e){var r=new Sn,i=new Uint32Array($r),s,o=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(r.expandstate(t,64,n,64),s=0;s<64;s++)r.expand0state(t,64),r.expand0state(n,64);for(s=0;s<$r;s++)i[s]=xn(o,o.byteLength);for(s=0;s<64;s++)r.enc(i,i.byteLength/8);for(s=0;s<$r;s++)e[4*s+3]=i[s]>>>24,e[4*s+2]=i[s]>>>16,e[4*s+1]=i[s]>>>8,e[4*s+0]=i[s]}function bc(n,t,e,r,i,s,o){var f=new Uint8Array(64),a=new Uint8Array(64),h=new Uint8Array(Mi),d=new Uint8Array(Mi),l=new Uint8Array(r+4),H,g,I,b,L,B,U=s;if(o<1||t===0||r===0||s===0||s>h.byteLength*h.byteLength||r>1<<20)return-1;for(b=Math.floor((s+h.byteLength-1)/h.byteLength),I=Math.floor((s+b-1)/b),H=0;H<r;H++)l[H]=e[H];for(Qi(f,n,t),B=1;s>0;B++){for(l[r+0]=B>>>24,l[r+1]=B>>>16,l[r+2]=B>>>8,l[r+3]=B,Qi(a,l,r+4),Gi(f,a,d),H=h.byteLength;H--;)h[H]=d[H];for(H=1;H<o;H++)for(Qi(a,d,d.byteLength),Gi(f,a,d),g=0;g<h.byteLength;g++)h[g]^=d[g];for(I=Math.min(I,s),H=0;H<I&&(L=H*b+(B-1),!(L>=U));H++)i[L]=h[H];s-=H}return 0}Oo.exports={BLOCKS:$r,HASHSIZE:Mi,hash:Gi,pbkdf:bc}});var Fo=je((yd,xc)=>{xc.exports="./cpufeatures-YAD4ML7Y.node"});var Mo=je((Cd,Qo)=>{"use strict";var Sc=Fo();Qo.exports=Sc.getCPUInfo});var nn=je((wd,jr)=>{"use strict";var tn=require("crypto"),Qn;try{Qn=Mo()()}catch{}var{bindingAvailable:Go,CIPHER_INFO:yc,MAC_INFO:Cc}=un(),Ko=(()=>{if(typeof tn.sign=="function"&&typeof tn.verify=="function"){let n=`-----BEGIN PRIVATE KEY-----\r
MC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r
-----END PRIVATE KEY-----`,t=Buffer.from("a"),e,r;try{e=tn.sign(null,t,n),r=tn.verify(null,t,n,e)}catch{}return Buffer.isBuffer(e)&&e.length===64&&r===!0}return!1})(),Wo=typeof tn.diffieHellman=="function"&&typeof tn.generateKeyPairSync=="function"&&typeof tn.createPublicKey=="function",Zr=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];Wo&&(Zr.unshift("curve25519-sha256"),Zr.unshift("curve25519-sha256@libssh.org"));var wc=Zr.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]),Wi=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];Ko&&Wi.unshift("ssh-ed25519");var Lc=Wi.concat(["ssh-dss"]),qo=(()=>{let n=tn.getCiphers();return t=>n.includes(yc[t].sslName)})(),hn=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];Qn&&Qn.flags&&!Qn.flags.aes?Go?hn.unshift("chacha20-poly1305@openssh.com"):hn.push("chacha20-poly1305@openssh.com"):Go&&Qn&&Qn.arch==="x86"?hn.splice(4,0,"chacha20-poly1305@openssh.com"):hn.push("chacha20-poly1305@openssh.com");hn=hn.filter(qo);var mc=hn.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(qo)),Xo=(()=>{let n=tn.getHashes();return t=>n.includes(Cc[t].sslName)})(),Vo=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(Xo),Nc=Vo.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(Xo)),$o=["none","zlib@openssh.com","zlib"],Bc=$o.concat([]),Fn={BAD_DHGEX:1,OLD_EXIT:2,DYN_RPORT_BUG:4,BUG_DHGEX_LARGE:8,IMPLY_RSA_SHA2_SIGALGS:16};jr.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,EXT_INFO:7,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:void 0,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce((n,t)=>({...n,[t]:1}),{}),COMPAT:Fn,COMPAT_CHECKS:[["Cisco-1.25",Fn.BAD_DHGEX],[/^Cisco-1[.]/,Fn.BUG_DHGEX_LARGE],[/^[0-9.]+$/,Fn.OLD_EXIT],[/^OpenSSH_5[.][0-9]+/,Fn.DYN_RPORT_BUG],[/^OpenSSH_7[.]4/,Fn.IMPLY_RSA_SHA2_SIGALGS]],DEFAULT_KEX:Zr,SUPPORTED_KEX:wc,DEFAULT_SERVER_HOST_KEY:Wi,SUPPORTED_SERVER_HOST_KEY:Lc,DEFAULT_CIPHER:hn,SUPPORTED_CIPHER:mc,DEFAULT_MAC:Vo,SUPPORTED_MAC:Nc,DEFAULT_COMPRESSION:$o,SUPPORTED_COMPRESSION:Bc,curve25519Supported:Wo,eddsaSupported:Ko};jr.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(jr.exports.DISCONNECT_REASON)).reduce((n,[t,e])=>({...n,[e]:t}),{})});var Wt=je((Ld,zo)=>{"use strict";var Gt=cr().Ber,zr,jo=Buffer[Symbol.species],kc=Object.getPrototypeOf(Uint8Array.prototype).fill;function Yo(n,t){return n[t++]*16777216+n[t++]*65536+n[t++]*256+n[t]}function hr(n,t,e,r,i){i||(i=0),r>n.length&&(r=n.length);let s=r-e,o=t.length-i;return s>o&&(s=o),t.set(new Uint8Array(n.buffer,n.byteOffset+e,s),i),s}function ur(n,t,e){return e===void 0&&(e=n.length),new jo(n.buffer,n.byteOffset+t,e-t)}function Xi(){let n=0,t,e={init:(r,i)=>{t=r,n=typeof i=="number"?i:0},pos:()=>n,length:()=>t?t.length:0,avail:()=>t&&n<t.length?t.length-n:0,clear:()=>{t=void 0},readUInt32BE:()=>{if(!(!t||n+3>=t.length))return t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]},readUInt64BE:r=>{if(!(!t||n+7>=t.length))switch(r){case"always":return BigInt(`0x${t.hexSlice(n,n+=8)}`);case"maybe":if(t[n]>31)return BigInt(`0x${t.hexSlice(n,n+=8)}`);default:return t[n++]*72057594037927940+t[n++]*281474976710656+t[n++]*1099511627776+t[n++]*4294967296+t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]}},skip:r=>{t&&r>0&&(n+=r)},skipString:()=>{let r=e.readUInt32BE();if(r!==void 0)return n+=r,n<=t.length?r:void 0},readByte:()=>{if(t&&n<t.length)return t[n++]},readBool:()=>{if(t&&n<t.length)return!!t[n++]},readList:()=>{let r=e.readString(!0);if(r!==void 0)return r?r.split(","):[]},readString:(r,i)=>{typeof r=="number"&&(i=r,r=void 0);let s=e.readUInt32BE();if(s!==void 0&&!(t.length-n<s||typeof i=="number"&&s>i))return r?Buffer.isBuffer(r)?hr(t,r,n,n+=s):t.utf8Slice(n,n+=s):ur(t,n,n+=s)},readRaw:r=>{if(t){if(typeof r!="number")return ur(t,n,n+=t.length-n);if(t.length-n>=r)return ur(t,n,n+=r)}}};return e}function Zo(n,t,e){let r=new Error(n);return typeof t=="boolean"?(e=t,r.level="protocol"):r.level=t||"protocol",r.fatal=!!e,r}function qi(n,t,e){return n[e++]=t>>>24,n[e++]=t>>>16,n[e++]=t>>>8,n[e++]=t,e}var Jr=Xi();zo.exports={bufferCopy:hr,bufferSlice:ur,FastBuffer:jo,bufferFill:(n,t,e,r)=>kc.call(n,t,e,r),makeError:Zo,doFatalError:(n,t,e,r)=>{let i;return zr===void 0&&({DISCONNECT_REASON:zr}=nn()),t instanceof Error?(i=t,typeof e!="number"?r=zr.PROTOCOL_ERROR:r=e):i=Zo(t,e,!0),typeof r!="number"&&(r=zr.PROTOCOL_ERROR),n.disconnect(r),n._destruct(),n._onError(i),1/0},readUInt32BE:Yo,writeUInt32BE:qi,writeUInt32LE:(n,t,e)=>(n[e++]=t,n[e++]=t>>>8,n[e++]=t>>>16,n[e++]=t>>>24,e),makeBufferParser:Xi,bufferParser:Xi(),readString:(n,t,e,r)=>{typeof e=="number"&&(r=e,e=void 0),t===void 0&&(t=0);let i=n.length-t;if(t<0||t>=n.length||i<4)return;let s=Yo(n,t);if(i<4+s||typeof r=="number"&&s>r)return;t+=4;let o=t+s;return n._pos=o,e?Buffer.isBuffer(e)?hr(n,e,t,o):n.utf8Slice(t,o):ur(n,t,o)},sigSSHToASN1:(n,t)=>{switch(t){case"ssh-dss":{if(n.length>40)return n;let e=new Gt.Writer;e.startSequence();let r=n.slice(0,20),i=n.slice(20);if(r[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,r.copy(s,1),r=s}else r[0]===0&&!(r[1]&128)&&(r=r.slice(1));if(i[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,i.copy(s,1),i=s}else i[0]===0&&!(i[1]&128)&&(i=i.slice(1));return e.writeBuffer(r,Gt.Integer),e.writeBuffer(i,Gt.Integer),e.endSequence(),e.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{Jr.init(n,0);let e=Jr.readString(),r=Jr.readString();if(Jr.clear(),e===void 0||r===void 0)return;let i=new Gt.Writer;return i.startSequence(),i.writeBuffer(e,Gt.Integer),i.writeBuffer(r,Gt.Integer),i.endSequence(),i.buffer}default:return n}},convertSignature:(n,t)=>{switch(t){case"ssh-dss":{if(n.length<=40)return n;let e=new Gt.Reader(n);e.readSequence();let r=e.readString(Gt.Integer,!0),i=e.readString(Gt.Integer,!0),s=0,o=0;if(r.length<20){let a=Buffer.allocUnsafe(20);a.set(r,1),r=a,r[0]=0}if(i.length<20){let a=Buffer.allocUnsafe(20);a.set(i,1),i=a,i[0]=0}r.length>20&&r[0]===0&&(s=1),i.length>20&&i[0]===0&&(o=1);let f=Buffer.allocUnsafe(r.length-s+(i.length-o));return hr(r,f,s,r.length,0),hr(i,f,o,i.length,r.length-s),f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(n[0]===0)return n;let e=new Gt.Reader(n);e.readSequence();let r=e.readString(Gt.Integer,!0),i=e.readString(Gt.Integer,!0);if(r===null||i===null)return;let s=Buffer.allocUnsafe(4+r.length+4+i.length);return qi(s,r.length,0),s.set(r,4),qi(s,i.length,4+r.length),s.set(i,8+r.length),s}}return n},sendPacket:(n,t,e)=>!e&&n._kexinit!==void 0?(n._queue===void 0&&(n._queue=[]),n._queue.push(t),n._debug&&n._debug("Outbound: ... packet queued"),!1):(n._cipher.encrypt(t),!0)}});var Jo=je((md,Rc)=>{Rc.exports="./sshcrypto-M6YEOTZI.node"});var ef=je((ei,$i)=>{var Vi=function(){var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(t){t=t||{};var e;e||(e=typeof t<"u"?t:{});var r,i;e.ready=new Promise(function(G,se){r=G,i=se});var s={},o;for(o in e)e.hasOwnProperty(o)&&(s[o]=e[o]);var f=typeof window=="object",a=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",d="",l,H,g,I,b;h?(d=a?require("path").dirname(d)+"/":__dirname+"/",l=function(G,se){var ge=zt(G);return ge?se?ge:ge.toString():(I||(I=require("fs")),b||(b=require("path")),G=b.normalize(G),I.readFileSync(G,se?null:"utf8"))},g=function(G){return G=l(G,!0),G.buffer||(G=new Uint8Array(G)),Z(G.buffer),G},H=function(G,se,ge){var Le=zt(G);Le&&se(Le),I||(I=require("fs")),b||(b=require("path")),G=b.normalize(G),I.readFile(G,function(Ke,_t){Ke?ge(Ke):se(_t.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),e.inspect=function(){return"[Emscripten Module object]"}):(f||a)&&(a?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),n&&(d=n),d.indexOf("blob:")!==0?d=d.substr(0,d.lastIndexOf("/")+1):d="",l=function(G){try{var se=new XMLHttpRequest;return se.open("GET",G,!1),se.send(null),se.responseText}catch(Ke){if(G=zt(G)){se=[];for(var ge=0;ge<G.length;ge++){var Le=G[ge];255<Le&&(mn&&Z(!1,"Character code "+Le+" ("+String.fromCharCode(Le)+")  at offset "+ge+" not in 0x00-0xFF."),Le&=255),se.push(String.fromCharCode(Le))}return se.join("")}throw Ke}},a&&(g=function(G){try{var se=new XMLHttpRequest;return se.open("GET",G,!1),se.responseType="arraybuffer",se.send(null),new Uint8Array(se.response)}catch(ge){if(G=zt(G))return G;throw ge}}),H=function(G,se,ge){var Le=new XMLHttpRequest;Le.open("GET",G,!0),Le.responseType="arraybuffer",Le.onload=function(){if(Le.status==200||Le.status==0&&Le.response)se(Le.response);else{var Ke=zt(G);Ke?se(Ke.buffer):ge()}},Le.onerror=ge,Le.send(null)}),e.print||console.log.bind(console);var L=e.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(e[o]=s[o]);s=null;var B;e.wasmBinary&&(B=e.wasmBinary);var U=e.noExitRuntime||!0;typeof WebAssembly!="object"&&V("no native wasm support detected");var J,T=!1;function Z(G,se){G||V("Assertion failed: "+se)}function ee(G){var se=e["_"+G];return Z(se,"Cannot call unknown function "+G+", make sure it is exported"),se}function $(G,se,ge,Le){var Ke={string:function(Je){var pt=0;if(Je!=null&&Je!==0){var Et=(Je.length<<2)+1;pt=ir(Et);var ct=pt,rt=M;if(0<Et){Et=ct+Et-1;for(var Ft=0;Ft<Je.length;++Ft){var ht=Je.charCodeAt(Ft);if(55296<=ht&&57343>=ht){var In=Je.charCodeAt(++Ft);ht=65536+((ht&1023)<<10)|In&1023}if(127>=ht){if(ct>=Et)break;rt[ct++]=ht}else{if(2047>=ht){if(ct+1>=Et)break;rt[ct++]=192|ht>>6}else{if(65535>=ht){if(ct+2>=Et)break;rt[ct++]=224|ht>>12}else{if(ct+3>=Et)break;rt[ct++]=240|ht>>18,rt[ct++]=128|ht>>12&63}rt[ct++]=128|ht>>6&63}rt[ct++]=128|ht&63}}rt[ct]=0}}return pt},array:function(Je){var pt=ir(Je.length);return R.set(Je,pt),pt}},_t=ee(G),$t=[];if(G=0,Le)for(var Tt=0;Tt<Le.length;Tt++){var vn=Ke[ge[Tt]];vn?(G===0&&(G=rr()),$t[Tt]=vn(Le[Tt])):$t[Tt]=Le[Tt]}return ge=_t.apply(null,$t),ge=function(Je){if(se==="string")if(Je){for(var pt=M,Et=Je+NaN,ct=Je;pt[ct]&&!(ct>=Et);)++ct;if(16<ct-Je&&pt.subarray&&x)Je=x.decode(pt.subarray(Je,ct));else{for(Et="";Je<ct;){var rt=pt[Je++];if(rt&128){var Ft=pt[Je++]&63;if((rt&224)==192)Et+=String.fromCharCode((rt&31)<<6|Ft);else{var ht=pt[Je++]&63;rt=(rt&240)==224?(rt&15)<<12|Ft<<6|ht:(rt&7)<<18|Ft<<12|ht<<6|pt[Je++]&63,65536>rt?Et+=String.fromCharCode(rt):(rt-=65536,Et+=String.fromCharCode(55296|rt>>10,56320|rt&1023))}}else Et+=String.fromCharCode(rt)}Je=Et}}else Je="";else Je=se==="boolean"?!!Je:Je;return Je}(ge),G!==0&&Ur(G),ge}var x=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,S,R,M;function O(){var G=J.buffer;S=G,e.HEAP8=R=new Int8Array(G),e.HEAP16=new Int16Array(G),e.HEAP32=new Int32Array(G),e.HEAPU8=M=new Uint8Array(G),e.HEAPU16=new Uint16Array(G),e.HEAPU32=new Uint32Array(G),e.HEAPF32=new Float32Array(G),e.HEAPF64=new Float64Array(G)}var re,z=[],Y=[],te=[];function ie(){var G=e.preRun.shift();z.unshift(G)}var k=0,Q=null,F=null;e.preloadedImages={},e.preloadedAudios={};function V(G){throw e.onAbort&&e.onAbort(G),L(G),T=!0,G=new WebAssembly.RuntimeError("abort("+G+"). Build with -s ASSERTIONS=1 for more info."),i(G),G}var le="data:application/octet-stream;base64,",He;if(He="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==",!He.startsWith(le)){var Ae=He;He=e.locateFile?e.locateFile(Ae,d):d+Ae}function st(){var G=He;try{if(G==He&&B)return new Uint8Array(B);var se=zt(G);if(se)return se;if(g)return g(G);throw"both async and sync fetching of the wasm failed"}catch(ge){V(ge)}}function St(){if(!B&&(f||a)){if(typeof fetch=="function"&&!He.startsWith("file://"))return fetch(He,{credentials:"same-origin"}).then(function(G){if(!G.ok)throw"failed to load wasm binary file at '"+He+"'";return G.arrayBuffer()}).catch(function(){return st()});if(H)return new Promise(function(G,se){H(He,function(ge){G(new Uint8Array(ge))},se)})}return Promise.resolve().then(function(){return st()})}function nr(G){for(;0<G.length;){var se=G.shift();if(typeof se=="function")se(e);else{var ge=se.m;typeof ge=="number"?se.l===void 0?re.get(ge)():re.get(ge)(se.l):ge(se.l===void 0?null:se.l)}}}var mn=!1,Nn=typeof atob=="function"?atob:function(G){var se="",ge=0;G=G.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(G.charAt(ge++)),Ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(G.charAt(ge++)),_t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(G.charAt(ge++)),$t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(G.charAt(ge++));Le=Le<<2|Ke>>4,Ke=(Ke&15)<<4|_t>>2;var Tt=(_t&3)<<6|$t;se+=String.fromCharCode(Le),_t!==64&&(se+=String.fromCharCode(Ke)),$t!==64&&(se+=String.fromCharCode(Tt))}while(ge<G.length);return se};function zt(G){if(G.startsWith(le)){if(G=G.slice(le.length),typeof h=="boolean"&&h){var se=Buffer.from(G,"base64");se=new Uint8Array(se.buffer,se.byteOffset,se.byteLength)}else try{var ge=Nn(G),Le=new Uint8Array(ge.length);for(G=0;G<ge.length;++G)Le[G]=ge.charCodeAt(G);se=Le}catch{throw Error("Converting base64 string to bytes failed.")}return se}}var Bn={a:function(G){var se=M.length;if(G>>>=0,2147483648<G)return!1;for(var ge=1;4>=ge;ge*=2){var Le=se*(1+.2/ge);Le=Math.min(Le,G+100663296),Le=Math.max(G,Le),0<Le%65536&&(Le+=65536-Le%65536);e:{try{J.grow(Math.min(2147483648,Le)-S.byteLength+65535>>>16),O();var Ke=1;break e}catch{}Ke=void 0}if(Ke)return!0}return!1}};(function(){function G(Ke){e.asm=Ke.exports,J=e.asm.b,O(),re=e.asm.j,Y.unshift(e.asm.c),k--,e.monitorRunDependencies&&e.monitorRunDependencies(k),k==0&&(Q!==null&&(clearInterval(Q),Q=null),F&&(Ke=F,F=null,Ke()))}function se(Ke){G(Ke.instance)}function ge(Ke){return St().then(function(_t){return WebAssembly.instantiate(_t,Le)}).then(Ke,function(_t){L("failed to asynchronously prepare wasm: "+_t),V(_t)})}var Le={a:Bn};if(k++,e.monitorRunDependencies&&e.monitorRunDependencies(k),e.instantiateWasm)try{return e.instantiateWasm(Le,G)}catch(Ke){return L("Module.instantiateWasm callback failed with error: "+Ke),!1}return function(){return B||typeof WebAssembly.instantiateStreaming!="function"||He.startsWith(le)||He.startsWith("file://")||typeof fetch!="function"?ge(se):fetch(He,{credentials:"same-origin"}).then(function(Ke){return WebAssembly.instantiateStreaming(Ke,Le).then(se,function(_t){return L("wasm streaming compile failed: "+_t),L("falling back to ArrayBuffer instantiation"),ge(se)})})}().catch(i),{}})(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.c).apply(null,arguments)},e._poly1305_auth=function(){return(e._poly1305_auth=e.asm.d).apply(null,arguments)};var rr=e.stackSave=function(){return(rr=e.stackSave=e.asm.e).apply(null,arguments)},Ur=e.stackRestore=function(){return(Ur=e.stackRestore=e.asm.f).apply(null,arguments)},ir=e.stackAlloc=function(){return(ir=e.stackAlloc=e.asm.g).apply(null,arguments)};e._malloc=function(){return(e._malloc=e.asm.h).apply(null,arguments)},e._free=function(){return(e._free=e.asm.i).apply(null,arguments)},e.cwrap=function(G,se,ge,Le){ge=ge||[];var Ke=ge.every(function(_t){return _t==="number"});return se!=="string"&&Ke&&!Le?ee(G):function(){return $(G,se,ge,arguments)}};var kn;F=function G(){kn||Rn(),kn||(F=G)};function Rn(){function G(){if(!kn&&(kn=!0,e.calledRun=!0,!T)){if(nr(Y),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;){var se=e.postRun.shift();te.unshift(se)}nr(te)}}if(!(0<k)){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)ie();nr(z),0<k||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),G()},1)):G())}}if(e.run=Rn,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Rn(),t.ready}}();typeof ei=="object"&&typeof $i=="object"?$i.exports=Vi:typeof define=="function"&&define.amd?define([],function(){return Vi}):typeof ei=="object"&&(ei.createPoly1305=Vi)});var un=je((Nd,of)=>{"use strict";var{createCipheriv:Gn,createDecipheriv:ti,createHmac:Yi,randomFillSync:yn,timingSafeEqual:Zi}=require("crypto"),{readUInt32BE:dr,writeUInt32BE:Ut}=Wt(),ln=Buffer[Symbol.species],tf=2**32-1,nf=Buffer.alloc(0),Mn=Buffer.alloc(4),ni=new Map,Cn=35e3,ji,ls,ds,As,_s,Hs,Es;try{ji=Jo(),{AESGCMCipher:ls,ChaChaPolyCipher:ds,GenericCipher:As,AESGCMDecipher:_s,ChaChaPolyDecipher:Hs,GenericDecipher:Es}=ji}catch{}var xt=1,vc=(()=>{function n(t,e,r,i,s,o,f){return{sslName:t,blockLen:e,keyLen:r,ivLen:i!==0||f&xt?i:e,authLen:s,discardLen:o,stream:!!(f&xt)}}return{"chacha20-poly1305@openssh.com":n("chacha20",8,64,0,16,0,xt),"aes128-gcm":n("aes-128-gcm",16,16,12,16,0,xt),"aes256-gcm":n("aes-256-gcm",16,32,12,16,0,xt),"aes128-gcm@openssh.com":n("aes-128-gcm",16,16,12,16,0,xt),"aes256-gcm@openssh.com":n("aes-256-gcm",16,32,12,16,0,xt),"aes128-cbc":n("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":n("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":n("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":n("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":n("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":n("bf-cbc",8,16,0,0,0,0),"idea-cbc":n("idea-cbc",8,16,0,0,0,0),"cast128-cbc":n("cast-cbc",8,16,0,0,0,0),"aes128-ctr":n("aes-128-ctr",16,16,16,0,0,xt),"aes192-ctr":n("aes-192-ctr",16,24,16,0,0,xt),"aes256-ctr":n("aes-256-ctr",16,32,16,0,0,xt),"3des-ctr":n("des-ede3",8,24,8,0,0,xt),"blowfish-ctr":n("bf-ecb",8,16,8,0,0,xt),"cast128-ctr":n("cast5-ecb",8,16,8,0,0,xt),arcfour:n("rc4",8,16,0,0,1536,xt),arcfour128:n("rc4",8,16,0,0,1536,xt),arcfour256:n("rc4",8,32,0,0,1536,xt),arcfour512:n("rc4",8,64,0,0,1536,xt)}})(),Dc=(()=>{function n(t,e,r,i){return{sslName:t,len:e,actualLen:r,isETM:i}}return{"hmac-md5":n("md5",16,16,!1),"hmac-md5-96":n("md5",16,12,!1),"hmac-ripemd160":n("ripemd160",20,20,!1),"hmac-sha1":n("sha1",20,20,!1),"hmac-sha1-etm@openssh.com":n("sha1",20,20,!0),"hmac-sha1-96":n("sha1",20,12,!1),"hmac-sha2-256":n("sha256",32,32,!1),"hmac-sha2-256-etm@openssh.com":n("sha256",32,32,!0),"hmac-sha2-256-96":n("sha256",32,12,!1),"hmac-sha2-512":n("sha512",64,64,!1),"hmac-sha2-512-etm@openssh.com":n("sha512",64,64,!0),"hmac-sha2-512-96":n("sha512",64,12,!1)}})(),zi=class{constructor(t,e){this.outSeqno=t,this._onWrite=e,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e&7);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return Ut(i,e-4,0),i[4]=r,yn(i,5+t,r),i}encrypt(t){this._dead||(this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},rf=Buffer.alloc(32),kt=Buffer.alloc(16),lr,Ar,gs,Ji=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encKeyMain=e.cipherKey.slice(0,32),this._encKeyPktLen=e.cipherKey.slice(32),this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e-4&7);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return Ut(i,e-4,0),i[4]=r,yn(i,5+t,r),i}encrypt(t){if(this._dead)return;kt[0]=0,Ut(kt,this.outSeqno,12);let e=Gn("chacha20",this._encKeyMain,kt).update(rf),r=Gn("chacha20",this._encKeyPktLen,kt).update(t.slice(0,4));this._onWrite(r),kt[0]=1;let i=Gn("chacha20",this._encKeyMain,kt).update(t.slice(4));this._onWrite(i),gs(Ar,r,r.length,i,i.length,e);let s=Buffer.allocUnsafe(16);s.set(new Uint8Array(lr.HEAPU8.buffer,Ar,16),0),this._onWrite(s),this.outSeqno=this.outSeqno+1>>>0}},es=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new ds(e.cipherKey),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=8-(e-4&7);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e+16);return Ut(i,e-4,0),i[4]=r,yn(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},ts=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encSSLName=e.cipherInfo.sslName,this._encKey=e.cipherKey,this._encIV=e.cipherIV,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=16-(e-4&15);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e);return Ut(i,e-4,0),i[4]=r,yn(i,5+t,r),i}encrypt(t){if(this._dead)return;let e=Gn(this._encSSLName,this._encKey,this._encIV);e.setAutoPadding(!1);let r=t.slice(0,4);e.setAAD(r),this._onWrite(r);let i=e.update(t.slice(4));this._onWrite(i);let s=e.final();s.length&&this._onWrite(s);let o=e.getAuthTag();this._onWrite(o),sf(this._encIV),this.outSeqno=this.outSeqno+1>>>0}},ns=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new ls(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=16-(e-4&15);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e+16);return Ut(i,e-4,0),i[4]=r,yn(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},rs=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._cipherInstance=Gn(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._aadLen=this._macETM?4:0,this._dead=!1;let r=e.cipherInfo.discardLen;if(r){let i=ni.get(r);i===void 0&&(i=Buffer.alloc(r),ni.set(r,i)),this._cipherInstance.update(i)}}free(){this._dead=!0}allocPacket(t){let e=this._encBlockLen,r=5+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r);return Ut(s,r-4,0),s[4]=i,yn(s,5+t,i),s}encrypt(t){if(this._dead)return;let e;if(this._macETM){let i=new Uint8Array(t.buffer,t.byteOffset,4),s=this._cipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+4,t.length-4));this._onWrite(i),this._onWrite(s),e=Yi(this._macSSLName,this._macKey),Ut(Mn,this.outSeqno,0),e.update(Mn),e.update(i),e.update(s)}else{let i=this._cipherInstance.update(t);this._onWrite(i),e=Yi(this._macSSLName,this._macKey),Ut(Mn,this.outSeqno,0),e.update(Mn),e.update(t)}let r=e.digest();r.length>this._macActualLen&&(r=r.slice(0,this._macActualLen)),this._onWrite(r),this.outSeqno=this.outSeqno+1>>>0}},is=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._macLen=e.macInfo.len,this._macActualLen=e.macInfo.actualLen,this._aadLen=e.macInfo.isETM?4:0,this._instance=new As(e.cipherInfo.sslName,e.cipherKey,e.cipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=this._encBlockLen,r=5+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r+this._macLen);return Ut(s,r-4,0),s[4]=i,yn(s,5+t,i),s}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._macActualLen<this._macLen&&(t=new ln(t.buffer,t.byteOffset,t.length-(this._macLen-this._macActualLen))),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},ss=class{constructor(t,e){this.inSeqno=t,this._onPayload=e,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len>Cn||this._len<8||(4+this._len&7)!==0)throw new Error("Bad packet length");if(e>=r)return}if(this._packetPos<this._len){let s=Math.min(this._len-this._packetPos,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),e+=s,this._packetPos+=s,this._packetPos<this._len)return}let i=this._packet?new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):nf;this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},os=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decKeyMain=e.decipherKey.slice(0,32),this._decKeyPktLen=e.decipherKey.slice(32),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._calcMac=Buffer.allocUnsafe(16),this._macPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let f=Math.min(4-this._lenPos,r-e);for(;f--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;kt[0]=0,Ut(kt,this.inSeqno,12);let a=ti("chacha20",this._decKeyPktLen,kt).update(this._lenBuf);if(this._len=dr(a,0),this._len>Cn||this._len<8||(this._len&7)!==0)throw new Error("Bad packet length")}if(this._pktLen<this._len){if(e>=r)return;let f=Math.min(this._len-this._pktLen,r-e),a;if(e!==0||f!==r?a=new Uint8Array(t.buffer,t.byteOffset+e,f):a=t,f===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._pktLen)),e+=f,this._pktLen+=f,this._pktLen<this._len||e>=r)return}{let f=Math.min(16-this._macPos,r-e);if(e!==0||f!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,f),this._macPos):this._mac.set(t,this._macPos),e+=f,this._macPos+=f,this._macPos<16)return}kt[0]=0,Ut(kt,this.inSeqno,12);let i=Gn("chacha20",this._decKeyMain,kt).update(rf);if(gs(Ar,this._lenBuf,4,this._packet,this._packet.length,i),this._calcMac.set(new Uint8Array(lr.HEAPU8.buffer,Ar,16),0),!Zi(this._calcMac,this._mac))throw new Error("Invalid MAC");kt[0]=1;let s=ti("chacha20",this._decKeyMain,kt).update(this._packet),o=new ln(s.buffer,s.byteOffset+1,s.length-s[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let f=this._onPayload(o);if(f!==void 0)return f===!1?e:f}}}},fs=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new Hs(e.decipherKey),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._macPos=0}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let s=Math.min(4-this._lenPos,r-e);for(;s--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;if(this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno),this._len>Cn||this._len<8||(this._len&7)!==0)throw new Error("Bad packet length");if(e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);let i=new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},as=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=null,this._decipherSSLName=e.decipherInfo.sslName,this._decipherKey=e.decipherKey,this._decipherIV=e.decipherIV,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>Cn||this._len<16||(this._len&15)!==0)throw new Error("Bad packet length");this._decipherInstance=ti(this._decipherSSLName,this._decipherKey,this._decipherIV),this._decipherInstance.setAutoPadding(!1),this._decipherInstance.setAAD(Tc(this._len))}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=this._decipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+e,s)):o=this._decipherInstance.update(t),o.length&&(s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),this._packetPos+=o.length),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);let s=this._decipherInstance.final();s.length&&(this._packet?this._packet.set(s,this._packetPos):this._packet=s)}let i=this._packet?new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):nf;this.inSeqno=this.inSeqno+1>>>0,sf(this._decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},cs=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new _s(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>Cn||this._len<16||(this._len&15)!==0)throw new Error(`Bad packet length: ${this._len}`)}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);let i=new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},hs=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=ti(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._decipherInstance.setAutoPadding(!1),this._block=Buffer.allocUnsafe(e.macInfo.isETM?4:e.decipherInfo.blockLen),this._blockSize=e.decipherInfo.blockLen,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._macInstance=null;let r=e.decipherInfo.discardLen;if(r){let i=ni.get(r);i===void 0&&(i=Buffer.alloc(r),ni.set(r,i)),this._decipherInstance.update(i)}}free(){}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let o=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||o!==r||o<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._blockPos):this._block.set(t,this._blockPos),e+=o,this._blockPos+=o,this._blockPos<this._block.length)return;let f,a;if(this._macETM?this._len=a=dr(this._block,0):(f=this._decipherInstance.update(this._block),this._len=dr(f,0),a=4+this._len-this._blockSize),this._len>Cn||this._len<5||(a&this._blockSize-1)!==0)throw new Error("Bad packet length");if(this._macInstance=Yi(this._macSSLName,this._macKey),Ut(Mn,this.inSeqno,0),this._macInstance.update(Mn),this._macETM?this._macInstance.update(this._block):(this._macInstance.update(new Uint8Array(f.buffer,f.byteOffset,4)),this._pktLen=f.length-4,this._packetPos=this._pktLen,this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(f.buffer,f.byteOffset+4,this._packetPos),0)),e>=r)return}if(this._pktLen<this._len){let o=Math.min(this._len-this._pktLen,r-e),f;e!==0||o!==r?f=new Uint8Array(t.buffer,t.byteOffset+e,o):f=t,this._macETM&&this._macInstance.update(f);let a=this._decipherInstance.update(f);if(a.length&&(o===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._packetPos)),this._packetPos+=a.length),e+=o,this._pktLen+=o,this._pktLen<this._len||e>=r)return}{let o=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||o!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._macPos):this._mac.set(t,this._macPos),e+=o,this._macPos+=o,this._macPos<this._macActualLen)return}this._macETM||this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length&&(i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)),!Pc(i,this._mac))throw new Error("Invalid MAC");let s=new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._macPos=0,this._macInstance=null;{let o=this._onPayload(s);if(o!==void 0)return o===!1?e:o}}}},us=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new Es(e.decipherInfo.sslName,e.decipherKey,e.decipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM,e.macInfo.actualLen),this._block=Buffer.allocUnsafe(e.macInfo.isETM||e.decipherInfo.stream?4:e.decipherInfo.blockLen),this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let s=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||s!==r||s<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._blockPos):this._block.set(t,this._blockPos),e+=s,this._blockPos+=s,this._blockPos<this._block.length)return;let o;if(this._macETM?this._len=o=dr(this._block,0):(this._instance.decryptBlock(this._block),this._len=dr(this._block,0),o=4+this._len-this._block.length),this._len>Cn||this._len<5||(o&this._block.length-1)!==0)throw new Error("Bad packet length");if(this._macETM||(this._pktLen=this._block.length-4,this._pktLen&&(this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0))),e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);let i=new ln(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._macPos=0,this._macInstance=null;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}};function sf(n){++n[11]>>>8&&++n[10]>>>8&&++n[9]>>>8&&++n[8]>>>8&&++n[7]>>>8&&++n[6]>>>8&&++n[5]>>>8&&++n[4]>>>8}var Tc=(()=>{let n=Buffer.alloc(4);return t=>(n[0]=t>>>24,n[1]=t>>>16,n[2]=t>>>8,n[3]=t,n)})();function Pc(n,t){return n.length!==t.length?(Zi(n,n),!1):Zi(n,t)}function Uc(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.outbound!="object"||n.outbound===null)throw new Error("Invalid outbound");let t=n.outbound;if(typeof t.onWrite!="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen)throw new Error("Invalid outbound.cipherKey");if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen))throw new Error("Invalid outbound.cipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>tf)throw new Error("Invalid outbound.seqno");let e=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return ls&&!e?new ns(n):new ts(n);case"chacha20":return ds&&!e?new es(n):new Ji(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid outbound.macKey");return As&&!e?new is(n):new rs(n)}}}function Oc(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.inbound!="object"||n.inbound===null)throw new Error("Invalid inbound");let t=n.inbound;if(typeof t.onPayload!="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!="object"||t.decipherInfo===null)throw new Error("Invalid inbound.decipherInfo");if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen)throw new Error("Invalid inbound.decipherKey");if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen))throw new Error("Invalid inbound.decipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>tf)throw new Error("Invalid inbound.seqno");let e=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return _s&&!e?new cs(n):new as(n);case"chacha20":return Hs&&!e?new fs(n):new os(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid inbound.macKey");return Es&&!e?new us(n):new hs(n)}}}of.exports={CIPHER_INFO:vc,MAC_INFO:Dc,bindingAvailable:!!ji,init:new Promise(async(n,t)=>{try{lr=await ef()(),Ar=lr._malloc(16),gs=lr.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}n()}),NullCipher:zi,createCipher:Uc,NullDecipher:ss,createDecipher:Oc}});var An=je((Bd,Hf)=>{"use strict";var{createDecipheriv:Is,createECDH:Fc,createHash:Hr,createHmac:Qc,createSign:Mc,createVerify:Gc,getCiphers:Kc,sign:ff,verify:af}=require("crypto"),Wc=Kc(),{Ber:Ce}=cr(),qc=Ki().pbkdf,{CIPHER_INFO:Er}=un(),{eddsaSupported:bs,SUPPORTED_CIPHER:Xc}=nn(),{bufferSlice:wn,makeBufferParser:Vc,readString:Se,readUInt32BE:_r,writeUInt32BE:It}=Wt(),rn=Symbol("Hash Algorithm"),qt=Symbol("Private key PEM"),Yt=Symbol("Public key PEM"),dn=Symbol("Public key SSH"),Kn=Symbol("Decrypted Key"),ps=Object.create(null);{let n=Object.keys(Er);for(let t=0;t<n.length;++t){let e=Er[n[t]].sslName;!e||ps[e]||(ps[e]=Er[n[t]])}}var ri=Vc();function Xt(n,t){t=t.base64Slice(0,t.length);let e=t.replace(/.{64}/g,`$&
`);return t.length&63&&(e+=`
`),`-----BEGIN ${n} KEY-----
${e}-----END ${n} KEY-----`}function gr(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return e.set(n,0),e.set(t,n.length),e}function xs(n,t){let e=n.length,r=n._pos||0;for(let i=0;i<t;++i){let s=e-r;if(r>=e||s<4)return!1;let o=_r(n,r);if(s<4+o)return!1;r+=4+o}return n._pos=r,!0}function pr(n,t){let e=new Ce.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.113549.1.1.1"),e.writeNull(),e.endSequence(),e.startSequence(Ce.BitString),e.writeByte(0),e.startSequence(),e.writeBuffer(n,Ce.Integer),e.writeBuffer(t,Ce.Integer),e.endSequence(),e.endSequence(),e.endSequence(),Xt("PUBLIC",e.buffer)}function Ir(n,t){let e=Buffer.allocUnsafe(15+t.length+4+n.length);It(e,7,0),e.utf8Write("ssh-rsa",4,7);let r=11;return It(e,t.length,r),e.set(t,r+=4),It(e,n.length,r+=t.length),e.set(n,r+4),e}var cf=(()=>{function n(r,i,s,o,f,a,h,d){let l=new Ce.Writer;return l.startSequence(),l.writeInt(0,Ce.Integer),l.writeBuffer(r,Ce.Integer),l.writeBuffer(i,Ce.Integer),l.writeBuffer(s,Ce.Integer),l.writeBuffer(o,Ce.Integer),l.writeBuffer(f,Ce.Integer),l.writeBuffer(a,Ce.Integer),l.writeBuffer(h,Ce.Integer),l.writeBuffer(d,Ce.Integer),l.endSequence(),l.buffer}function t(r){return BigInt(`0x${r.hexSlice(0,r.length)}`)}function e(r){let i=r.toString(16);if((i.length&1)!==0)i=`0${i}`;else{let s=i.charCodeAt(0);(s===56||s===57||s>=97&&s<=102)&&(i=`00${i}`)}return Buffer.from(i,"hex")}return function(i,s,o,f,a,h){let d=t(o),l=e(d%(t(a)-1n)),H=e(d%(t(h)-1n));return Xt("RSA PRIVATE",n(i,s,o,a,h,l,H,f))}})();function br(n,t,e,r){let i=new Ce.Writer;return i.startSequence(),i.startSequence(),i.writeOID("1.2.840.10040.4.1"),i.startSequence(),i.writeBuffer(n,Ce.Integer),i.writeBuffer(t,Ce.Integer),i.writeBuffer(e,Ce.Integer),i.endSequence(),i.endSequence(),i.startSequence(Ce.BitString),i.writeByte(0),i.writeBuffer(r,Ce.Integer),i.endSequence(),i.endSequence(),Xt("PUBLIC",i.buffer)}function xr(n,t,e,r){let i=Buffer.allocUnsafe(15+n.length+4+t.length+4+e.length+4+r.length);It(i,7,0),i.utf8Write("ssh-dss",4,7);let s=11;return It(i,n.length,s),i.set(n,s+=4),It(i,t.length,s+=n.length),i.set(t,s+=4),It(i,e.length,s+=t.length),i.set(e,s+=4),It(i,r.length,s+=e.length),i.set(r,s+4),i}function hf(n,t,e,r,i){let s=new Ce.Writer;return s.startSequence(),s.writeInt(0,Ce.Integer),s.writeBuffer(n,Ce.Integer),s.writeBuffer(t,Ce.Integer),s.writeBuffer(e,Ce.Integer),s.writeBuffer(r,Ce.Integer),s.writeBuffer(i,Ce.Integer),s.endSequence(),Xt("DSA PRIVATE",s.buffer)}function uf(n){let t=new Ce.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Ce.BitString),t.writeByte(0),t._ensure(n.length),t._buf.set(n,t._offset),t._offset+=n.length,t.endSequence(),t.endSequence(),Xt("PUBLIC",t.buffer)}function lf(n){let t=Buffer.allocUnsafe(19+n.length);return It(t,11,0),t.utf8Write("ssh-ed25519",4,11),It(t,n.length,15),t.set(n,19),t}function $c(n){let t=new Ce.Writer;return t.startSequence(),t.writeInt(0,Ce.Integer),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Ce.OctetString),t.writeBuffer(n,Ce.OctetString),t.endSequence(),t.endSequence(),Xt("PRIVATE",t.buffer)}function Ss(n,t){let e=new Ce.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.10045.2.1"),e.writeOID(n),e.endSequence(),e.startSequence(Ce.BitString),e.writeByte(0),e._ensure(t.length),e._buf.set(t,e._offset),e._offset+=t.length,e.endSequence(),e.endSequence(),Xt("PUBLIC",e.buffer)}function ys(n,t){let e;switch(n){case"1.2.840.10045.3.1.7":e="nistp256";break;case"1.3.132.0.34":e="nistp384";break;case"1.3.132.0.35":e="nistp521";break;default:return}let r=Buffer.allocUnsafe(39+t.length);return It(r,19,0),r.utf8Write(`ecdsa-sha2-${e}`,4,19),It(r,8,23),r.utf8Write(e,27,8),It(r,t.length,35),r.set(t,39),r}function Yc(n,t,e){let r=new Ce.Writer;return r.startSequence(),r.writeInt(1,Ce.Integer),r.writeBuffer(e,Ce.OctetString),r.startSequence(160),r.writeOID(n),r.endSequence(),r.startSequence(161),r.startSequence(Ce.BitString),r.writeByte(0),r._ensure(t.length),r._buf.set(t,r._offset),r._offset+=t.length,r.endSequence(),r.endSequence(),r.endSequence(),Xt("EC PRIVATE",r.buffer)}function Zc(n,t){let e=Fc(n);return e.setPrivateKey(t),e.getPublicKey()}var Sr={sign:typeof ff=="function"?function(t,e){let r=this[qt];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[rn]);try{return ff(e,t,r)}catch(i){return i}}:function(t,e){let r=this[qt];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[rn]);let i=Mc(e);i.update(t);try{return i.sign(r)}catch(s){return s}},verify:typeof af=="function"?function(t,e,r){let i=this[Yt];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[rn]);try{return af(r,t,i,e)}catch(s){return s}}:function(t,e,r){let i=this[Yt];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[rn]);let s=Gc(r);s.update(t);try{return s.verify(i,e)}catch(o){return o}},isPrivateKey:function(){return this[qt]!==null},getPrivatePEM:function(){return this[qt]},getPublicPEM:function(){return this[Yt]},getPublicSSH:function(){return this[dn]},equals:function(t){let e=_f(t);return e instanceof Error?!1:this.type===e.type&&this[qt]===e[qt]&&this[Yt]===e[Yt]&&this[dn]===e[dn]}};function ii(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[qt]=e,this[Yt]=r,this[dn]=i,this[rn]=s,this[Kn]=o}ii.prototype=Sr;{let t=function(e,r,i){let s=[];if(e.length<8)return new Error("Malformed OpenSSH private key");let o=_r(e,0),f=_r(e,4);if(o!==f)return i?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");e._pos=8;let a,h;for(a=0;a<r;++a){let l,H,g,I,b=Se(e,e._pos,!0);if(b===void 0)return new Error("Malformed OpenSSH private key");switch(b){case"ssh-rsa":{let B=Se(e,e._pos);if(B===void 0)return new Error("Malformed OpenSSH private key");let U=Se(e,e._pos);if(U===void 0)return new Error("Malformed OpenSSH private key");let J=Se(e,e._pos);if(J===void 0)return new Error("Malformed OpenSSH private key");let T=Se(e,e._pos);if(T===void 0)return new Error("Malformed OpenSSH private key");let Z=Se(e,e._pos);if(Z===void 0)return new Error("Malformed OpenSSH private key");let ee=Se(e,e._pos);if(ee===void 0)return new Error("Malformed OpenSSH private key");g=pr(B,U),I=Ir(B,U),H=cf(B,U,J,T,Z,ee),l="sha1";break}case"ssh-dss":{let B=Se(e,e._pos);if(B===void 0)return new Error("Malformed OpenSSH private key");let U=Se(e,e._pos);if(U===void 0)return new Error("Malformed OpenSSH private key");let J=Se(e,e._pos);if(J===void 0)return new Error("Malformed OpenSSH private key");let T=Se(e,e._pos);if(T===void 0)return new Error("Malformed OpenSSH private key");let Z=Se(e,e._pos);if(Z===void 0)return new Error("Malformed OpenSSH private key");g=br(B,U,J,T),I=xr(B,U,J,T),H=hf(B,U,J,T,Z),l="sha1";break}case"ssh-ed25519":{if(!bs)return new Error(`Unsupported OpenSSH private key type: ${b}`);let B=Se(e,e._pos);if(B===void 0||B.length!==32)return new Error("Malformed OpenSSH private key");let U=Se(e,e._pos);if(U===void 0||U.length!==64)return new Error("Malformed OpenSSH private key");g=uf(B),I=lf(B),H=$c(wn(U,0,32)),l=null;break}case"ecdsa-sha2-nistp256":l="sha256",h="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":l===void 0&&(l="sha384",h="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(l===void 0&&(l="sha512",h="1.3.132.0.35"),!xs(e,1))return new Error("Malformed OpenSSH private key");let B=Se(e,e._pos);if(B===void 0)return new Error("Malformed OpenSSH private key");let U=Se(e,e._pos);if(U===void 0)return new Error("Malformed OpenSSH private key");g=Ss(h,B),I=ys(h,B),H=Yc(h,B,U);break}default:return new Error(`Unsupported OpenSSH private key type: ${b}`)}let L=Se(e,e._pos,!0);if(L===void 0)return new Error("Malformed OpenSSH private key");s.push(new ii(b,L,H,g,I,l,i))}let d=0;for(a=e._pos;a<e.length;++a)if(e[a]!==++d%255)return new Error("Malformed OpenSSH private key");return s},n=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;ii.parse=(e,r)=>{let i=n.exec(e);if(i===null)return null;let s,o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");let f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);let a=Se(o,15,!0);if(a===void 0)return new Error("Malformed OpenSSH private key");if(a!=="none"&&Xc.indexOf(a)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${a}`);let h=Se(o,o._pos,!0);if(h===void 0)return new Error("Malformed OpenSSH private key");if(h!=="none"){if(a==="none")return new Error("Malformed OpenSSH private key");if(h!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${h}`);if(!r)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if(a!=="none")return new Error("Malformed OpenSSH private key");let d,l,H;a!=="none"&&(d=Er[a]);let g=Se(o,o._pos);if(g===void 0)return new Error("Malformed OpenSSH private key");if(g.length)switch(h){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":{let b=Se(g,0);if(b===void 0||g._pos+4>g.length)return new Error("Malformed OpenSSH private key");let L=_r(g,g._pos),B=Buffer.allocUnsafe(d.keyLen+d.ivLen);if(qc(r,r.length,b,b.length,B,B.length,L)!==0)return new Error("Failed to generate information to decrypt key");l=wn(B,0,d.keyLen),H=wn(B,d.keyLen,B.length);break}}else if(h!=="none")return new Error("Malformed OpenSSH private key");if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");let I=_r(o,o._pos);if(o._pos+=4,I>0){for(let L=0;L<I;++L){let B=Se(o,o._pos);if(B===void 0)return new Error("Malformed OpenSSH private key");if(Se(B,0,!0)===void 0)return new Error("Malformed OpenSSH private key")}let b=Se(o,o._pos);if(b===void 0)return new Error("Malformed OpenSSH private key");if(l!==void 0){if(b.length<d.blockLen||b.length%d.blockLen!==0)return new Error("Malformed OpenSSH private key");try{let L={authTagLength:d.authLen},B=Is(d.sslName,l,H,L);if(B.setAutoPadding(!1),d.authLen>0){if(o.length-o._pos<d.authLen)return new Error("Malformed OpenSSH private key");B.setAuthTag(wn(o,o._pos,o._pos+=d.authLen))}b=gr(B.update(b),B.final())}catch(L){return L}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=t(b,I,l!==void 0)}else s=[];return s instanceof Error?s:s[0]}}function si(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[qt]=e,this[Yt]=r,this[dn]=i,this[rn]=s,this[Kn]=o}si.prototype=Sr;{let n=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;si.parse=(t,e)=>{let r=n.exec(t);if(r===null)return null;let i=Buffer.from(r[3],"base64"),s=r[2],o=!1;if(s!==void 0){s=s.split(/\r\n|\n/g);for(let I=0;I<s.length;++I){let b=s[I],L=b.indexOf(":");if(b.slice(0,L)==="DEK-Info"){let B=b.slice(L+2);if(L=B.indexOf(","),L===-1)continue;let U=B.slice(0,L).toLowerCase();if(Wc.indexOf(U)===-1)return new Error(`Cipher (${U}) not supported for encrypted OpenSSH private key`);let J=ps[U];if(!J)return new Error(`Cipher (${U}) not supported for encrypted OpenSSH private key`);let T=Buffer.from(B.slice(L+1),"hex");if(T.length!==J.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!e)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");let Z=wn(T,0,8),ee=Hr("md5").update(e).update(Z).digest();for(;ee.length<J.keyLen;)ee=gr(ee,Hr("md5").update(ee).update(e).update(Z).digest());ee.length>J.keyLen&&(ee=wn(ee,0,J.keyLen));try{let $=Is(U,ee,T);$.setAutoPadding(!1),i=gr($.update(i),$.final()),o=!0}catch($){return $}}}}let f,a,h,d,l,H,g="Malformed OpenSSH private key";switch(o&&(g+=". Bad passphrase?"),r[1]){case"RSA":f="ssh-rsa",a=Xt("RSA PRIVATE",i);try{H=new Ce.Reader(i),H.readSequence(),H.readInt();let I=H.readString(Ce.Integer,!0);if(I===null)return new Error(g);let b=H.readString(Ce.Integer,!0);if(b===null)return new Error(g);h=pr(I,b),d=Ir(I,b)}catch{return new Error(g)}l="sha1";break;case"DSA":f="ssh-dss",a=Xt("DSA PRIVATE",i);try{H=new Ce.Reader(i),H.readSequence(),H.readInt();let I=H.readString(Ce.Integer,!0);if(I===null)return new Error(g);let b=H.readString(Ce.Integer,!0);if(b===null)return new Error(g);let L=H.readString(Ce.Integer,!0);if(L===null)return new Error(g);let B=H.readString(Ce.Integer,!0);if(B===null)return new Error(g);h=br(I,b,L,B),d=xr(I,b,L,B)}catch{return new Error(g)}l="sha1";break;case"EC":{let I,b,L;try{H=new Ce.Reader(i),H.readSequence(),H.readInt(),b=H.readString(Ce.OctetString,!0),H.readByte();let U=H.readLength();if(U!==null){if(H._offset=U,L=H.readOID(),L===null)return new Error(g);switch(L){case"1.2.840.10045.3.1.7":I="prime256v1",f="ecdsa-sha2-nistp256",l="sha256";break;case"1.3.132.0.34":I="secp384r1",f="ecdsa-sha2-nistp384",l="sha384";break;case"1.3.132.0.35":I="secp521r1",f="ecdsa-sha2-nistp521",l="sha512";break;default:return new Error(`Unsupported private key EC OID: ${L}`)}}else return new Error(g)}catch{return new Error(g)}a=Xt("EC PRIVATE",i);let B=Zc(I,b);h=Ss(L,B),d=ys(L,B);break}}return new si(f,"",a,h,d,l,o)}}function oi(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[qt]=e,this[Yt]=r,this[dn]=i,this[rn]=s,this[Kn]=o}oi.prototype=Sr;{let n=Buffer.alloc(0),t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e=Buffer.from([0,0,0,0]),r=Buffer.from([0,0,0,1]),i=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;oi.parse=(s,o)=>{let f=i.exec(s);if(f===null)return null;let a=f[2],h=a!=="none";if(h&&!o)return new Error("Encrypted PPK private key detected, but no passphrase given");let d=Buffer.from(f[5],"base64");if(h){let R=Er[a],M=gr(Hr("sha1").update(e).update(o).digest(),Hr("sha1").update(r).update(o).digest());M.length>R.keyLen&&(M=wn(M,0,R.keyLen));try{let O=Is(R.sslName,M,t);O.setAutoPadding(!1),d=gr(O.update(d),O.final())}catch(O){return O}}let l=f[1],H=f[3],g=Buffer.from(f[4],"base64"),I=f[6],b=l.length,L=a.length,B=Buffer.byteLength(H),U=g.length,J=d.length,T=Buffer.allocUnsafe(4+b+4+L+4+B+4+U+4+J),Z=0;if(It(T,b,Z),T.utf8Write(l,Z+=4,b),It(T,L,Z+=b),T.utf8Write(a,Z+=4,L),It(T,B,Z+=L),T.utf8Write(H,Z+=4,B),It(T,U,Z+=B),T.set(g,Z+=4),It(T,J,Z+=U),T.set(d,Z+4),o||(o=n),Qc("sha1",Hr("sha1").update("putty-private-key-file-mac-key").update(o).digest()).update(T).digest("hex")!==I)return h?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");let $,x,S;switch(g._pos=0,xs(g,1),l){case"ssh-rsa":{let R=Se(g,g._pos);if(R===void 0)return new Error("Malformed PPK public key");let M=Se(g,g._pos);if(M===void 0)return new Error("Malformed PPK public key");let O=Se(d,0);if(O===void 0)return new Error("Malformed PPK private key");let re=Se(d,d._pos);if(re===void 0)return new Error("Malformed PPK private key");let z=Se(d,d._pos);if(z===void 0)return new Error("Malformed PPK private key");let Y=Se(d,d._pos);if(Y===void 0)return new Error("Malformed PPK private key");$=pr(M,R),x=Ir(M,R),S=cf(M,R,O,Y,re,z);break}case"ssh-dss":{let R=Se(g,g._pos);if(R===void 0)return new Error("Malformed PPK public key");let M=Se(g,g._pos);if(M===void 0)return new Error("Malformed PPK public key");let O=Se(g,g._pos);if(O===void 0)return new Error("Malformed PPK public key");let re=Se(g,g._pos);if(re===void 0)return new Error("Malformed PPK public key");let z=Se(d,0);if(z===void 0)return new Error("Malformed PPK private key");$=br(R,M,O,re),x=xr(R,M,O,re),S=hf(R,M,O,re,z);break}}return new oi(l,H,S,$,x,"sha1",h)}}function ai(n,t,e,r,i){this.type=n,this.comment=t,this[qt]=null,this[Yt]=e,this[dn]=r,this[rn]=i,this[Kn]=!1}ai.prototype=Sr;{let n;bs?n=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/:n=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/,ai.parse=t=>{let e=n.exec(t);if(e===null)return null;let r=e[1],i=e[2],s=Buffer.from(e[3],"base64"),o=e[4]||"",f=Se(s,s._pos,!0);return f===void 0||f.indexOf(i)!==0?new Error("Malformed OpenSSH public key"):Cs(s,i,o,r)}}function fi(n,t,e,r,i){this.type=n,this.comment=t,this[qt]=null,this[Yt]=e,this[dn]=r,this[rn]=i,this[Kn]=!1}fi.prototype=Sr;{let n=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/,t=/^[A-Z0-9a-z/+=\r\n]+$/,e=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm,r=/\\\r?\n/g;fi.parse=i=>{let s=n.exec(i);if(s===null)return null;let o=s[1],f=0,a="";for(;s=e.exec(o);){let g=s[1],I=s[2].replace(r,"");if(I.length>1024)return e.lastIndex=0,new Error("Malformed RFC4716 public key");f=e.lastIndex,g.toLowerCase()==="comment"&&(a=I,a.length>1&&a.charCodeAt(0)===34&&a.charCodeAt(a.length-1)===34&&(a=a.slice(1,-1)))}let h=o.slice(f);if(!t.test(h))return new Error("Malformed RFC4716 public key");h=Buffer.from(h,"base64");let d=Se(h,0,!0);if(d===void 0)return new Error("Malformed RFC4716 public key");let l=null,H=null;switch(d){case"ssh-rsa":{let g=Se(h,h._pos);if(g===void 0)return new Error("Malformed RFC4716 public key");let I=Se(h,h._pos);if(I===void 0)return new Error("Malformed RFC4716 public key");l=pr(I,g),H=Ir(I,g);break}case"ssh-dss":{let g=Se(h,h._pos);if(g===void 0)return new Error("Malformed RFC4716 public key");let I=Se(h,h._pos);if(I===void 0)return new Error("Malformed RFC4716 public key");let b=Se(h,h._pos);if(b===void 0)return new Error("Malformed RFC4716 public key");let L=Se(h,h._pos);if(L===void 0)return new Error("Malformed RFC4716 public key");l=br(g,I,b,L),H=xr(g,I,b,L);break}default:return new Error("Malformed RFC4716 public key")}return new fi(d,a,l,H,"sha1")}}function Cs(n,t,e,r){if(!df(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let i,s,o=null,f=null;switch(t){case"ssh-rsa":{let a=Se(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let h=Se(n,n._pos);if(h===void 0)return new Error("Malformed OpenSSH public key");o=pr(h,a),f=Ir(h,a),i="sha1";break}case"ssh-dss":{let a=Se(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let h=Se(n,n._pos);if(h===void 0)return new Error("Malformed OpenSSH public key");let d=Se(n,n._pos);if(d===void 0)return new Error("Malformed OpenSSH public key");let l=Se(n,n._pos);if(l===void 0)return new Error("Malformed OpenSSH public key");o=br(a,h,d,l),f=xr(a,h,d,l),i="sha1";break}case"ssh-ed25519":{let a=Se(n,n._pos||0);if(a===void 0||a.length!==32)return new Error("Malformed OpenSSH public key");o=uf(a),f=lf(a),i=null;break}case"ecdsa-sha2-nistp256":i="sha256",s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":i===void 0&&(i="sha384",s="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(i===void 0&&(i="sha512",s="1.3.132.0.35"),!xs(n,1))return new Error("Malformed OpenSSH public key");let a=Se(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");o=Ss(s,a),f=ys(s,a);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new ai(r,e,o,f,i)}function df(n){switch(n){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return!0;case"ssh-ed25519":if(bs)return!0;default:return!1}}function Af(n){return n?typeof n[Kn]=="boolean":!1}function _f(n,t){if(Af(n))return n;let e;if(Buffer.isBuffer(n))e=n,n=n.utf8Slice(0,n.length).trim();else if(typeof n=="string")n=n.trim();else return new Error("Key data must be a Buffer or string");if(t!=null){if(typeof t=="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let r;if((r=ii.parse(n,t))!==null||(r=si.parse(n,t))!==null||(r=oi.parse(n,t))!==null||(r=ai.parse(n))!==null||(r=fi.parse(n))!==null)return r;if(e){ri.init(e,0);let i=ri.readString(!0);i!==void 0&&(n=ri.readRaw(),n!==void 0&&(r=Cs(n,i,"",i),r instanceof Error&&(r=null))),ri.clear()}return r||new Error("Unsupported key format")}Hf.exports={isParsedKey:Af,isSupportedKeyType:df,parseDERKey:(n,t)=>Cs(n,t,"",t),parseKey:_f}});var ks=je((Dd,wf)=>{"use strict";var{Socket:If}=require("net"),{Duplex:bf}=require("stream"),{resolve:jc}=require("path"),{readFile:Ef}=require("fs"),{execFile:zc,spawn:Jc}=require("child_process"),{isParsedKey:gf,parseKey:yr}=An(),{makeBufferParser:eh,readUInt32BE:Bs,writeUInt32BE:Rt,writeUInt32LE:pf}=Wt();function Cr(n){let t=!1;return(...e)=>{t||(t=!0,n(...e))}}function th(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return n.copy(e,0),t.copy(e,n.length),e}function Ls(){}var nh=Buffer.alloc(0),at=eh(),wr=class{getIdentities(t){t(new Error("Missing getIdentities() implementation"))}sign(t,e,r,i){typeof r=="function"&&(i=r),i(new Error("Missing sign() implementation"))}},qn=class extends wr{constructor(t){super(),this.socketPath=t}getStream(t){t=Cr(t);let e=new If;e.on("connect",()=>{t(null,e)}),e.on("close",r).on("end",r).on("error",r),e.connect(this.socketPath);function r(){try{e.destroy()}catch{}t(new Error("Failed to connect to agent"))}}getIdentities(t){t=Cr(t),this.getStream((e,r)=>{function i(o){if(r)try{r.destroy()}catch{}o||(o=new Error("Failed to retrieve identities from agent")),t(o)}if(e)return i(e);let s=new ms(!0);s.on("error",i),s.pipe(r).pipe(s),r.on("close",i).on("end",i).on("error",i),s.getIdentities((o,f)=>{if(o)return i(o);try{r.destroy()}catch{}t(null,f)})})}sign(t,e,r,i){typeof r=="function"?(i=r,r=void 0):(typeof r!="object"||r===null)&&(r=void 0),i=Cr(i),this.getStream((s,o)=>{function f(h){if(o)try{o.destroy()}catch{}h||(h=new Error("Failed to sign data with agent")),i(h)}if(s)return f(s);let a=new ms(!0);a.on("error",f),a.pipe(o).pipe(a),o.on("close",f).on("end",f).on("error",f),a.sign(t,e,r,(h,d)=>{if(h)return f(h);try{o.destroy()}catch{}i(null,d)})})}},xf=(()=>{let o=jc(__dirname,"..","util/pagent.exe"),f={10:new Error("Invalid pagent.exe arguments"),11:new Error("Pageant is not running"),12:new Error("pagent.exe could not create an mmap"),13:new Error("pagent.exe could not set mode for stdin"),14:new Error("pagent.exe could not set mode for stdout"),15:new Error("pagent.exe did not get expected input payload")};function a(d){d.buffer=null,d.proc&&(d.proc.kill(),d.proc=void 0)}class h extends bf{constructor(){super(),this.proc=void 0,this.buffer=null}_read(l){}_write(l,H,g){if(this.buffer===null)this.buffer=l;else{let B=Buffer.allocUnsafe(this.buffer.length+l.length);this.buffer.copy(B,0),l.copy(B,this.buffer.length),this.buffer=B}if(this.buffer.length<4)return g();let I=Bs(this.buffer,0);if(this.buffer.length-4<I)return g();if(l=this.buffer.slice(0,4+I),this.buffer.length>4+I)return g(new Error("Unexpected multiple agent requests"));this.buffer=null;let b,L=this.proc=Jc(o,[l.length]);L.stdout.on("data",B=>{this.push(B)}),L.on("error",B=>{b=B,g(b)}),L.on("close",B=>{if(this.proc=void 0,!b){if(b=f[B])return g(b);g()}}),L.stdin.end(l)}_final(l){a(this),l()}_destroy(l,H){a(this),H()}}return class extends qn{getStream(l){l(null,new h)}}})(),Sf=(()=>{let n=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class extends qn{getStream(e){e=Cr(e);let r=this.socketPath,i=!1;Ef(r,function s(o,f){if(o){if(i)return e(new Error("Invalid cygwin unix socket path"));zc("cygpath",["-w",r],(ee,$,x)=>{if(ee||$.length===0)return e(new Error("Invalid cygwin unix socket path"));i=!0,r=$.toString().replace(/[\r\n]/g,""),Ef(r,s)});return}let a=n.exec(f.toString("ascii"));if(!a)return e(new Error("Malformed cygwin unix socket file"));let h,d=0,l=!1,H=[],g,I=Buffer.alloc(12),b=parseInt(a[1],10),L=a[2].replace(/-/g,""),B=Buffer.allocUnsafe(16);for(let ee=0,$=0;$<32;++ee,$+=2)B[ee]=parseInt(L.substring($,$+2),16);for(let ee=0;ee<16;ee+=4)pf(B,Bs(B,ee),ee);Z();function U(){d=0,h="secret",g.write(B)}function J(ee){if(d+=ee.length,h==="secret"){d===16&&(d=0,h="creds",g.write(I));return}if(h==="creds"&&(l||H.push(ee),d===12)){if(g.removeListener("connect",U),g.removeListener("data",J),g.removeListener("error",T),g.removeListener("end",T),g.removeListener("close",T),l)return e(null,g);l=!0,I=Buffer.concat(H),pf(I,process.pid,0),g.on("error",()=>{}),g.destroy(),Z()}}function T(){e(new Error("Problem negotiating cygwin unix socket security"))}function Z(){g=new If,g.on("connect",U),g.on("data",J),g.on("error",T),g.on("end",T),g.on("close",T),g.connect(b)}})}}})(),rh=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function yf(n){return process.platform==="win32"&&!rh.test(n)?n==="pageant"?new xf:new Sf(n):new qn(n)}var ms=(()=>{function h(x){let S;for(;x[U].length;){let R=x[U][0][l];if(R===void 0)break;x[U].shift(),S=x.push(R)}return S}let d=Symbol("Inbound Request Type"),l=Symbol("Inbound Request Response"),H=Symbol("Inbound Request Context");class g{constructor(S,R){this[d]=S,this[l]=void 0,this[H]=R}hasResponded(){return this[l]!==void 0}getType(){return this[d]}getContext(){return this[H]}}function I(x,S,R){return S[l]=R,h(x)}function b(x){if(x[T]=null,x[J]===0){let S=x[U];if(S&&S.length){x[U]=[];for(let R of S)R.cb(new Error("No reply from server"))}}try{x.end()}catch{}setImmediate(()=>{x[$]||x.emit("end"),x[ee]||x.emit("close")})}function L(){this[ee]=!0}function B(){this[$]=!0}let U=Symbol("Requests"),J=Symbol("Agent Protocol Role"),T=Symbol("Agent Protocol Buffer"),Z=Symbol("Agent Protocol Current Message Length"),ee=Symbol("Agent Protocol Closed"),$=Symbol("Agent Protocol Ended");return class extends bf{constructor(S){super({autoDestroy:!0,emitClose:!1}),this[J]=S?0:1,this[U]=[],this[T]=null,this[Z]=-1,this.once("end",B),this.once("close",L)}_read(S){}_write(S,R,M){this[T]===null?this[T]=S:this[T]=th(this[T],S);let O=this[T],re=O.length,z=0;for(;z<re&&!(re<5||(this[Z]===-1&&(this[Z]=Bs(O,z)),re<4+this[Z]));){let Y=O[z+=4];if(++z,this[J]===0){if(this[U].length===0)return M(new Error("Received unexpected message from server"));let te=this[U].shift();switch(Y){case 5:te.cb(new Error("Agent responded with failure"));break;case 12:{if(te.type!==11)return M(new Error("Agent responded with wrong message type"));at.init(O,z);let ie=at.readUInt32BE();if(ie===void 0)return at.clear(),M(new Error("Malformed agent response"));let k=[];for(let Q=0;Q<ie;++Q){let F=at.readString();if(F===void 0)return at.clear(),M(new Error("Malformed agent response"));let V=at.readString(!0);if(V===void 0)return at.clear(),M(new Error("Malformed agent response"));F=yr(F),!(F instanceof Error)&&(F.comment=F.comment||V,k.push(F))}z=at.pos(),at.clear(),te.cb(null,k);break}case 14:{if(te.type!==13)return M(new Error("Agent responded with wrong message type"));at.init(O,z);let ie=at.readString();if(z=at.pos(),at.clear(),ie===void 0)return M(new Error("Malformed agent response"));if(at.init(ie,0),at.readString(!0),ie=at.readString(),at.clear(),ie===void 0)return M(new Error("Malformed OpenSSH signature format"));te.cb(null,ie);break}default:return M(new Error("Agent responded with unsupported message type"))}}else switch(Y){case 11:{let te=new g(Y);this[U].push(te),this.emit("identities",te);break}case 13:{at.init(O,z);let te=at.readString(),ie=at.readString(),k=at.readUInt32BE();if(z=at.pos(),at.clear(),k===void 0){let le=new g(Y);return this[U].push(le),this.failureReply(le)}if(te=yr(te),te instanceof Error){let le=new g(Y);return this[U].push(le),this.failureReply(le)}let Q={hash:void 0},F;te.type==="ssh-rsa"&&(k&2?(F="rsa-sha2-256",Q.hash="sha256"):k&4&&(F="rsa-sha2-512",Q.hash="sha512")),F===void 0&&(F=te.type);let V=new g(Y,F);this[U].push(V),this.emit("sign",V,te,ie,Q);break}default:{let te=new g(Y);this[U].push(te),this.failureReply(te)}}if(this[Z]=-1,z===re){this[T]=null;break}else this[T]=O=O.slice(z),re=O.length,z=0}M()}_destroy(S,R){b(this),R()}_final(S){b(this),S()}sign(S,R,M,O){if(this[J]!==0)throw new Error("Client-only method called with server role");typeof M=="function"?(O=M,M=void 0):(typeof M!="object"||M===null)&&(M=void 0);let re=0;if(S=yr(S),S instanceof Error)throw new Error("Invalid public key argument");if(S.type==="ssh-rsa"&&M)switch(M.hash){case"sha256":re=2;break;case"sha512":re=4;break}S=S.getPublicSSH();let z=13,Y=S.length,te=R.length,ie=0,k=Buffer.allocUnsafe(9+Y+4+te+4);return Rt(k,k.length-4,ie),k[ie+=4]=z,Rt(k,Y,++ie),S.copy(k,ie+=4),Rt(k,te,ie+=Y),R.copy(k,ie+=4),Rt(k,re,ie+=te),typeof O!="function"&&(O=Ls),this[U].push({type:z,cb:O}),this.push(k)}getIdentities(S){if(this[J]!==0)throw new Error("Client-only method called with server role");let R=11,M=0,O=Buffer.allocUnsafe(5);return Rt(O,O.length-4,M),O[M+=4]=R,typeof S!="function"&&(S=Ls),this[U].push({type:R,cb:S}),this.push(O)}failureReply(S){if(this[J]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof g))throw new Error("Wrong request argument");if(S.hasResponded())return!0;let R=0,M=Buffer.allocUnsafe(5);return Rt(M,M.length-4,R),M[R+=4]=5,I(this,S,M)}getIdentitiesReply(S,R){if(this[J]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof g))throw new Error("Wrong request argument");if(S.hasResponded())return!0;if(S.getType()!==11)throw new Error("Invalid response to request");if(!Array.isArray(R))throw new Error("Keys argument must be an array");let M=4,O=[];for(let Y=0;Y<R.length;++Y){let te=R[Y];if(typeof te!="object"||te===null)throw new Error(`Invalid key entry: ${te}`);let ie,k;if(gf(te))ie=te;else if(gf(te.pubKey))ie=te.pubKey;else if(typeof te.pubKey!="object"||te.pubKey===null||({pubKey:ie,comment:k}=te.pubKey,ie=yr(ie),ie instanceof Error))continue;k=ie.comment||k,ie=ie.getPublicSSH(),M+=4+ie.length,k&&typeof k=="string"?k=Buffer.from(k):Buffer.isBuffer(k)||(k=nh),M+=4+k.length,O.push({pubKey:ie,comment:k})}let re=0,z=Buffer.allocUnsafe(5+M);Rt(z,z.length-4,re),z[re+=4]=12,Rt(z,O.length,++re),re+=4;for(let Y=0;Y<O.length;++Y){let{pubKey:te,comment:ie}=O[Y];Rt(z,te.length,re),te.copy(z,re+=4),Rt(z,ie.length,re+=te.length),re+=4,ie.length&&(ie.copy(z,re),re+=ie.length)}return I(this,S,z)}signReply(S,R){if(this[J]!==1)throw new Error("Server-only method called with client role");if(!(S instanceof g))throw new Error("Wrong request argument");if(S.hasResponded())return!0;if(S.getType()!==13)throw new Error("Invalid response to request");if(!Buffer.isBuffer(R))throw new Error("Signature argument must be a Buffer");if(R.length===0)throw new Error("Signature argument must be non-empty");let M=0,O=S.getContext(),re=Buffer.byteLength(O),z=Buffer.allocUnsafe(13+re+4+R.length);return Rt(z,z.length-4,M),z[M+=4]=14,Rt(z,4+re+4+R.length,++M),Rt(z,re,M+=4),z.utf8Write(O,M+=4,re),Rt(z,R.length,M+=re),R.copy(z,M+=4),I(this,S,z)}}})(),ws=Symbol("Agent"),Vt=Symbol("Agent Keys"),sn=Symbol("Agent Keys Index"),Wn=Symbol("Agent Init Callbacks"),Ns=class{constructor(t){if(typeof t=="string")t=yf(t);else if(!Cf(t))throw new Error("Invalid agent argument");this[ws]=t,this[Vt]=null,this[sn]=-1,this[Wn]=null}init(t){if(typeof t!="function"&&(t=Ls),this[Vt]===null)if(this[Wn]===null){this[Wn]=[t];let e=(...r)=>{process.nextTick(()=>{let i=this[Wn];this[Wn]=null;for(let s of i)s(...r)})};this[ws].getIdentities(Cr((r,i)=>{if(r)return e(r);if(!Array.isArray(i))return e(new Error("Agent implementation failed to provide keys"));let s=[];for(let o of i)o=yr(o),!(o instanceof Error)&&s.push(o);this[Vt]=s,this[sn]=-1,e()}))}else this[Wn].push(t);else process.nextTick(t)}nextKey(){return this[Vt]===null||++this[sn]>=this[Vt].length?!1:this[Vt][this[sn]]}currentKey(){return this[Vt]===null||this[sn]>=this[Vt].length?null:this[Vt][this[sn]]}pos(){return this[Vt]===null||this[sn]>=this[Vt].length?-1:this[sn]}reset(){this[sn]=-1}sign(...t){this[ws].sign(...t)}};function Cf(n){return n instanceof wr}wf.exports={AgentContext:Ns,AgentProtocol:ms,BaseAgent:wr,createAgent:yf,CygwinAgent:Sf,isAgent:Cf,OpenSSHAgent:qn,PageantAgent:xf}});var Us=je((Td,Lf)=>{"use strict";var{kMaxLength:ih}=require("buffer"),{createInflate:sh,constants:{DEFLATE:oh,INFLATE:fh,Z_DEFAULT_CHUNK:ah,Z_DEFAULT_COMPRESSION:ch,Z_DEFAULT_MEMLEVEL:hh,Z_DEFAULT_STRATEGY:uh,Z_DEFAULT_WINDOWBITS:lh,Z_PARTIAL_FLUSH:dh}}=require("zlib"),Ah=sh()._handle.constructor;function _h(){throw new Error("Should not get here")}function Hh(n,t,e){let r=this._owner,i=new Error(n);i.errno=t,i.code=e,r._err=i}function Ps(n){n._handle&&(n._handle.close(),n._handle=null)}var ci=class{constructor(t){let e=lh,r=ch,i=hh,s=uh,o=void 0;this._err=void 0,this._writeState=new Uint32Array(2),this._chunkSize=ah,this._maxOutputLength=ih,this._outBuffer=Buffer.allocUnsafe(this._chunkSize),this._outOffset=0,this._handle=new Ah(t),this._handle._owner=this,this._handle.onerror=Hh,this._handle.init(e,r,i,s,this._writeState,_h,o)}writeSync(t,e){let r=this._handle;if(!r)throw new Error("Invalid Zlib instance");let i=t.length,s=this._chunkSize-this._outOffset,o=0,f,a,h,d=0,l=this._writeState,H=this._outBuffer,g=this._outOffset,I=this._chunkSize;for(;;){if(r.writeSync(dh,t,o,i,H,g,s),this._err)throw this._err;f=l[0],a=l[1];let L=i-a,B=s-f;if(B>0){let U=g===0&&B===H.length?H:H.slice(g,g+B);if(g+=B,h?h.push===void 0?h=[h,U]:h.push(U):h=U,d+=U.byteLength,d>this._maxOutputLength)throw Ps(this),new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}else if(B!==0)throw new Error("have should not go down");if((f===0||g>=I)&&(s=I,g=0,H=Buffer.allocUnsafe(I)),f===0)o+=L,i=a;else break}if(this._outBuffer=H,this._outOffset=g,d===0&&(h=Buffer.alloc(0)),e)return h.totalLen=d,h;if(h.push===void 0)return h;let b=Buffer.allocUnsafe(d);for(let L=0,B=0;L<h.length;++L){let U=h[L];b.set(U,B),B+=U.length}return b}},Rs=class{constructor(t){this.allocStart=0,this.allocStartKEX=0,this._protocol=t,this._zlib=new ci(oh)}cleanup(){this._zlib&&Ps(this._zlib)}alloc(t,e){return Buffer.allocUnsafe(t)}finalize(t,e){if(this._protocol._kexinit===void 0||e){let r=this._zlib.writeSync(t,!0),i=this._protocol._cipher.allocPacket(r.totalLen);if(r.push===void 0)i.set(r,5);else for(let s=0,o=5;s<r.length;++s){let f=r[s];i.set(f,o),o+=f.length}return i}return t}},vs=class{constructor(t){this.allocStart=5,this.allocStartKEX=5,this._protocol=t}cleanup(){}alloc(t,e){return this._protocol._kexinit===void 0||e?this._protocol._cipher.allocPacket(t):Buffer.allocUnsafe(t)}finalize(t,e){return t}},Ds=class{constructor(){this._zlib=new ci(fh)}cleanup(){this._zlib&&Ps(this._zlib)}read(t){return this._zlib.writeSync(t,!1)}},Ts=class{cleanup(){}read(t){return t}};Lf.exports={PacketReader:Ts,PacketWriter:vs,ZlibPacketReader:Ds,ZlibPacketWriter:Rs}});var Rf=je((Pd,kf)=>{"use strict";var{bufferSlice:Os,bufferParser:w,doFatalError:it,sigSSHToASN1:mf,writeUInt32BE:Nf}=Wt(),{CHANNEL_OPEN_FAILURE:Eh,COMPAT:gh,MESSAGE:ot,TERMINAL_MODE:Bf}=nn(),{parseKey:ph}=An(),Ih=Array.from(Object.entries(Bf)).reduce((n,[t,e])=>({...n,[t]:e}),{});kf.exports={[ot.DISCONNECT]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readString(!0),i=w.readString();if(w.clear(),i===void 0)return it(n,"Inbound: Malformed DISCONNECT packet");n._debug&&n._debug(`Inbound: Received DISCONNECT (${e}, "${r}")`);let s=n._handlers.DISCONNECT;s&&s(n,e,r)},[ot.IGNORE]:(n,t)=>{n._debug&&n._debug("Inbound: Received IGNORE")},[ot.UNIMPLEMENTED]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE();if(w.clear(),e===void 0)return it(n,"Inbound: Malformed UNIMPLEMENTED packet");n._debug&&n._debug(`Inbound: Received UNIMPLEMENTED (seqno ${e})`)},[ot.DEBUG]:(n,t)=>{w.init(t,1);let e=w.readBool(),r=w.readString(!0),i=w.readString();if(w.clear(),i===void 0)return it(n,"Inbound: Malformed DEBUG packet");n._debug&&n._debug("Inbound: Received DEBUG");let s=n._handlers.DEBUG;s&&s(n,e,r)},[ot.SERVICE_REQUEST]:(n,t)=>{w.init(t,1);let e=w.readString(!0);if(w.clear(),e===void 0)return it(n,"Inbound: Malformed SERVICE_REQUEST packet");n._debug&&n._debug(`Inbound: Received SERVICE_REQUEST (${e})`);let r=n._handlers.SERVICE_REQUEST;r&&r(n,e)},[ot.SERVICE_ACCEPT]:(n,t)=>{w.init(t,1);let e=w.readString(!0);if(w.clear(),e===void 0)return it(n,"Inbound: Malformed SERVICE_ACCEPT packet");n._debug&&n._debug(`Inbound: Received SERVICE_ACCEPT (${e})`);let r=n._handlers.SERVICE_ACCEPT;r&&r(n,e)},[ot.EXT_INFO]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r;if(e!==void 0){r=[];for(let s=0;s<e;++s){let o=w.readString(!0),f=w.readString();if(f!==void 0)switch(o){case"server-sig-algs":{let a=f.latin1Slice(0,f.length).split(",");r.push({name:o,algs:a});continue}default:continue}r=void 0;break}}if(w.clear(),r===void 0)return it(n,"Inbound: Malformed EXT_INFO packet");n._debug&&n._debug("Inbound: Received EXT_INFO");let i=n._handlers.EXT_INFO;i&&i(n,r)},[ot.USERAUTH_REQUEST]:(n,t)=>{w.init(t,1);let e=w.readString(!0),r=w.readString(!0),i=w.readString(!0),s,o;switch(i){case"none":s=null;break;case"password":{let a=w.readBool();if(a!==void 0&&(s=w.readString(!0),s!==void 0&&a)){let h=w.readString(!0);h!==void 0?s={oldPassword:s,newPassword:h}:s=void 0}break}case"publickey":{let a=w.readBool();if(a!==void 0){let h=w.readString(!0),d=h,l=w.readString(),H;switch(h){case"rsa-sha2-256":d="ssh-rsa",H="sha256";break;case"rsa-sha2-512":d="ssh-rsa",H="sha512";break}if(a){let g=w.pos(),I=w.readString();if(I!==void 0&&(I.length>4+h.length+4&&I.utf8Slice(4,4+h.length)===h&&(I=Os(I,4+h.length+4)),I=mf(I,d),I)){let b=n._kex.sessionID,L=Buffer.allocUnsafe(4+b.length+g);Nf(L,b.length,0),L.set(b,4),L.set(new Uint8Array(t.buffer,t.byteOffset,g),4+b.length),s={keyAlgo:d,key:l,signature:I,blob:L,hashAlgo:H}}}else s={keyAlgo:d,key:l,hashAlgo:H},o="publickey -- check"}break}case"hostbased":{let a=w.readString(!0),h=a,d=w.readString(),l=w.readString(!0),H=w.readString(!0),g;switch(a){case"rsa-sha2-256":h="ssh-rsa",g="sha256";break;case"rsa-sha2-512":h="ssh-rsa",g="sha512";break}let I=w.pos(),b=w.readString();if(b!==void 0&&(b.length>4+a.length+4&&b.utf8Slice(4,4+a.length)===a&&(b=Os(b,4+a.length+4)),b=mf(b,h),b!==void 0)){let L=n._kex.sessionID,B=Buffer.allocUnsafe(4+L.length+I);Nf(B,L.length,0),B.set(L,4),B.set(new Uint8Array(t.buffer,t.byteOffset,I),4+L.length),s={keyAlgo:h,key:d,signature:b,blob:B,localHostname:l,localUsername:H,hashAlgo:g}}break}case"keyboard-interactive":w.skipString(),s=w.readList();break;default:i!==void 0&&(s=w.readRaw())}if(w.clear(),s===void 0)return it(n,"Inbound: Malformed USERAUTH_REQUEST packet");o===void 0&&(o=i),n._authsQueue.push(i),n._debug&&n._debug(`Inbound: Received USERAUTH_REQUEST (${o})`);let f=n._handlers.USERAUTH_REQUEST;f&&f(n,e,r,i,s)},[ot.USERAUTH_FAILURE]:(n,t)=>{w.init(t,1);let e=w.readList(),r=w.readBool();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed USERAUTH_FAILURE packet");n._debug&&n._debug(`Inbound: Received USERAUTH_FAILURE (${e})`),n._authsQueue.shift();let i=n._handlers.USERAUTH_FAILURE;i&&i(n,e,r)},[ot.USERAUTH_SUCCESS]:(n,t)=>{n._debug&&n._debug("Inbound: Received USERAUTH_SUCCESS"),n._authsQueue.shift();let e=n._handlers.USERAUTH_SUCCESS;e&&e(n)},[ot.USERAUTH_BANNER]:(n,t)=>{w.init(t,1);let e=w.readString(!0),r=w.readString();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed USERAUTH_BANNER packet");n._debug&&n._debug("Inbound: Received USERAUTH_BANNER");let i=n._handlers.USERAUTH_BANNER;i&&i(n,e)},60:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 60 without auth");return}switch(n._authsQueue[0]){case"password":{w.init(t,1);let e=w.readString(!0),r=w.readString();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet");n._debug&&n._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");let i=n._handlers.USERAUTH_PASSWD_CHANGEREQ;i&&i(n,e);break}case"publickey":{w.init(t,1);let e=w.readString(!0),r=w.readString();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed USERAUTH_PK_OK packet");n._debug&&n._debug("Inbound: Received USERAUTH_PK_OK"),n._authsQueue.shift();let i=n._handlers.USERAUTH_PK_OK;i&&i(n,e,r);break}case"keyboard-interactive":{w.init(t,1);let e=w.readString(!0),r=w.readString(!0);w.readString();let i=w.readUInt32BE(),s;if(i!==void 0){s=new Array(i);let f;for(f=0;f<i;++f){let a=w.readString(!0),h=w.readBool();if(h===void 0)break;s[f]={prompt:a,echo:h}}f!==i&&(s=void 0)}if(w.clear(),s===void 0)return it(n,"Inbound: Malformed USERAUTH_INFO_REQUEST packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_REQUEST");let o=n._handlers.USERAUTH_INFO_REQUEST;o&&o(n,e,r,s);break}default:n._debug&&n._debug("Inbound: Received unexpected payload type 60")}},61:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 61 without auth");return}if(n._authsQueue[0]!=="keyboard-interactive")return it(n,"Inbound: Received unexpected payload type 61");w.init(t,1);let e=w.readUInt32BE(),r;if(e!==void 0){r=new Array(e);let s;for(s=0;s<e;++s){let o=w.readString(!0);if(o===void 0)break;r[s]=o}s!==e&&(r=void 0)}if(w.clear(),r===void 0)return it(n,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_RESPONSE");let i=n._handlers.USERAUTH_INFO_RESPONSE;i&&i(n,r)},[ot.GLOBAL_REQUEST]:(n,t)=>{w.init(t,1);let e=w.readString(!0),r=w.readBool(),i;if(r!==void 0)switch(e){case"tcpip-forward":case"cancel-tcpip-forward":{let o=w.readString(!0),f=w.readUInt32BE();f!==void 0&&(i={bindAddr:o,bindPort:f});break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{let o=w.readString(!0);o!==void 0&&(i={socketPath:o});break}case"no-more-sessions@openssh.com":i=null;break;case"hostkeys-00@openssh.com":{for(i=[];w.avail()>0;){let o=w.readString();if(o===void 0){i=void 0;break}let f=ph(o);f instanceof Error||i.push(f)}break}default:i=w.readRaw()}if(w.clear(),i===void 0)return it(n,"Inbound: Malformed GLOBAL_REQUEST packet");n._debug&&n._debug(`Inbound: GLOBAL_REQUEST (${e})`);let s=n._handlers.GLOBAL_REQUEST;s?s(n,e,r,i):n.requestFailure()},[ot.REQUEST_SUCCESS]:(n,t)=>{let e=t.length>1?Os(t,1):null;n._debug&&n._debug("Inbound: REQUEST_SUCCESS");let r=n._handlers.REQUEST_SUCCESS;r&&r(n,e)},[ot.REQUEST_FAILURE]:(n,t)=>{n._debug&&n._debug("Inbound: Received REQUEST_FAILURE");let e=n._handlers.REQUEST_FAILURE;e&&e(n)},[ot.CHANNEL_OPEN]:(n,t)=>{w.init(t,1);let e=w.readString(!0),r=w.readUInt32BE(),i=w.readUInt32BE(),s=w.readUInt32BE(),o;switch(e){case"forwarded-tcpip":case"direct-tcpip":{let a=w.readString(!0),h=w.readUInt32BE(),d=w.readString(!0),l=w.readUInt32BE();l!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{destIP:a,destPort:h,srcIP:d,srcPort:l}});break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{let a=w.readString(!0);a!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{socketPath:a}});break}case"x11":{let a=w.readString(!0),h=w.readUInt32BE();h!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{srcIP:a,srcPort:h}});break}default:o={type:e,sender:r,window:i,packetSize:s,data:{}}}if(w.clear(),o===void 0)return it(n,"Inbound: Malformed CHANNEL_OPEN packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN (s:${r}, ${e})`);let f=n._handlers.CHANNEL_OPEN;f?f(n,o):n.channelOpenFail(o.sender,Eh.ADMINISTRATIVELY_PROHIBITED,"","")},[ot.CHANNEL_OPEN_CONFIRMATION]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readUInt32BE(),i=w.readUInt32BE(),s=w.readUInt32BE(),o=w.avail()?w.readRaw():void 0;if(w.clear(),s===void 0)return it(n,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${e}, s:${r})`);let f=n._handlers.CHANNEL_OPEN_CONFIRMATION;f&&f(n,{recipient:e,sender:r,window:i,packetSize:s,data:o})},[ot.CHANNEL_OPEN_FAILURE]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readUInt32BE(),i=w.readString(!0),s=w.readString();if(w.clear(),s===void 0)return it(n,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${e})`);let o=n._handlers.CHANNEL_OPEN_FAILURE;o&&o(n,e,r,i)},[ot.CHANNEL_WINDOW_ADJUST]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readUInt32BE();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet");n._debug&&n._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${e}, ${r})`);let i=n._handlers.CHANNEL_WINDOW_ADJUST;i&&i(n,e,r)},[ot.CHANNEL_DATA]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readString();if(w.clear(),r===void 0)return it(n,"Inbound: Malformed CHANNEL_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_DATA (r:${e}, ${r.length})`);let i=n._handlers.CHANNEL_DATA;i&&i(n,e,r)},[ot.CHANNEL_EXTENDED_DATA]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readUInt32BE(),i=w.readString();if(w.clear(),i===void 0)return it(n,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${e}, ${i.length})`);let s=n._handlers.CHANNEL_EXTENDED_DATA;s&&s(n,e,i,r)},[ot.CHANNEL_EOF]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE();if(w.clear(),e===void 0)return it(n,"Inbound: Malformed CHANNEL_EOF packet");n._debug&&n._debug(`Inbound: CHANNEL_EOF (r:${e})`);let r=n._handlers.CHANNEL_EOF;r&&r(n,e)},[ot.CHANNEL_CLOSE]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE();if(w.clear(),e===void 0)return it(n,"Inbound: Malformed CHANNEL_CLOSE packet");n._debug&&n._debug(`Inbound: CHANNEL_CLOSE (r:${e})`);let r=n._handlers.CHANNEL_CLOSE;r&&r(n,e)},[ot.CHANNEL_REQUEST]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE(),r=w.readString(!0),i=w.readBool(),s;if(i!==void 0)switch(r){case"exit-status":s=w.readUInt32BE(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"exit-signal":{let f,a;if(n._compatFlags&gh.OLD_EXIT){let d=w.readUInt32BE();switch(d){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:d!==void 0&&(f=`UNKNOWN (${d})`)}a=!1}else f=w.readString(!0),a=w.readBool(),a===void 0&&(f=void 0);let h=w.readString(!0);w.skipString()!==void 0&&(s={signal:f,coreDumped:a,errorMessage:h}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f})`);break}case"pty-req":{let f=w.readString(!0),a=w.readUInt32BE(),h=w.readUInt32BE(),d=w.readUInt32BE(),l=w.readUInt32BE(),H=w.readString();if(H!==void 0){w.init(H,1);let g={};for(;w.avail();){let I=w.readByte();if(I===Bf.TTY_OP_END)break;let b=Ih[I],L=w.readUInt32BE();if(I===void 0||b===void 0||L===void 0){g=void 0;break}g[b]=L}g!==void 0&&(s={term:f,cols:a,rows:h,width:d,height:l,modes:g})}n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"window-change":{let f=w.readUInt32BE(),a=w.readUInt32BE(),h=w.readUInt32BE(),d=w.readUInt32BE();d!==void 0&&(s={cols:f,rows:a,width:h,height:d}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"x11-req":{let f=w.readBool(),a=w.readString(!0),h=w.readString(),d=w.readUInt32BE();d!==void 0&&(s={single:f,protocol:a,cookie:h,screen:d}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"env":{let f=w.readString(!0),a=w.readString(!0);a!==void 0&&(s={name:f,value:a}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f}=${a})`);break}case"shell":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;case"exec":s=w.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"subsystem":s=w.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"signal":s=w.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"xon-xoff":s=w.readBool(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"auth-agent-req@openssh.com":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;default:s=w.avail()?w.readRaw():null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`)}if(w.clear(),s===void 0)return it(n,"Inbound: Malformed CHANNEL_REQUEST packet");let o=n._handlers.CHANNEL_REQUEST;o&&o(n,e,r,i,s)},[ot.CHANNEL_SUCCESS]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE();if(w.clear(),e===void 0)return it(n,"Inbound: Malformed CHANNEL_SUCCESS packet");n._debug&&n._debug(`Inbound: CHANNEL_SUCCESS (r:${e})`);let r=n._handlers.CHANNEL_SUCCESS;r&&r(n,e)},[ot.CHANNEL_FAILURE]:(n,t)=>{w.init(t,1);let e=w.readUInt32BE();if(w.clear(),e===void 0)return it(n,"Inbound: Malformed CHANNEL_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_FAILURE (r:${e})`);let r=n._handlers.CHANNEL_FAILURE;r&&r(n,e)}}});var hi=je((Ud,vf)=>{"use strict";var Fs=new Array(256);[ui().HANDLERS,Rf()].forEach(n=>{for(let[t,e]of Object.entries(n))t=+t,isFinite(t)&&t>=0&&t<Fs.length&&(Fs[t]=e)});vf.exports=Fs});var ui=je((Fd,Kf)=>{"use strict";var{createDiffieHellman:bh,createDiffieHellmanGroup:xh,createECDH:Sh,createHash:Ms,createPublicKey:yh,diffieHellman:Ch,generateKeyPairSync:wh,randomFillSync:Lh}=require("crypto"),{Ber:Df}=cr(),{COMPAT:Gs,curve25519Supported:mh,DEFAULT_KEX:Tf,DEFAULT_SERVER_HOST_KEY:Pf,DEFAULT_CIPHER:li,DEFAULT_MAC:di,DEFAULT_COMPRESSION:Ai,DISCONNECT_REASON:Me,MESSAGE:nt}=nn(),{CIPHER_INFO:$n,createCipher:Nh,createDecipher:Bh,MAC_INFO:Uf}=un(),{parseDERKey:kh}=An(),{bufferFill:Rh,bufferParser:Qe,convertSignature:vh,doFatalError:Ge,FastBuffer:Dh,sigSSHToASN1:Th,writeUInt32BE:bt}=Wt(),{PacketReader:Of,PacketWriter:Ff,ZlibPacketReader:_i,ZlibPacketWriter:Hi}=Us(),Xn,Ph=2048,Uh=8192,Oh=Buffer.alloc(0);function Qf(n){let t;if(n._compatFlags&Gs.BAD_DHGEX){let e=n._offer.lists.kex,r=e.array,i=!1;for(let s=0;s<r.length;++s)r[s].includes("group-exchange")&&(i||(i=!0,r=r.slice()),r.splice(s--,1));if(i){let s=17+n._offer.totalSize+1+4,o=Buffer.from(r.join(","));s-=e.buffer.length-o.length;let f=n._offer.lists.all,a=new Uint8Array(f.buffer,f.byteOffset+4+e.buffer.length,f.length-(4+e.buffer.length));t=Buffer.allocUnsafe(s),bt(t,o.length,17),t.set(o,21),t.set(a,21+o.length)}}t===void 0&&(t=Buffer.allocUnsafe(17+n._offer.totalSize+1+4),n._offer.copyAllTo(t,17)),n._debug&&n._debug("Outbound: Sending KEXINIT"),t[0]=nt.KEXINIT,Lh(t,1,16),Rh(t,0,t.length-5),n._kexinit=t,n._packetRW.write.allocStart=0;{let e=n._packetRW.write.allocStartKEX,r=n._packetRW.write.alloc(t.length,!0);r.set(t,e),n._cipher.encrypt(n._packetRW.write.finalize(r,!0))}}function Mf(n,t){let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0}};if(Qe.init(t,17),(e.kex=Qe.readList())===void 0||(e.serverHostKey=Qe.readList())===void 0||(e.cs.cipher=Qe.readList())===void 0||(e.sc.cipher=Qe.readList())===void 0||(e.cs.mac=Qe.readList())===void 0||(e.sc.mac=Qe.readList())===void 0||(e.cs.compress=Qe.readList())===void 0||(e.sc.compress=Qe.readList())===void 0||(e.cs.lang=Qe.readList())===void 0||(e.sc.lang=Qe.readList())===void 0)return Qe.clear(),Ge(n,"Received malformed KEXINIT","handshake",Me.KEY_EXCHANGE_FAILED);let r=Qe.pos(),i=r<t.length&&t[r]===1;Qe.clear();let s=n._offer,o=e,f=s.lists.kex.array;if(n._compatFlags&Gs.BAD_DHGEX){let T=!1;for(let Z=0;Z<f.length;++Z)f[Z].indexOf("group-exchange")!==-1&&(T||(T=!0,f=f.slice()),f.splice(Z--,1))}let a,h,d,l=n._debug;l&&l("Inbound: Handshake in progress"),l&&l(`Handshake: (local) KEX method: ${f}`),l&&l(`Handshake: (remote) KEX method: ${o.kex}`);let H;if(n._server?(h=f,a=o.kex,H=a.indexOf("ext-info-c")!==-1):(h=o.kex,a=f,H=h.indexOf("ext-info-s")!==-1),n._strictMode===void 0&&(n._server?n._strictMode=a.indexOf("kex-strict-c-v00@openssh.com")!==-1:n._strictMode=h.indexOf("kex-strict-s-v00@openssh.com")!==-1,n._strictMode&&(l&&l("Handshake: strict KEX mode enabled"),n._decipher.inSeqno!==1)))return l&&l("Handshake: KEXINIT not first packet in strict KEX mode"),Ge(n,"Handshake failed: KEXINIT not first packet in strict KEX mode","handshake",Me.KEY_EXCHANGE_FAILED);for(d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: no matching key exchange algorithm"),Ge(n,"Handshake failed: no matching key exchange algorithm","handshake",Me.KEY_EXCHANGE_FAILED);e.kex=a[d],l&&l(`Handshake: KEX algorithm: ${a[d]}`),i&&(!o.kex.length||a[d]!==o.kex[0])&&(n._skipNextInboundPacket=!0);let g=s.lists.serverHostKey.array;for(l&&l(`Handshake: (local) Host key format: ${g}`),l&&l(`Handshake: (remote) Host key format: ${o.serverHostKey}`),n._server?(h=g,a=o.serverHostKey):(h=o.serverHostKey,a=g),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching host key format"),Ge(n,"Handshake failed: no matching host key format","handshake",Me.KEY_EXCHANGE_FAILED);e.serverHostKey=a[d],l&&l(`Handshake: Host key format: ${a[d]}`);let I=s.lists.cs.cipher.array;for(l&&l(`Handshake: (local) C->S cipher: ${I}`),l&&l(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`),n._server?(h=I,a=o.cs.cipher):(h=o.cs.cipher,a=I),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching C->S cipher"),Ge(n,"Handshake failed: no matching C->S cipher","handshake",Me.KEY_EXCHANGE_FAILED);e.cs.cipher=a[d],l&&l(`Handshake: C->S Cipher: ${a[d]}`);let b=s.lists.sc.cipher.array;for(l&&l(`Handshake: (local) S->C cipher: ${b}`),l&&l(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`),n._server?(h=b,a=o.sc.cipher):(h=o.sc.cipher,a=b),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching S->C cipher"),Ge(n,"Handshake failed: no matching S->C cipher","handshake",Me.KEY_EXCHANGE_FAILED);e.sc.cipher=a[d],l&&l(`Handshake: S->C cipher: ${a[d]}`);let L=s.lists.cs.mac.array;if(l&&l(`Handshake: (local) C->S MAC: ${L}`),l&&l(`Handshake: (remote) C->S MAC: ${o.cs.mac}`),$n[e.cs.cipher].authLen>0)e.cs.mac="",l&&l("Handshake: C->S MAC: <implicit>");else{for(n._server?(h=L,a=o.cs.mac):(h=o.cs.mac,a=L),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching C->S MAC"),Ge(n,"Handshake failed: no matching C->S MAC","handshake",Me.KEY_EXCHANGE_FAILED);e.cs.mac=a[d],l&&l(`Handshake: C->S MAC: ${a[d]}`)}let B=s.lists.sc.mac.array;if(l&&l(`Handshake: (local) S->C MAC: ${B}`),l&&l(`Handshake: (remote) S->C MAC: ${o.sc.mac}`),$n[e.sc.cipher].authLen>0)e.sc.mac="",l&&l("Handshake: S->C MAC: <implicit>");else{for(n._server?(h=B,a=o.sc.mac):(h=o.sc.mac,a=B),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching S->C MAC"),Ge(n,"Handshake failed: no matching S->C MAC","handshake",Me.KEY_EXCHANGE_FAILED);e.sc.mac=a[d],l&&l(`Handshake: S->C MAC: ${a[d]}`)}let U=s.lists.cs.compress.array;for(l&&l(`Handshake: (local) C->S compression: ${U}`),l&&l(`Handshake: (remote) C->S compression: ${o.cs.compress}`),n._server?(h=U,a=o.cs.compress):(h=o.cs.compress,a=U),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching C->S compression"),Ge(n,"Handshake failed: no matching C->S compression","handshake",Me.KEY_EXCHANGE_FAILED);e.cs.compress=a[d],l&&l(`Handshake: C->S compression: ${a[d]}`);let J=s.lists.sc.compress.array;for(l&&l(`Handshake: (local) S->C compression: ${J}`),l&&l(`Handshake: (remote) S->C compression: ${o.sc.compress}`),n._server?(h=J,a=o.sc.compress):(h=o.sc.compress,a=J),d=0;d<a.length&&h.indexOf(a[d])===-1;++d);if(d===a.length)return l&&l("Handshake: No matching S->C compression"),Ge(n,"Handshake failed: no matching S->C compression","handshake",Me.KEY_EXCHANGE_FAILED);e.sc.compress=a[d],l&&l(`Handshake: S->C compression: ${a[d]}`),e.cs.lang="",e.sc.lang="",n._kex&&(n._kexinit||Qf(n),n._decipher._onPayload=Gf.bind(n,{firstPacket:!1})),n._kex=Fh(e,n,t),n._kex.remoteExtInfoEnabled=H,n._kex.start()}var Fh=(()=>{function n(o){let f=0,a=o.length;for(;o[f]===0;)++f,--a;let h;return o[f]&128?(h=Buffer.allocUnsafe(1+a),h[0]=0,o.copy(h,1,f),o=h):a!==o.length&&(h=Buffer.allocUnsafe(a),o.copy(h,0,f),o=h),o}class t{constructor(f,a,h){this._protocol=a,this.sessionID=a._kex?a._kex.sessionID:void 0,this.negotiated=f,this.remoteExtInfoEnabled=!1,this._step=1,this._public=null,this._dh=null,this._sentNEWKEYS=!1,this._receivedNEWKEYS=!1,this._finished=!1,this._hostVerified=!1,this._kexinit=a._kexinit,this._remoteKexinit=h,this._identRaw=a._identRaw,this._remoteIdentRaw=a._remoteIdentRaw,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0}finish(f){if(this._finished)return!1;this._finished=!0;let a=this._protocol._server,h=this.negotiated,d=this.convertPublicKey(this._dhData),l=this.computeSecret(this._dhData);if(l instanceof Error)return l.message=`Error while computing DH secret (${this.type}): ${l.message}`,l.level="handshake",Ge(this._protocol,l,Me.KEY_EXCHANGE_FAILED);let H=Ms(this.hashName);Zt(H,a?this._remoteIdentRaw:this._identRaw),Zt(H,a?this._identRaw:this._remoteIdentRaw),Zt(H,a?this._remoteKexinit:this._kexinit),Zt(H,a?this._kexinit:this._remoteKexinit);let g=a?this._hostKey.getPublicSSH():this._hostKey;if(Zt(H,g),this.type==="groupex"){let J=this.getDHParams(),T=Buffer.allocUnsafe(4);bt(T,this._minBits,0),H.update(T),bt(T,this._prefBits,0),H.update(T),bt(T,this._maxBits,0),H.update(T),Zt(H,J.prime),Zt(H,J.generator)}Zt(H,a?d:this.getPublicKey());let I=a?this.getPublicKey():d;Zt(H,I),Zt(H,l);let b=H.digest();if(a){let J;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":J="sha256";break;case"rsa-sha2-512":J="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let T=this._hostKey.sign(b,J);if(T instanceof Error)return Ge(this._protocol,`Handshake failed: signature generation failed for ${this._hostKey.type} host key: ${T.message}`,"handshake",Me.KEY_EXCHANGE_FAILED);if(T=vh(T,this._hostKey.type),T===!1)return Ge(this._protocol,`Handshake failed: signature conversion failed for ${this._hostKey.type} host key`,"handshake",Me.KEY_EXCHANGE_FAILED);let Z=this.negotiated.serverHostKey,ee=Buffer.byteLength(Z),$=4+ee+4+T.length,x=this._protocol._packetRW.write.allocStartKEX,S=this._protocol._packetRW.write.alloc(5+g.length+4+I.length+4+$,!0);if(S[x]=nt.KEXDH_REPLY,bt(S,g.length,++x),S.set(g,x+=4),bt(S,I.length,x+=g.length),S.set(I,x+=4),bt(S,$,x+=I.length),bt(S,ee,x+=4),S.utf8Write(Z,x+=4,ee),bt(S,T.length,x+=ee),S.set(T,x+=4),this._protocol._debug){let R;switch(this.type){case"group":R="KEXDH_REPLY";break;case"groupex":R="KEXDH_GEX_REPLY";break;default:R="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${R}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(S,!0))}else{Qe.init(this._sig,0);let J=Qe.readString(!0);if(!J)return Ge(this._protocol,"Malformed packet while reading signature","handshake",Me.KEY_EXCHANGE_FAILED);if(J!==h.serverHostKey)return Ge(this._protocol,`Wrong signature type: ${J}, expected: ${h.serverHostKey}`,"handshake",Me.KEY_EXCHANGE_FAILED);let T=Qe.readString();if(Qe.clear(),T===void 0)return Ge(this._protocol,"Malformed packet while reading signature","handshake",Me.KEY_EXCHANGE_FAILED);if(!(T=Th(T,J)))return Ge(this._protocol,"Malformed signature","handshake",Me.KEY_EXCHANGE_FAILED);let Z;{Qe.init(this._hostKey,0);let x=Qe.readString(!0),S=this._hostKey.slice(Qe.pos());if(Qe.clear(),Z=kh(S,x),Z instanceof Error)return Z.level="handshake",Ge(this._protocol,Z,Me.KEY_EXCHANGE_FAILED)}let ee;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":ee="sha256";break;case"rsa-sha2-512":ee="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");let $=Z.verify(b,T,ee);if($!==!0)return $ instanceof Error?this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${$.stack}`):this._protocol._debug&&this._protocol._debug("Signature verification failed"),Ge(this._protocol,"Handshake failed: signature verification failed","handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Verified signature")}(a||!f)&&Ei(this);let L,B,U=J=>{if(L)return Ei(this),L.outbound.seqno=this._protocol._cipher.outSeqno,this._protocol._cipher.free(),this._protocol._cipher=Nh(L),this._protocol._packetRW.write=B,L=void 0,B=void 0,this._protocol._onHandshakeComplete(h),!1;this.sessionID||(this.sessionID=b);{let te=Buffer.allocUnsafe(4+l.length);bt(te,l.length,0),te.set(l,4),l=te}let T=$n[h.cs.cipher],Z=$n[h.sc.cipher],ee=Vn(T.ivLen,this.hashName,l,b,this.sessionID,"A"),$=Vn(Z.ivLen,this.hashName,l,b,this.sessionID,"B"),x=Vn(T.keyLen,this.hashName,l,b,this.sessionID,"C"),S=Vn(Z.keyLen,this.hashName,l,b,this.sessionID,"D"),R,M;T.authLen||(R=Uf[h.cs.mac],M=Vn(R.len,this.hashName,l,b,this.sessionID,"E"));let O,re;Z.authLen||(O=Uf[h.sc.mac],re=Vn(O.len,this.hashName,l,b,this.sessionID,"F"));let z={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:a?T:Z,decipherIV:a?ee:$,decipherKey:a?x:S,macInfo:a?R:O,macKey:a?M:re},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:a?Z:T,cipherIV:a?$:ee,cipherKey:a?S:x,macInfo:a?O:R,macKey:a?re:M}};this._protocol._decipher.free(),L=z,this._protocol._decipher=Bh(z);let Y={read:void 0,write:void 0};switch(h.cs.compress){case"zlib":a?Y.read=new _i:Y.write=new Hi(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){a?Y.read=new _i:Y.write=new Hi(this._protocol);break}default:a?Y.read=new Of:Y.write=new Ff(this._protocol)}switch(h.sc.compress){case"zlib":a?Y.write=new Hi(this._protocol):Y.read=new _i;break;case"zlib@openssh.com":if(this._protocol._authenticated){a?Y.write=new Hi(this._protocol):Y.read=new _i;break}default:a?Y.write=new Ff(this._protocol):Y.read=new Of}return this._protocol._packetRW.read.cleanup(),this._protocol._packetRW.write.cleanup(),this._protocol._packetRW.read=Y.read,B=Y.write,this._public=null,this._dh=null,this._kexinit=this._protocol._kexinit=void 0,this._remoteKexinit=void 0,this._identRaw=void 0,this._remoteIdentRaw=void 0,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0,J?!1:U()};if((a||f)&&(this.finish=U),!a)return U(f)}start(){if(!this._protocol._server){if(this._protocol._debug){let d;switch(this.type){case"group":d="KEXDH_INIT";break;default:d="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${d}`)}let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,h=this._protocol._packetRW.write.alloc(5+f.length,!0);h[a]=nt.KEXDH_INIT,bt(h,f.length,++a),h.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(h,!0))}}getPublicKey(){this.generateKeys();let f=this._public;if(f)return this.convertPublicKey(f)}convertPublicKey(f){let a,h=0,d=f.length;for(;f[h]===0;)++h,--d;return f[h]&128?(a=Buffer.allocUnsafe(1+d),a[0]=0,f.copy(a,1,h),a):(d!==f.length&&(a=Buffer.allocUnsafe(d),f.copy(a,0,h),f=a),f)}computeSecret(f){this.generateKeys();try{return n(this._dh.computeSecret(f))}catch(a){return a}}parse(f){let a=f[0];switch(this._step){case 1:if(this._protocol._server){if(a!==nt.KEXDH_INIT)return Ge(this._protocol,`Received packet ${a} instead of ${nt.KEXDH_INIT}`,"handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Init"),Qe.init(f,1);let h=Qe.readString();if(Qe.clear(),h===void 0)return Ge(this._protocol,"Received malformed KEX*_INIT","handshake",Me.KEY_EXCHANGE_FAILED);this._dhData=h;let d=this._protocol._hostKeys[this.negotiated.serverHostKey];Array.isArray(d)&&(d=d[0]),this._hostKey=d,this.finish()}else{if(a!==nt.KEXDH_REPLY)return Ge(this._protocol,`Received packet ${a} instead of ${nt.KEXDH_REPLY}`,"handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Reply"),Qe.init(f,1);let h,d,l;if((h=Qe.readString())===void 0||(d=Qe.readString())===void 0||(l=Qe.readString())===void 0)return Qe.clear(),Ge(this._protocol,"Received malformed KEX*_REPLY","handshake",Me.KEY_EXCHANGE_FAILED);Qe.clear(),Qe.init(h,0);let H=Qe.readString(!0);if(Qe.clear(),H===void 0)return Ge(this._protocol,"Received malformed host public key","handshake",Me.KEY_EXCHANGE_FAILED);if(H!==this.negotiated.serverHostKey)switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(H==="ssh-rsa")break;default:return Ge(this._protocol,"Host key does not match negotiated type","handshake",Me.KEY_EXCHANGE_FAILED)}this._hostKey=h,this._dhData=d,this._sig=l;let g=!1,I;if(this._protocol._hostVerifier===void 0?(I=!0,this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")):I=this._protocol._hostVerifier(h,b=>{if(!g){if(g=!0,b===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Ge(this._protocol,"Host denied (verification failed)","handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,this._receivedNEWKEYS?this.finish():Ei(this)}}),I===void 0){++this._step;return}if(g=!0,I===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Ge(this._protocol,"Host denied (verification failed)","handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,Ei(this)}++this._step;break;case 2:return a!==nt.NEWKEYS?Ge(this._protocol,`Received packet ${a} instead of ${nt.NEWKEYS}`,"handshake",Me.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS"),this._receivedNEWKEYS=!0,this._protocol._strictMode&&(this._protocol._decipher.inSeqno=0),++this._step,this.finish(!this._protocol._server&&!this._hostVerified));default:return Ge(this._protocol,`Received unexpected packet ${a} after NEWKEYS`,"handshake",Me.KEY_EXCHANGE_FAILED)}}}class e extends t{constructor(f,...a){super(...a),this.type="25519",this.hashName=f,this._keys=null}generateKeys(){this._keys||(this._keys=wh("x25519"))}getPublicKey(){return this.generateKeys(),this._keys.publicKey.export({type:"spki",format:"der"}).slice(-32)}convertPublicKey(f){let a,h=0,d=f.length;for(;f[h]===0;)++h,--d;return f.length===32||d!==f.length&&(a=Buffer.allocUnsafe(d),f.copy(a,0,h),f=a),f}computeSecret(f){this.generateKeys();try{let a=new Df.Writer;return a.startSequence(),a.startSequence(),a.writeOID("1.3.101.110"),a.endSequence(),a.startSequence(Df.BitString),a.writeByte(0),a._ensure(f.length),f.copy(a._buf,a._offset,0,f.length),a._offset+=f.length,a.endSequence(),a.endSequence(),n(Ch({privateKey:this._keys.privateKey,publicKey:yh({key:a.buffer,type:"spki",format:"der"})}))}catch(a){return a}}}class r extends t{constructor(f,a,...h){super(...h),this.type="ecdh",this.curveName=f,this.hashName=a}generateKeys(){this._dh||(this._dh=Sh(this.curveName),this._public=this._dh.generateKeys())}}class i extends t{constructor(f,...a){super(...a),this.type="groupex",this.hashName=f,this._prime=null,this._generator=null,this._minBits=Ph,this._prefBits=Qh(this.negotiated),this._protocol._compatFlags&Gs.BUG_DHGEX_LARGE&&(this._prefBits=Math.min(this._prefBits,4096)),this._maxBits=Uh}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let f=this._protocol._packetRW.write.allocStartKEX,a=this._protocol._packetRW.write.alloc(13,!0);a[f]=nt.KEXDH_GEX_REQUEST,bt(a,this._minBits,++f),bt(a,this._prefBits,f+=4),bt(a,this._maxBits,f+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(a,!0))}generateKeys(){!this._dh&&this._prime&&this._generator&&(this._dh=bh(this._prime,this._generator),this._public=this._dh.generateKeys())}setDHParams(f,a){if(!Buffer.isBuffer(f))throw new Error("Invalid prime value");if(!Buffer.isBuffer(a))throw new Error("Invalid generator value");this._prime=f,this._generator=a}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}parse(f){let a=f[0];switch(this._step){case 1:{if(this._protocol._server)return a!==nt.KEXDH_GEX_REQUEST?Ge(this._protocol,`Received packet ${a} instead of `+nt.KEXDH_GEX_REQUEST,"handshake",Me.KEY_EXCHANGE_FAILED):Ge(this._protocol,"Group exchange not implemented for server","handshake",Me.KEY_EXCHANGE_FAILED);if(a!==nt.KEXDH_GEX_GROUP)return Ge(this._protocol,`Received packet ${a} instead of ${nt.KEXDH_GEX_GROUP}`,"handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Group"),Qe.init(f,1);let h,d;if((h=Qe.readString())===void 0||(d=Qe.readString())===void 0)return Qe.clear(),Ge(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",Me.KEY_EXCHANGE_FAILED);Qe.clear(),this.setDHParams(h,d),this.generateKeys();let l=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let H=this._protocol._packetRW.write.allocStartKEX,g=this._protocol._packetRW.write.alloc(5+l.length,!0);g[H]=nt.KEXDH_GEX_INIT,bt(g,l.length,++H),g.set(l,H+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(g,!0)),++this._step;break}case 2:if(this._protocol._server)return a!==nt.KEXDH_GEX_INIT?Ge(this._protocol,`Received packet ${a} instead of ${nt.KEXDH_GEX_INIT}`,"handshake",Me.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Received DH GEX Init"),Ge(this._protocol,"Group exchange not implemented for server","handshake",Me.KEY_EXCHANGE_FAILED));if(a!==nt.KEXDH_GEX_REPLY)return Ge(this._protocol,`Received packet ${a} instead of ${nt.KEXDH_GEX_REPLY}`,"handshake",Me.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Reply"),this._step=1,f[0]=nt.KEXDH_REPLY,this.parse=t.prototype.parse,this.parse(f)}}}class s extends t{constructor(f,a,...h){super(...h),this.type="group",this.groupName=f,this.hashName=a}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,h=this._protocol._packetRW.write.alloc(5+f.length,!0);h[a]=nt.KEXDH_INIT,bt(h,f.length,++a),h.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(h,!0))}}generateKeys(){this._dh||(this._dh=xh(this.groupName),this._public=this._dh.generateKeys())}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}}return(o,...f)=>{if(typeof o!="object"||o===null)throw new Error("Invalid negotiated argument");let a=o.kex;if(typeof a=="string"){switch(f=[o,...f],a){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!mh)break;return new e("sha256",...f);case"ecdh-sha2-nistp256":return new r("prime256v1","sha256",...f);case"ecdh-sha2-nistp384":return new r("secp384r1","sha384",...f);case"ecdh-sha2-nistp521":return new r("secp521r1","sha512",...f);case"diffie-hellman-group1-sha1":return new s("modp2","sha1",...f);case"diffie-hellman-group14-sha1":return new s("modp14","sha1",...f);case"diffie-hellman-group14-sha256":return new s("modp14","sha256",...f);case"diffie-hellman-group15-sha512":return new s("modp15","sha512",...f);case"diffie-hellman-group16-sha512":return new s("modp16","sha512",...f);case"diffie-hellman-group17-sha512":return new s("modp17","sha512",...f);case"diffie-hellman-group18-sha512":return new s("modp18","sha512",...f);case"diffie-hellman-group-exchange-sha1":return new i("sha1",...f);case"diffie-hellman-group-exchange-sha256":return new i("sha256",...f)}throw new Error(`Unsupported key exchange algorithm: ${a}`)}throw new Error(`Invalid key exchange type: ${a}`)}})(),Qs=(()=>{let n=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class{constructor(e){if(typeof e!="object"||e===null)throw new TypeError("Argument must be an object");let r={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},all:void 0},i=0;for(let f of n){let a,h,d,l;if(typeof f=="string")a=r,h=e[f],d=l=f;else{let g=f[0];a=r[g],l=f[1],h=e[g][l],d=`${g}.${l}`}let H={array:void 0,buffer:void 0};if(Buffer.isBuffer(h))H.array=(""+h).split(","),H.buffer=h,i+=4+h.length;else{if(typeof h=="string"&&(h=h.split(",")),Array.isArray(h))H.array=h,H.buffer=Buffer.from(h.join(","));else throw new TypeError(`Invalid \`${d}\` type: ${typeof h}`);i+=4+H.buffer.length}a[l]=H}let s=Buffer.allocUnsafe(i);r.all=s;let o=0;for(let f of n){let a;typeof f=="string"?a=r[f].buffer:a=r[f[0]][f[1]].buffer,o=bt(s,a.length,o),s.set(a,o),o+=a.length}this.totalSize=i,this.lists=r}copyAllTo(e,r){let i=this.lists.all;if(typeof r!="number")throw new TypeError(`Invalid offset value: ${typeof r}`);if(e.length-r<i.length)throw new Error("Insufficient space to copy list");return e.set(i,r),i.length}}})(),Zt=(()=>{let n=Buffer.allocUnsafe(4);return(t,e)=>{bt(n,e.length,0),t.update(n),t.update(e)}})();function Vn(n,t,e,r,i,s){let o;if(n){let f=Ms(t).update(e).update(r).update(s).update(i).digest();for(;f.length<n;){let a=Ms(t).update(e).update(r).update(f).digest(),h=Buffer.allocUnsafe(f.length+a.length);h.set(f,0),h.set(a,f.length),f=h}f.length===n?o=f:o=new Dh(f.buffer,f.byteOffset,n)}else o=Oh;return o}function Gf(n,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=!1;return}t=this._packetRW.read.read(t);let e=t[0];if(!this._strictMode)switch(e){case nt.IGNORE:case nt.UNIMPLEMENTED:case nt.DEBUG:return Xn||(Xn=hi()),Xn[e](this,t)}switch(e){case nt.DISCONNECT:return Xn||(Xn=hi()),Xn[e](this,t);case nt.KEXINIT:return n.firstPacket?(n.firstPacket=!1,Mf(this,t)):Ge(this,"Received extra KEXINIT during handshake","handshake",Me.KEY_EXCHANGE_FAILED);default:if(e<20||e>49)return Ge(this,`Received unexpected packet type ${e}`,"handshake",Me.KEY_EXCHANGE_FAILED)}return this._kex.parse(t)}function Qh(n){let t=$n[n.cs.cipher],e=$n[n.sc.cipher],r=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,e.sslName==="des-ede3-cbc"?14:e.keyLen,e.blockLen,e.ivLen)*8;return r<=112?2048:r<=128?3072:r<=192?7680:8192}function Ei(n){if(!n._sentNEWKEYS){n._protocol._debug&&n._protocol._debug("Outbound: Sending NEWKEYS");let t=n._protocol._packetRW.write.allocStartKEX,e=n._protocol._packetRW.write.alloc(1,!0);e[t]=nt.NEWKEYS,n._protocol._cipher.encrypt(n._protocol._packetRW.write.finalize(e,!0)),n._sentNEWKEYS=!0,n._protocol._strictMode&&(n._protocol._cipher.outSeqno=0)}}Kf.exports={KexInit:Qs,kexinit:Qf,onKEXPayload:Gf,DEFAULT_KEXINIT_CLIENT:new Qs({kex:Tf.concat(["ext-info-c","kex-strict-c-v00@openssh.com"]),serverHostKey:Pf,cs:{cipher:li,mac:di,compress:Ai,lang:[]},sc:{cipher:li,mac:di,compress:Ai,lang:[]}}),DEFAULT_KEXINIT_SERVER:new Qs({kex:Tf.concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:Pf,cs:{cipher:li,mac:di,compress:Ai,lang:[]},sc:{cipher:li,mac:di,compress:Ai,lang:[]}}),HANDLERS:{[nt.KEXINIT]:Mf}}});var Wf=je((Qd,Mh)=>{Mh.exports={name:"ssh2",version:"1.15.0",author:"Brian White <mscdex@mscdex.net>",description:"SSH2 client and server modules written in pure JavaScript for node.js",main:"./lib/index.js",engines:{node:">=10.16.0"},dependencies:{asn1:"^0.2.6","bcrypt-pbkdf":"^1.0.2"},devDependencies:{"@mscdex/eslint-config":"^1.1.0",eslint:"^7.32.0"},optionalDependencies:{"cpu-features":"~0.0.9",nan:"^2.18.0"},scripts:{install:"node install.js",rebuild:"node install.js",test:"node test/test.js",lint:"eslint --cache --report-unused-disable-directives --ext=.js .eslintrc.js examples lib test","lint:fix":"npm run lint -- --fix"},keywords:["ssh","ssh2","sftp","secure","shell","exec","remote","client"],licenses:[{type:"MIT",url:"http://github.com/mscdex/ssh2/raw/master/LICENSE"}],repository:{type:"git",url:"http://github.com/mscdex/ssh2.git"}}});var Xs=je((Md,ra)=>{"use strict";var{inspect:Zf}=require("util"),{bindingAvailable:Gh,NullCipher:Kh,NullDecipher:Wh}=un(),{COMPAT_CHECKS:qh,DISCONNECT_REASON:jf,eddsaSupported:Xh,MESSAGE:pe,SIGNALS:qf,TERMINAL_MODE:Ws}=nn(),{DEFAULT_KEXINIT_CLIENT:Vh,DEFAULT_KEXINIT_SERVER:$h,KexInit:Xf,kexinit:zf,onKEXPayload:Yh}=ui(),{parseKey:Vf}=An(),Zh=hi(),{bufferCopy:gi,bufferFill:jh,bufferSlice:Jf,convertSignature:$f,sendPacket:Ie,writeUInt32BE:y}=Wt(),{PacketReader:zh,PacketWriter:Jh,ZlibPacketReader:ea,ZlibPacketWriter:ta}=Us(),eu=Wf().version,tu=new Map(Object.values(jf).map(n=>[n,1])),na=Buffer.from(`SSH-2.0-ssh2js${eu}`),nu=Buffer.from(`${na}\r
`),ru=8192,iu=1024,Yf=Buffer.from([pe.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),su=Buffer.from([Ws.TTY_OP_END]);function Ks(){}var qs=class{constructor(t){let e=t.onWrite;if(typeof e!="function")throw new Error("Missing onWrite function");this._onWrite=g=>{e(g)};let r=t.onError;if(typeof r!="function")throw new Error("Missing onError function");this._onError=g=>{r(g)};let i=t.debug;this._debug=typeof i=="function"?g=>{i(g)}:void 0;let s=t.onHeader;this._onHeader=typeof s=="function"?(...g)=>{s(...g)}:Ks;let o=t.onPacket;this._onPacket=typeof o=="function"?()=>{o()}:Ks;let f=t.onHandshakeComplete;typeof f!="function"&&(f=Ks);let a;this._onHandshakeComplete=(...g)=>{this._debug&&this._debug("Handshake completed"),a===void 0?a=!0:a=!1;let I=this._queue;if(I){this._queue=void 0,this._debug&&this._debug(`Draining outbound queue (${I.length}) ...`);for(let b=0;b<I.length;++b){let L=I[b],B=this._packetRW.write.finalize(L);if(B===L){let U=this._cipher.allocPacket(L.length);U.set(L,5),B=U}Ie(this,B)}this._debug&&this._debug("... finished draining outbound queue")}a&&this._server&&this._kex.remoteExtInfoEnabled&&lu(this),f(...g)},this._queue=void 0;let h=t.messageHandlers;typeof h=="object"&&h!==null?this._handlers=h:this._handlers={},this._onPayload=cu.bind(this),this._server=!!t.server,this._banner=void 0;let d;if(this._server){if(typeof t.hostKeys!="object"||t.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=t.hostKeys,typeof t.greeting=="string"&&t.greeting.length&&(d=t.greeting.slice(-2)===`\r
`?t.greeting:`${t.greeting}\r
`),typeof t.banner=="string"&&t.banner.length&&(this._banner=t.banner.slice(-2)===`\r
`?t.banner:`${t.banner}\r
`)}else this._hostKeys=void 0;let l=t.offer;typeof l!="object"||l===null?l=this._server?$h:Vh:l.constructor!==Xf&&(this._server?l.kex=l.kex.concat(["kex-strict-s-v00@openssh.com"]):l.kex=l.kex.concat(["ext-info-c","kex-strict-c-v00@openssh.com"]),l=new Xf(l)),this._kex=void 0,this._strictMode=void 0,this._kexinit=void 0,this._offer=l,this._cipher=new Kh(0,this._onWrite),this._decipher=void 0,this._skipNextInboundPacket=!1,this._packetRW={read:new zh,write:new Jh(this)},this._hostVerifier=!this._server&&typeof t.hostVerifier=="function"?t.hostVerifier:void 0,this._parse=fu,this._buffer=void 0,this._authsQueue=[],this._authenticated=!1,this._remoteIdentRaw=void 0;let H;if(typeof t.ident=="string")this._identRaw=Buffer.from(`SSH-2.0-${t.ident}`),H=Buffer.allocUnsafe(this._identRaw.length+2),H.set(this._identRaw,0),H[H.length-2]=13,H[H.length-1]=10;else if(Buffer.isBuffer(t.ident)){let g=Buffer.allocUnsafe(8+t.ident.length);g.latin1Write("SSH-2.0-",0,8),g.set(t.ident,8),this._identRaw=g,H=Buffer.allocUnsafe(g.length+2),H.set(g,0),H[H.length-2]=13,H[H.length-1]=10}else this._identRaw=na,H=nu;this._compatFlags=0,this._debug&&(Gh?this._debug("Custom crypto binding available"):this._debug("Custom crypto binding not available")),this._debug&&this._debug(`Local ident: ${Zf(this._identRaw.toString())}`),this.start=()=>{this.start=void 0,d&&this._onWrite(d),this._onWrite(H)}}_destruct(t){this._packetRW.read.cleanup(),this._packetRW.write.cleanup(),this._cipher&&this._cipher.free(),this._decipher&&this._decipher.free(),(typeof t!="string"||t.length===0)&&(t="fatal error"),this.parse=()=>{throw new Error(`Instance unusable after ${t}`)},this._onWrite=()=>{throw new Error(`Instance unusable after ${t}`)},this._destruct=void 0}cleanup(){this._destruct&&this._destruct()}parse(t,e,r){for(;e<r;)e=this._parse(t,e,r)}disconnect(t){let r=this._packetRW.write.allocStartKEX,i=this._packetRW.write.alloc(13,!0),s=r+13;tu.has(t)||(t=jf.PROTOCOL_ERROR),i[r]=pe.DISCONNECT,y(i,t,++r),i.fill(0,r+=4,s),this._debug&&this._debug(`Outbound: Sending DISCONNECT (${t})`),Ie(this,this._packetRW.write.finalize(i,!0),!0)}ping(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(Yf.length);e.set(Yf,t),this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)"),Ie(this,this._packetRW.write.finalize(e))}rekey(){this._kexinit===void 0?(this._debug&&this._debug("Outbound: Initiated explicit rekey"),this._queue=[],zf(this)):this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}requestSuccess(t){let e=this._packetRW.write.allocStart,r;Buffer.isBuffer(t)?(r=this._packetRW.write.alloc(1+t.length),r[e]=pe.REQUEST_SUCCESS,r.set(t,++e)):(r=this._packetRW.write.alloc(1),r[e]=pe.REQUEST_SUCCESS),this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS"),Ie(this,this._packetRW.write.finalize(r))}requestFailure(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=pe.REQUEST_FAILURE,this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE"),Ie(this,this._packetRW.write.finalize(e))}channelSuccess(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(5);r[e]=pe.CHANNEL_SUCCESS,y(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${t})`),Ie(this,this._packetRW.write.finalize(r))}channelFailure(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(5);r[e]=pe.CHANNEL_FAILURE,y(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${t})`),Ie(this,this._packetRW.write.finalize(r))}channelEOF(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(5);r[e]=pe.CHANNEL_EOF,y(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${t})`),Ie(this,this._packetRW.write.finalize(r))}channelClose(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(5);r[e]=pe.CHANNEL_CLOSE,y(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${t})`),Ie(this,this._packetRW.write.finalize(r))}channelWindowAdjust(t,e){let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(9);i[r]=pe.CHANNEL_WINDOW_ADJUST,y(i,t,++r),y(i,e,r+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${t}, ${e})`),Ie(this,this._packetRW.write.finalize(i))}channelData(t,e){let r=Buffer.isBuffer(e),i=r?e.length:Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(9+i);o[s]=pe.CHANNEL_DATA,y(o,t,++s),y(o,i,s+=4),r?o.set(e,s+=4):o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${t}, ${i})`),Ie(this,this._packetRW.write.finalize(o))}channelExtData(t,e,r){let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(13+s);f[o]=pe.CHANNEL_EXTENDED_DATA,y(f,t,++o),y(f,r,o+=4),y(f,s,o+=4),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${t})`),Ie(this,this._packetRW.write.finalize(f))}channelOpenConfirm(t,e,r,i){let s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(17);o[s]=pe.CHANNEL_OPEN_CONFIRMATION,y(o,t,++s),y(o,e,s+=4),y(o,r,s+=4),y(o,i,s+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${t}, l:${e})`),Ie(this,this._packetRW.write.finalize(o))}channelOpenFail(t,e,r){typeof r!="string"&&(r="");let i=Buffer.byteLength(r),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(13+i+4);o[s]=pe.CHANNEL_OPEN_FAILURE,y(o,t,++s),y(o,e,s+=4),y(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),y(o,0,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${t})`),Ie(this,this._packetRW.write.finalize(o))}service(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(5+e);i[r]=pe.SERVICE_REQUEST,y(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${t})`),Ie(this,this._packetRW.write.finalize(i))}authPassword(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=r?Buffer.byteLength(r):0,f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(5+i+4+14+4+8+1+4+s+(r?4+o:0));a[f]=pe.USERAUTH_REQUEST,y(a,i,++f),a.utf8Write(t,f+=4,i),y(a,14,f+=i),a.utf8Write("ssh-connection",f+=4,14),y(a,8,f+=14),a.utf8Write("password",f+=4,8),a[f+=8]=r?1:0,y(a,s,++f),Buffer.isBuffer(e)?gi(e,a,0,s,f+=4):a.utf8Write(e,f+=4,s),r?(y(a,o,f+=s),Buffer.isBuffer(r)?gi(r,a,0,o,f+=4):a.utf8Write(r,f+=4,o),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")):this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)"),this._authsQueue.push("password"),Ie(this,this._packetRW.write.finalize(a))}authPK(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");if(e=Vf(e),e instanceof Error)throw new Error("Invalid key");let s=e.type;e=e.getPublicSSH(),typeof r=="function"&&(i=r,r=void 0),r||(r=s);let o=Buffer.byteLength(t),f=Buffer.byteLength(r),a=e.length,h=this._kex.sessionID,d=h.length,l=(i?4+d:0)+1+4+o+4+14+4+9+1+4+f+4+a,H,g;if(i?(H=Buffer.allocUnsafe(l),g=0,y(H,d,g),H.set(h,g+=4),g+=d):(H=this._packetRW.write.alloc(l),g=this._packetRW.write.allocStart),H[g]=pe.USERAUTH_REQUEST,y(H,o,++g),H.utf8Write(t,g+=4,o),y(H,14,g+=o),H.utf8Write("ssh-connection",g+=4,14),y(H,9,g+=14),H.utf8Write("publickey",g+=4,9),H[g+=9]=i?1:0,y(H,f,++g),H.utf8Write(r,g+=4,f),y(H,a,g+=f),H.set(e,g+=4),!i){this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)"),Ie(this,this._packetRW.write.finalize(H));return}i(H,I=>{if(I=$f(I,s),I===!1)throw new Error("Error while converting handshake signature");let b=I.length;g=this._packetRW.write.allocStart,H=this._packetRW.write.alloc(5+o+4+14+4+9+1+4+f+4+a+4+4+f+4+b),H[g]=pe.USERAUTH_REQUEST,y(H,o,++g),H.utf8Write(t,g+=4,o),y(H,14,g+=o),H.utf8Write("ssh-connection",g+=4,14),y(H,9,g+=14),H.utf8Write("publickey",g+=4,9),H[g+=9]=1,y(H,f,++g),H.utf8Write(r,g+=4,f),y(H,a,g+=f),H.set(e,g+=4),y(H,4+f+4+b,g+=a),y(H,f,g+=4),H.utf8Write(r,g+=4,f),y(H,b,g+=f),H.set(I,g+=4),this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)"),Ie(this,this._packetRW.write.finalize(H))})}authHostbased(t,e,r,i,s,o){if(this._server)throw new Error("Client-only method called in server mode");if(e=Vf(e),e instanceof Error)throw new Error("Invalid key");let f=e.type;e=e.getPublicSSH(),typeof s=="function"&&(o=s,s=void 0),s||(s=f);let a=Buffer.byteLength(t),h=Buffer.byteLength(s),d=e.length,l=this._kex.sessionID,H=l.length,g=Buffer.byteLength(r),I=Buffer.byteLength(i),b=Buffer.allocUnsafe(4+H+1+4+a+4+14+4+9+4+h+4+d+4+g+4+I),L=0;y(b,H,L),b.set(l,L+=4),b[L+=H]=pe.USERAUTH_REQUEST,y(b,a,++L),b.utf8Write(t,L+=4,a),y(b,14,L+=a),b.utf8Write("ssh-connection",L+=4,14),y(b,9,L+=14),b.utf8Write("hostbased",L+=4,9),y(b,h,L+=9),b.utf8Write(s,L+=4,h),y(b,d,L+=h),b.set(e,L+=4),y(b,g,L+=d),b.utf8Write(r,L+=4,g),y(b,I,L+=g),b.utf8Write(i,L+=4,I),o(b,B=>{if(B=$f(B,f),!B)throw new Error("Error while converting handshake signature");let U=B.length,J=b.length-H-4;L=this._packetRW.write.allocStart;let T=this._packetRW.write.alloc(J+4+4+h+4+U);gi(b,T,4+H,b.length,L),y(T,4+h+4+U,L+=J),y(T,h,L+=4),T.utf8Write(s,L+=4,h),y(T,U,L+=h),T.set(B,L+=4),this._authsQueue.push("hostbased"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)"),Ie(this,this._packetRW.write.finalize(T))})}authKeyboard(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(5+e+4+14+4+20+4+4);i[r]=pe.USERAUTH_REQUEST,y(i,e,++r),i.utf8Write(t,r+=4,e),y(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),y(i,20,r+=14),i.utf8Write("keyboard-interactive",r+=4,20),y(i,0,r+=20),y(i,0,r+=4),this._authsQueue.push("keyboard-interactive"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)"),Ie(this,this._packetRW.write.finalize(i))}authNone(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(5+e+4+14+4+4);i[r]=pe.USERAUTH_REQUEST,y(i,e,++r),i.utf8Write(t,r+=4,e),y(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),y(i,4,r+=14),i.utf8Write("none",r+=4,4),this._authsQueue.push("none"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)"),Ie(this,this._packetRW.write.finalize(i))}authInfoRes(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r;if(t){r=new Array(t.length);for(let o=0;o<t.length;++o){let f=Buffer.byteLength(t[o]);r[o]=f,e+=4+f}}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(5+e);if(s[i]=pe.USERAUTH_INFO_RESPONSE,t){y(s,t.length,++i),i+=4;for(let o=0;o<t.length;++o){let f=r[o];y(s,f,i),i+=4,f&&(s.utf8Write(t[o],i,f),i+=f)}}else y(s,0,++i);this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE"),Ie(this,this._packetRW.write.finalize(s))}tcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(23+i+4);o[s]=pe.GLOBAL_REQUEST,y(o,13,++s),o.utf8Write("tcpip-forward",s+=4,13),o[s+=13]=r===void 0||r===!0?1:0,y(o,i,++s),o.utf8Write(t,s+=4,i),y(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)"),Ie(this,this._packetRW.write.finalize(o))}cancelTcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(30+i+4);o[s]=pe.GLOBAL_REQUEST,y(o,20,++s),o.utf8Write("cancel-tcpip-forward",s+=4,20),o[s+=20]=r===void 0||r===!0?1:0,y(o,i,++s),o.utf8Write(t,s+=4,i),y(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)"),Ie(this,this._packetRW.write.finalize(o))}openssh_streamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(41+r);s[i]=pe.GLOBAL_REQUEST,y(s,31,++i),s.utf8Write("streamlocal-forward@openssh.com",i+=4,31),s[i+=31]=e===void 0||e===!0?1:0,y(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),Ie(this,this._packetRW.write.finalize(s))}openssh_cancelStreamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(48+r);s[i]=pe.GLOBAL_REQUEST,y(s,38,++i),s.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38),s[i+=38]=e===void 0||e===!0?1:0,y(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),Ie(this,this._packetRW.write.finalize(s))}directTcpip(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.srcIP),o=Buffer.byteLength(i.dstIP),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(33+s+4+4+o+4);a[f]=pe.CHANNEL_OPEN,y(a,12,++f),a.utf8Write("direct-tcpip",f+=4,12),y(a,t,f+=12),y(a,e,f+=4),y(a,r,f+=4),y(a,o,f+=4),a.utf8Write(i.dstIP,f+=4,o),y(a,i.dstPort,f+=o),y(a,s,f+=4),a.utf8Write(i.srcIP,f+=4,s),y(a,i.srcPort,f+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-tcpip)`),Ie(this,this._packetRW.write.finalize(a))}openssh_directStreamLocal(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(51+s+4+4);f[o]=pe.CHANNEL_OPEN,y(f,30,++o),f.utf8Write("direct-streamlocal@openssh.com",o+=4,30),y(f,t,o+=30),y(f,e,o+=4),y(f,r,o+=4),y(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),jh(f,0,o+=s,o+8),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-streamlocal@openssh.com)`),Ie(this,this._packetRW.write.finalize(f))}openssh_noMoreSessions(t){if(this._server)throw new Error("Client-only method called in server mode");let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(34);r[e]=pe.GLOBAL_REQUEST,y(r,28,++e),r.utf8Write("no-more-sessions@openssh.com",e+=4,28),r[e+=28]=t===void 0||t===!0?1:0,this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)"),Ie(this,this._packetRW.write.finalize(r))}session(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(24);s[i]=pe.CHANNEL_OPEN,y(s,7,++i),s.utf8Write("session",i+=4,7),y(s,t,i+=7),y(s,e,i+=4),y(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, session)`),Ie(this,this._packetRW.write.finalize(s))}windowChange(t,e,r,i,s){if(this._server)throw new Error("Client-only method called in server mode");let o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(39);f[o]=pe.CHANNEL_REQUEST,y(f,t,++o),y(f,13,o+=4),f.utf8Write("window-change",o+=4,13),f[o+=13]=0,y(f,r,++o),y(f,e,o+=4),y(f,s,o+=4),y(f,i,o+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, window-change)`),Ie(this,this._packetRW.write.finalize(f))}pty(t,e,r,i,s,o,f,a){if(this._server)throw new Error("Client-only method called in server mode");(!o||!o.length)&&(o="vt100"),f&&!Buffer.isBuffer(f)&&!Array.isArray(f)&&typeof f=="object"&&f!==null&&(f=uu(f)),(!f||!f.length)&&(f=su);let h=o.length,d=f.length,l=this._packetRW.write.allocStart,H=this._packetRW.write.alloc(21+h+4+4+4+4+4+d);if(H[l]=pe.CHANNEL_REQUEST,y(H,t,++l),y(H,7,l+=4),H.utf8Write("pty-req",l+=4,7),H[l+=7]=a===void 0||a===!0?1:0,y(H,h,++l),H.utf8Write(o,l+=4,h),y(H,r,l+=h),y(H,e,l+=4),y(H,s,l+=4),y(H,i,l+=4),y(H,d,l+=4),l+=4,Array.isArray(f))for(let g=0;g<d;++g)H[l++]=f[g];else Buffer.isBuffer(f)&&H.set(f,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, pty-req)`),Ie(this,this._packetRW.write.finalize(H))}shell(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(15);i[r]=pe.CHANNEL_REQUEST,y(i,t,++r),y(i,5,r+=4),i.utf8Write("shell",r+=4,5),i[r+=5]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, shell)`),Ie(this,this._packetRW.write.finalize(i))}exec(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(18+s);f[o]=pe.CHANNEL_REQUEST,y(f,t,++o),y(f,4,o+=4),f.utf8Write("exec",o+=4,4),f[o+=4]=r===void 0||r===!0?1:0,y(f,s,++o),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exec: ${e})`),Ie(this,this._packetRW.write.finalize(f))}signal(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=e;if(e=e.toUpperCase(),e.slice(0,3)==="SIG"&&(e=e.slice(3)),qf[e]!==1)throw new Error(`Invalid signal: ${r}`);let i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(20+i);o[s]=pe.CHANNEL_REQUEST,y(o,t,++s),y(o,6,s+=4),o.utf8Write("signal",s+=4,6),o[s+=6]=0,y(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, signal: ${e})`),Ie(this,this._packetRW.write.finalize(o))}env(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(e),o=Buffer.isBuffer(r),f=o?r.length:Buffer.byteLength(r),a=this._packetRW.write.allocStart,h=this._packetRW.write.alloc(17+s+4+f);h[a]=pe.CHANNEL_REQUEST,y(h,t,++a),y(h,3,a+=4),h.utf8Write("env",a+=4,3),h[a+=3]=i===void 0||i===!0?1:0,y(h,s,++a),h.utf8Write(e,a+=4,s),y(h,f,a+=s),o?h.set(r,a+=4):h.utf8Write(r,a+=4,f),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, env: ${e}=${r})`),Ie(this,this._packetRW.write.finalize(h))}x11Forward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=e.protocol,s=e.cookie,o=Buffer.isBuffer(i),f=o?i.length:Buffer.byteLength(i),a=Buffer.isBuffer(s),h=a?s.length:Buffer.byteLength(s),d=this._packetRW.write.allocStart,l=this._packetRW.write.alloc(22+f+4+h+4);l[d]=pe.CHANNEL_REQUEST,y(l,t,++d),y(l,7,d+=4),l.utf8Write("x11-req",d+=4,7),l[d+=7]=r===void 0||r===!0?1:0,l[++d]=e.single?1:0,y(l,f,++d),o?l.set(i,d+=4):l.utf8Write(i,d+=4,f),y(l,h,d+=f),a?l.set(s,d+=4):l.latin1Write(s,d+=4,h),y(l,e.screen||0,d+=h),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, x11-req)`),Ie(this,this._packetRW.write.finalize(l))}subsystem(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(23+i);o[s]=pe.CHANNEL_REQUEST,y(o,t,++s),y(o,9,s+=4),o.utf8Write("subsystem",s+=4,9),o[s+=9]=r===void 0||r===!0?1:0,y(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, subsystem: ${e})`),Ie(this,this._packetRW.write.finalize(o))}openssh_agentForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(36);i[r]=pe.CHANNEL_REQUEST,y(i,t,++r),y(i,26,r+=4),i.utf8Write("auth-agent-req@openssh.com",r+=4,26),i[r+=26]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, auth-agent-req@openssh.com)`),Ie(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r=[];for(let o of t){let f=o.getPublicSSH();e+=4+f.length,r.push(f)}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(35+e);s[i]=pe.GLOBAL_REQUEST,y(s,29,++i),s.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29),s[i+=29]=1,++i;for(let o of r)y(s,o.length,i),gi(o,s,0,o.length,i+=4),i+=o.length;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)"),Ie(this,this._packetRW.write.finalize(s))}serviceAccept(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(5+e);if(i[r]=pe.SERVICE_ACCEPT,y(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${t})`),Ie(this,this._packetRW.write.finalize(i)),this._server&&this._banner&&t==="ssh-userauth"){let s=this._banner;this._banner=void 0;let o=Buffer.byteLength(s);r=this._packetRW.write.allocStart;let f=this._packetRW.write.alloc(5+o+4);f[r]=pe.USERAUTH_BANNER,y(f,o,++r),f.utf8Write(s,r+=4,o),y(f,0,r+=o),this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER"),Ie(this,this._packetRW.write.finalize(f))}}forwardedTcpip(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.boundAddr),o=Buffer.byteLength(i.remoteAddr),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(36+s+4+4+o+4);a[f]=pe.CHANNEL_OPEN,y(a,15,++f),a.utf8Write("forwarded-tcpip",f+=4,15),y(a,t,f+=15),y(a,e,f+=4),y(a,r,f+=4),y(a,s,f+=4),a.utf8Write(i.boundAddr,f+=4,s),y(a,i.boundPort,f+=s),y(a,o,f+=4),a.utf8Write(i.remoteAddr,f+=4,o),y(a,i.remotePort,f+=o),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-tcpip)`),Ie(this,this._packetRW.write.finalize(a))}x11(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.originAddr),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(24+s+4);f[o]=pe.CHANNEL_OPEN,y(f,3,++o),f.utf8Write("x11",o+=4,3),y(f,t,o+=3),y(f,e,o+=4),y(f,r,o+=4),y(f,s,o+=4),f.utf8Write(i.originAddr,o+=4,s),y(f,i.originPort,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, x11)`),Ie(this,this._packetRW.write.finalize(f))}openssh_authAgent(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(39);s[i]=pe.CHANNEL_OPEN,y(s,22,++i),s.utf8Write("auth-agent@openssh.com",i+=4,22),y(s,t,i+=22),y(s,e,i+=4),y(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, auth-agent@openssh.com)`),Ie(this,this._packetRW.write.finalize(s))}openssh_forwardedStreamLocal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(54+s+4);f[o]=pe.CHANNEL_OPEN,y(f,33,++o),f.utf8Write("forwarded-streamlocal@openssh.com",o+=4,33),y(f,t,o+=33),y(f,e,o+=4),y(f,r,o+=4),y(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),y(f,0,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-streamlocal@openssh.com)`),Ie(this,this._packetRW.write.finalize(f))}exitStatus(t,e){if(!this._server)throw new Error("Server-only method called in client mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(25);i[r]=pe.CHANNEL_REQUEST,y(i,t,++r),y(i,11,r+=4),i.utf8Write("exit-status",r+=4,11),i[r+=11]=0,y(i,e,++r),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-status: ${e})`),Ie(this,this._packetRW.write.finalize(i))}exitSignal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=e;if(typeof s!="string"||!s)throw new Error(`Invalid signal: ${s}`);let o=e.toUpperCase();if(o.slice(0,3)==="SIG"&&(o=o.slice(3)),qf[o]!==1)throw new Error(`Invalid signal: ${s}`);let f=Buffer.byteLength(o),a=i?Buffer.byteLength(i):0,h=this._packetRW.write.allocStart,d=this._packetRW.write.alloc(25+f+1+4+a+4);d[h]=pe.CHANNEL_REQUEST,y(d,t,++h),y(d,11,h+=4),d.utf8Write("exit-signal",h+=4,11),d[h+=11]=0,y(d,f,++h),d.utf8Write(o,h+=4,f),d[h+=f]=r?1:0,y(d,a,++h),h+=4,a&&(d.utf8Write(i,h,a),h+=a),y(d,0,h),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-signal: ${e})`),Ie(this,this._packetRW.write.finalize(d))}authFailure(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let r;if(typeof t=="boolean"&&(e=t,t=void 0),t){r=[];for(let f=0;f<t.length;++f)t[f].toLowerCase()!=="none"&&r.push(t[f]);r=r.join(",")}else r="";let i=r.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(5+i+1);o[s]=pe.USERAUTH_FAILURE,y(o,i,++s),o.utf8Write(r,s+=4,i),o[s+=i]=e===!0?1:0,this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE"),Ie(this,this._packetRW.write.finalize(o))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=pe.USERAUTH_SUCCESS,this._authsQueue.shift(),this._authenticated=!0,this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS"),Ie(this,this._packetRW.write.finalize(e)),this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.read=new ea),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.write=new ta(this))}authPKOK(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');let r=Buffer.byteLength(t),i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(5+r+4+i);o[s]=pe.USERAUTH_PK_OK,y(o,r,++s),o.utf8Write(t,s+=4,r),y(o,i,s+=r),o.set(e,s+=4),this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK"),Ie(this,this._packetRW.write.finalize(o))}authPasswdChg(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(5+e+4);i[r]=pe.USERAUTH_PASSWD_CHANGEREQ,y(i,e,++r),i.utf8Write(t,r+=4,e),y(i,0,r+=e),this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ"),Ie(this,this._packetRW.write.finalize(i))}authInfoReq(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=0,s=t?Buffer.byteLength(t):0,o=e?Buffer.byteLength(e):0;for(let h=0;h<r.length;++h)i+=4+Buffer.byteLength(r[h].prompt)+1;let f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(5+s+4+o+4+4+i);a[f]=pe.USERAUTH_INFO_REQUEST,y(a,s,++f),f+=4,t&&(a.utf8Write(t,f,s),f+=s),y(a,o,f),f+=4,e&&(a.utf8Write(e,f,o),f+=o),y(a,0,f),y(a,r.length,f+=4),f+=4;for(let h=0;h<r.length;++h){let d=r[h],l=Buffer.byteLength(d.prompt);y(a,l,f),f+=4,l&&(a.utf8Write(d.prompt,f,l),f+=l),a[f++]=d.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST"),Ie(this,this._packetRW.write.finalize(a))}},ou=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function fu(n,t,e){let r,i;this._buffer?(r=Buffer.allocUnsafe(this._buffer.length+(e-t)),r.set(this._buffer,0),t===0?r.set(n,this._buffer.length):r.set(new Uint8Array(n.buffer,n.byteOffset+t,e-t),this._buffer.length),i=this._buffer.length,t=0):(r=n,i=0);let s=t,o=t,f=t,a=!1,h=0,d=0;for(;t<r.length;++t){let l=r[t];if(l===13){a=!0;continue}if(l===10){if(f>o&&f-o>4&&r[o]===83&&r[o+1]===83&&r[o+2]===72&&r[o+3]===45){let H=r.latin1Slice(s,f+1),g=o===s?H:H.slice(o-s),I=ou.exec(g);if(!I)throw new Error("Invalid identification string");let b={greeting:o===s?"":H.slice(0,o-s),identRaw:g,versions:{protocol:I[1],software:I[2]},comments:I[3]};return this._remoteIdentRaw=Buffer.from(g),this._debug&&this._debug(`Remote ident: ${Zf(g)}`),this._compatFlags=hu(b),this._buffer=void 0,this._decipher=new Wh(0,Yh.bind(this,{firstPacket:!0})),this._parse=au,this._onHeader(b),this._destruct?(zf(this),t+1-i):e}if(this._server)throw new Error("Greetings from clients not permitted");if(++d>iu)throw new Error("Max greeting lines exceeded");a=!1,o=t+1,h=0}else{if(a)throw new Error("Invalid header: expected newline");if(++h>=ru)throw new Error("Header line too long")}f=t}return this._buffer||(this._buffer=Jf(r,s)),t-i}function au(n,t,e){return this._decipher.decrypt(n,t,e)}function cu(n){if(this._onPacket(),n.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}n=this._packetRW.read.read(n);let t=n[0];t===pe.USERAUTH_SUCCESS&&!this._server&&!this._authenticated&&(this._authenticated=!0,this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.write=new ta(this)),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.read=new ea));let e=Zh[t];if(e===void 0){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return e(this,n)}function hu(n){let t=n.versions.software,e=0;for(let r of qh)typeof r[0]=="string"?t===r[0]&&(e|=r[1]):r[0].test(t)&&(e|=r[1]);return e}function uu(n){let t=Object.keys(n),e=Buffer.allocUnsafe(5*t.length+1),r=0;for(let i=0;i<t.length;++i){let s=t[i];if(s==="TTY_OP_END")continue;let o=Ws[s];if(o===void 0)continue;let f=n[s];typeof f=="number"&&isFinite(f)&&(e[r++]=o,e[r++]=f>>>24,e[r++]=f>>>16,e[r++]=f>>>8,e[r++]=f)}return e[r++]=Ws.TTY_OP_END,r<e.length?Jf(e,0,r):e}function lu(n){let t="ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss";Xh&&(t=`ssh-ed25519,${t}`);let e=Buffer.byteLength(t),r=n._packetRW.write.allocStart,i=n._packetRW.write.alloc(28+e);i[r]=pe.EXT_INFO,y(i,1,++r),y(i,15,r+=4),i.utf8Write("server-sig-algs",r+=4,15),y(i,e,r+=15),i.utf8Write(t,r+=4,e),n._debug&&n._debug("Outbound: Sending EXT_INFO"),Ie(n,n._packetRW.write.finalize(i))}ra.exports=qs});var ca=je(Lr=>{"use strict";var pi=require("assert"),{inspect:du}=require("util");function ia(n){let t="",e=n.length,r=n[0]==="-"?1:0;for(;e>=r+4;e-=3)t=`_${n.slice(e-3,e)}${t}`;return`${n.slice(0,e)}${t}`}function sa(n,t){if(pi(typeof t=="string","`thing` has to be of type string"),Array.isArray(n)){let e=n.length;return pi(e>0,"At least one expected value needs to be specified"),n=n.map(r=>String(r)),e>2?`one of ${t} ${n.slice(0,e-1).join(", ")}, or `+n[e-1]:e===2?`one of ${t} ${n[0]} or ${n[1]}`:`of ${t} ${n[0]}`}return`of ${t} ${String(n)}`}Lr.ERR_INTERNAL_ASSERTION=class fa extends Error{constructor(t){super(),Error.captureStackTrace(this,fa);let e=`This is caused by either a bug in ssh2 or incorrect usage of ssh2 internals.
Please open an issue with this stack trace at https://github.com/mscdex/ssh2/issues
`;this.message=t===void 0?e:`${t}
${e}`}};var Au=2**32,oa=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();Lr.ERR_OUT_OF_RANGE=class aa extends RangeError{constructor(t,e,r,i){super(),Error.captureStackTrace(this,aa),pi(e,'Missing "range" argument');let s=i?t:`The value of "${t}" is out of range.`,o;Number.isInteger(r)&&Math.abs(r)>Au?o=ia(String(r)):typeof r=="bigint"?(o=String(r),(r>oa||r<-oa)&&(o=ia(o)),o+="n"):o=du(r),s+=` It must be ${e}. Received ${o}`,this.message=s}};var Ii=class n extends TypeError{constructor(t,e,r){super(),Error.captureStackTrace(this,n),pi(typeof t=="string","'name' must be a string");let i;typeof e=="string"&&e.startsWith("not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";let s;if(t.endsWith(" argument"))s=`The ${t} ${i} ${sa(e,"type")}`;else{let o=t.includes(".")?"property":"argument";s=`The "${t}" ${o} ${i} ${sa(e,"type")}`}s+=`. Received type ${typeof r}`,this.message=s}};Lr.ERR_INVALID_ARG_TYPE=Ii;Lr.validateNumber=function(t,e){if(typeof t!="number")throw new Ii(e,"number",t)}});var mr=je((Kd,xa)=>{"use strict";var _u=require("events"),Hn=require("fs"),{constants:vt}=Hn,{Readable:_a,Writable:to}=require("stream"),{inherits:Ha,isDate:Ys}=require("util"),Hu=Buffer[Symbol.species],{bufferCopy:_n,bufferSlice:jn,makeBufferParser:Eu,writeUInt32BE:P}=Wt(),on={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648},we=Buffer.alloc(28),Ve={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8},gu=new Map(Object.values(Ve).map(n=>[n,1])),pu={[Ve.OK]:"No error",[Ve.EOF]:"End of file",[Ve.NO_SUCH_FILE]:"No such file or directory",[Ve.PERMISSION_DENIED]:"Permission denied",[Ve.FAILURE]:"Failure",[Ve.BAD_MESSAGE]:"Bad message",[Ve.NO_CONNECTION]:"No connection",[Ve.CONNECTION_LOST]:"Connection lost",[Ve.OP_UNSUPPORTED]:"Operation unsupported"},ye={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200},Dt={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201},be={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32},ha=2*1024,tt=2**32-1,Iu=Buffer.from([0,0,0,5,ye.INIT,0,0,0,3]),bu=Buffer.from([0,0,0,5,Dt.VERSION,0,0,0,3]),xu=/^SSH-2.0-(?:OpenSSH|dropbear)/,Vs=256*1024,m=Eu(),Su={readable:!1,writable:!1,push:n=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function Ea(){}var Zs=class extends _u{constructor(t,e,r){super(),(typeof r!="object"||!r)&&(r={});let i=t._protocol._remoteIdentRaw;this.server=!!r.server,this._debug=typeof r.debug=="function"?r.debug:void 0,this._isOpenSSH=i&&xu.test(i),this._version=-1,this._extensions={},this._biOpt=r.biOpt,this._pktLenBytes=0,this._pktLen=0,this._pktPos=0,this._pktType=0,this._pktData=void 0,this._writeReqid=-1,this._requests={},this._maxInPktLen=Vs,this._maxOutPktLen=34e3,this._maxReadLen=(this._isOpenSSH?Vs:34e3)-ha,this._maxWriteLen=(this._isOpenSSH?Vs:34e3)-ha,this.maxOpenHandles=void 0,this._client=t,this._protocol=t._protocol,this._callbacks=[],this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this._waitWindow=!1,this._chunkcb=void 0,this._buffer=[],this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this.stderr=Su,this.readable=!0}push(t){if(t===null){if(ba(this),!this.readable)return;this.readable=!1,this.emit("end");return}let e=0;for(;e<t.length;){if(this._pktLenBytes<4){let o=Math.min(4-this._pktLenBytes,t.length-e);for(this._pktLenBytes+=o;o--;)this._pktLen=(this._pktLen<<8)+t[e++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return ze(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){let f=this._maxInPktLen;return ze(this,`Packet length ${this._pktLen} exceeds max length of ${f}`)}if(e>=t.length)return}if(this._pktPos<this._pktLen){let o=Math.min(this._pktLen-this._pktPos,t.length-e);if(e!==0||o!==t.length?o===this._pktLen?this._pkt=new Hu(t.buffer,t.byteOffset+e,o):(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._pktPos)):o===this._pktLen?this._pkt=t:(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(t,this._pktPos)),e+=o,this._pktPos+=o,this._pktPos<this._pktLen)return}let r=this._pkt[0],i=this._pkt;this._pktLen=0,this._pktLenBytes=0,this._pkt=void 0,this._pktPos=0;let s=this.server?mu[r]:Lu[r];if(!s)return ze(this,`Unknown packet type ${r}`);if(this._version===-1){if(this.server){if(r!==ye.INIT)return ze(this,`Expected INIT packet, got ${r}`)}else if(r!==Dt.VERSION)return ze(this,`Expected VERSION packet, got ${r}`)}if(s(this,i)===!1)return}}end(){this.destroy()}destroy(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._protocol.channelClose(this.outgoing.id))}_init(){this._init=Ea,this.server||We(this,Iu)}createReadStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new fn(this,t,e)}createWriteStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new Kt(this,t,e)}open(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");typeof r=="function"&&(i=r,r=void 0);let s=typeof e=="number"?e:pa(e);if(s===null)throw new Error(`Unknown flags string: ${e}`);let o=0,f=0;(typeof r=="string"||typeof r=="number")&&(r={mode:r}),typeof r=="object"&&r!==null&&(r=Ln(r),o=r.flags,f=r.nb);let a=Buffer.byteLength(t),h=9,d=Buffer.allocUnsafe(13+a+4+4+f);P(d,d.length-4,0),d[4]=ye.OPEN;let l=this._writeReqid=this._writeReqid+1&tt;P(d,l,5),P(d,a,h),d.utf8Write(t,h+=4,a),P(d,s,h+=a),P(d,o,h+=4),f&&(h+=4,f===we.length?d.set(we,h):_n(we,d,0,f,h),h+=f),this._requests[l]={cb:i};let H=We(this,d);this._debug&&this._debug(`SFTP: Outbound: ${H?"Buffered":"Sending"} OPEN`)}close(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.CLOSE;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} CLOSE`)}read(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>=e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");ga(this,t,e,r,i,s,o)}readData(t,e,r,i,s,o){this.read(t,e,r,i,s,o)}write(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");if(!i){o&&process.nextTick(o,void 0,0);return}let f=this._maxWriteLen,a=Math.max(i-f,0),h=s;a&&(i=f);let d=t.length,l=9,H=Buffer.allocUnsafe(13+d+8+4+i);P(H,H.length-4,0),H[4]=ye.WRITE;let g=this._writeReqid=this._writeReqid+1&tt;P(H,g,5),P(H,d,l),H.set(t,l+=4),l+=d;for(let b=7;b>=0;--b)H[l+b]=s&255,s/=256;P(H,i,l+=8),_n(e,H,r,r+i,l+=4),this._requests[g]={cb:b=>{b?typeof o=="function"&&o(b):a?this.write(t,e,r+i,a,h+i,o):typeof o=="function"&&o(void 0,r+i)}};let I=We(this,H);if(this._debug){let b=I?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${b} WRITE (id:${g})`)}}writeData(t,e,r,i,s,o){this.write(t,e,r,i,s,o)}fastGet(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");ua(this,Hn,t,e,r,i)}fastPut(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");ua(Hn,this,t,e,r,i)}readFile(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r=="function"?i=r:typeof e=="function"&&(i=e,e=void 0),typeof e=="string")e={encoding:e,flag:"r"};else if(!e)e={encoding:null,flag:"r"};else if(typeof e!="object")throw new TypeError("Bad arguments");let s=e.encoding;if(s&&!Buffer.isEncoding(s))throw new Error(`Unknown encoding: ${s}`);let o,f,a,h=0,d,l=0,H=e.flag||"r",g=()=>{o===0?(f=Buffer.allocUnsafe(8192),this.read(d,f,0,8192,l,I)):this.read(d,f,h,o-h,l,I)},I=(L,B)=>{let U;if(L){if(U=L.code===Ve.EOF,!U)return this.close(d,()=>i&&i(L))}else U=!1;if(U||o===0&&B===0)return b();l+=B,h+=B,o!==0?h===o?b():g():(a.push(jn(f,0,B)),g())};I._wantEOFError=!0;let b=()=>{this.close(d,L=>(o===0?f=Buffer.concat(a,h):h<o&&(f=jn(f,0,h)),s&&(f=f.toString(s)),i&&i(L,f)))};this.open(t,H,438,(L,B)=>{if(L)return i&&i(L);d=B;let U=(J,T)=>{if(J){this.stat(t,(Z,ee)=>{if(Z)return this.close(d,()=>{i&&i(J)});U(null,ee)});return}if(o=T.size||0,o===0)return a=[],g();f=Buffer.allocUnsafe(o),g()};this.fstat(d,U)})}writeFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"w"};else if(!r)r={encoding:"utf8",mode:438,flag:"w"};else if(typeof r!="object")throw new TypeError("Bad arguments");if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error(`Unknown encoding: ${r.encoding}`);let o=r.flag||"w";this.open(t,o,r.mode,(f,a)=>{if(f)s&&s(f);else{let h=Buffer.isBuffer(e)?e:Buffer.from(""+e,r.encoding||"utf8"),d=/a/.test(o)?null:0;if(d===null){let l=(H,g)=>{if(H){this.stat(t,(I,b)=>{if(I)return this.close(a,()=>{s&&s(H)});l(null,b)});return}js(this,a,h,0,h.length,g.size,s)};this.fstat(a,l);return}js(this,a,h,0,h.length,d,s)}})}appendFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"a"};else if(!r)r={encoding:"utf8",mode:438,flag:"a"};else if(typeof r!="object")throw new TypeError("Bad arguments");r.flag||(r=Object.assign({flag:"a"},r)),this.writeFile(t,e,r,s)}exists(t,e){if(this.server)throw new Error("Client-only method called in server mode");this.stat(t,r=>{e&&e(!r)})}unlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.REMOVE;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REMOVE`)}rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=9,f=Buffer.allocUnsafe(13+i+4+s);P(f,f.length-4,0),f[4]=ye.RENAME;let a=this._writeReqid=this._writeReqid+1&tt;P(f,a,5),P(f,i,o),f.utf8Write(t,o+=4,i),P(f,s,o+=i),f.utf8Write(e,o+=4,s),this._requests[a]={cb:r};let h=We(this,f);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} RENAME`)}mkdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="function"&&(r=e,e=void 0),typeof e=="object"&&e!==null&&(e=Ln(e),i=e.flags,s=e.nb);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(13+o+4+s);P(a,a.length-4,0),a[4]=ye.MKDIR;let h=this._writeReqid=this._writeReqid+1&tt;P(a,h,5),P(a,o,f),a.utf8Write(t,f+=4,o),P(a,i,f+=o),s&&(f+=4,s===we.length?a.set(we,f):_n(we,a,0,s,f),f+=s),this._requests[h]={cb:r};let d=We(this,a);this._debug&&this._debug(`SFTP: Outbound: ${d?"Buffered":"Sending"} MKDIR`)}rmdir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.RMDIR;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} RMDIR`)}readdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");typeof e=="function"&&(r=e,e={}),(typeof e!="object"||e===null)&&(e={});let i=!(e&&e.full);if(!Buffer.isBuffer(t)&&typeof t!="string")throw new Error("missing directory handle or path");if(typeof t=="string"){let d=[],l=0,H=(g,I)=>{if(g)return r(g);this.readdir(I,e,(b,L)=>{let B=b&&b.code===Ve.EOF;if(b&&!B)return this.close(I,()=>r(b));if(B)return this.close(I,U=>{if(U)return r(U);r(void 0,d)});for(let U=0;U<L.length;++U,++l)d[l]=L[U];H(void 0,I)})};return this.opendir(t,H)}let s=t.length,o=9,f=Buffer.allocUnsafe(13+s);P(f,f.length-4,0),f[4]=ye.READDIR;let a=this._writeReqid=this._writeReqid+1&tt;P(f,a,5),P(f,s,o),f.set(t,o+=4),this._requests[a]={cb:i?(d,l)=>{if(typeof r=="function"){if(d)return r(d);for(let H=l.length-1;H>=0;--H)(l[H].filename==="."||l[H].filename==="..")&&l.splice(H,1);r(void 0,l)}}:r};let h=We(this,f);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} READDIR`)}fstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.FSTAT;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} FSTAT`)}stat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.STAT;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STAT`)}lstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.LSTAT;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} LSTAT`)}opendir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.OPENDIR;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} OPENDIR`)}setstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="object"&&e!==null?(e=Ln(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(13+o+4+s);P(a,a.length-4,0),a[4]=ye.SETSTAT;let h=this._writeReqid=this._writeReqid+1&tt;P(a,h,5),P(a,o,f),a.utf8Write(t,f+=4,o),P(a,i,f+=o),s&&(f+=4,s===we.length?a.set(we,f):_n(we,a,0,s,f),f+=s),this._requests[h]={cb:r};let d=We(this,a);this._debug&&this._debug(`SFTP: Outbound: ${d?"Buffered":"Sending"} SETSTAT`)}fsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=0,s=0;typeof e=="object"&&e!==null?(e=Ln(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=t.length,f=9,a=Buffer.allocUnsafe(13+o+4+s);P(a,a.length-4,0),a[4]=ye.FSETSTAT;let h=this._writeReqid=this._writeReqid+1&tt;P(a,h,5),P(a,o,f),a.set(t,f+=4),P(a,i,f+=o),s&&(f+=4,s===we.length?a.set(we,f):_n(we,a,0,s,f),f+=s),this._requests[h]={cb:r};let d=We(this,a);this._debug&&this._debug(`SFTP: Outbound: ${d?"Buffered":"Sending"} FSETSTAT`)}futimes(t,e,r,i){return this.fsetstat(t,{atime:Yn(e),mtime:Yn(r)},i)}utimes(t,e,r,i){return this.setstat(t,{atime:Yn(e),mtime:Yn(r)},i)}fchown(t,e,r,i){return this.fsetstat(t,{uid:e,gid:r},i)}chown(t,e,r,i){return this.setstat(t,{uid:e,gid:r},i)}fchmod(t,e,r){return this.fsetstat(t,{mode:e},r)}chmod(t,e,r){return this.setstat(t,{mode:e},r)}readlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.READLINK;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,h)=>{if(typeof e=="function"){if(a)return e(a);if(!h||!h.length)return e(new Error("Response missing link info"));e(void 0,h[0].filename)}}};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} READLINK`)}symlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,f=Buffer.allocUnsafe(13+i+4+s);P(f,f.length-4,0),f[4]=ye.SYMLINK;let a=this._writeReqid=this._writeReqid+1&tt;P(f,a,5),this._isOpenSSH?(P(f,s,o),f.utf8Write(t,o+=4,s),P(f,i,o+=s),f.utf8Write(e,o+=4,i)):(P(f,i,o),f.utf8Write(e,o+=4,i),P(f,s,o+=i),f.utf8Write(t,o+=4,s)),this._requests[a]={cb:r};let h=We(this,f);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SYMLINK`)}realpath(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=ye.REALPATH;let o=this._writeReqid=this._writeReqid+1&tt;P(s,o,5),P(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,h)=>{if(typeof e=="function"){if(a)return e(a);if(!h||!h.length)return e(new Error("Response missing path info"));e(void 0,h[0].filename)}}};let f=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(41+s+4+o);P(a,a.length-4,0),a[4]=ye.EXTENDED;let h=this._writeReqid=this._writeReqid+1&tt;P(a,h,5),P(a,24,f),a.utf8Write("posix-rename@openssh.com",f+=4,24),P(a,s,f+=24),a.utf8Write(t,f+=4,s),P(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[h]={cb:r};let d=We(this,a);if(this._debug){let l=d?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} posix-rename@openssh.com`)}}ext_openssh_statvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["statvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(36+i);P(o,o.length-4,0),o[4]=ye.EXTENDED;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,5),P(o,19,s),o.utf8Write("statvfs@openssh.com",s+=4,19),P(o,i,s+=19),o.utf8Write(t,s+=4,i),this._requests[f]={extended:"statvfs@openssh.com",cb:e};let a=We(this,o);if(this._debug){let h=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${h} statvfs@openssh.com`)}}ext_openssh_fstatvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["fstatvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(37+i);P(o,o.length-4,0),o[4]=ye.EXTENDED;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,5),P(o,20,s),o.utf8Write("fstatvfs@openssh.com",s+=4,20),P(o,i,s+=20),o.set(t,s+=4),this._requests[f]={extended:"fstatvfs@openssh.com",cb:e};let a=We(this,o);if(this._debug){let h=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${h} fstatvfs@openssh.com`)}}ext_openssh_hardlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["hardlink@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(37+s+4+o);P(a,a.length-4,0),a[4]=ye.EXTENDED;let h=this._writeReqid=this._writeReqid+1&tt;P(a,h,5),P(a,20,f),a.utf8Write("hardlink@openssh.com",f+=4,20),P(a,s,f+=20),a.utf8Write(t,f+=4,s),P(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[h]={cb:r};let d=We(this,a);if(this._debug){let l=d?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} hardlink@openssh.com`)}}ext_openssh_fsync(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["fsync@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(34+i);P(o,o.length-4,0),o[4]=ye.EXTENDED;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,5),P(o,17,s),o.utf8Write("fsync@openssh.com",s+=4,17),P(o,i,s+=17),o.set(t,s+=4),this._requests[f]={cb:e};let a=We(this,o);this._debug&&this._debug(`SFTP: Outbound: ${a?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["lsetstat@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=0,o=0;typeof e=="object"&&e!==null?(e=Ln(e),s=e.flags,o=e.nb):typeof e=="function"&&(r=e);let f=Buffer.byteLength(t),a=9,h=Buffer.allocUnsafe(37+f+4+o);P(h,h.length-4,0),h[4]=ye.EXTENDED;let d=this._writeReqid=this._writeReqid+1&tt;P(h,d,5),P(h,20,a),h.utf8Write("lsetstat@openssh.com",a+=4,20),P(h,f,a+=20),h.utf8Write(t,a+=4,f),P(h,s,a+=f),o&&(a+=4,o===we.length?h.set(we,a):_n(we,h,0,o,a),a+=o),this._requests[d]={cb:r};let l=We(this,h);if(this._debug){let H=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${H} lsetstat@openssh.com`)}}ext_openssh_expandPath(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["expand-path@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(40+i);P(o,o.length-4,0),o[4]=ye.EXTENDED;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,5),P(o,23,s),o.utf8Write("expand-path@openssh.com",s+=4,23),P(o,i,s+=20),o.utf8Write(t,s+=4,i),this._requests[f]={cb:(h,d)=>{if(typeof e=="function"){if(h)return e(h);if(!d||!d.length)return e(new Error("Response missing expanded path"));e(void 0,d[0].filename)}}};let a=We(this,o);if(this._debug){let h=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${h} expand-path@openssh.com`)}}ext_copy_data(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["copy-data"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(i))throw new Error("Destination handle is not a Buffer");let a=0,h=Buffer.allocUnsafe(26+t.length+8+8+4+i.length+8);P(h,h.length-4,a),a+=4,h[a]=ye.EXTENDED,++a;let d=this._writeReqid=this._writeReqid+1&tt;P(h,d,a),a+=4,P(h,9,a),a+=4,h.utf8Write("copy-data",a,9),a+=9,P(h,t.length,a),a+=4,h.set(t,a),a+=t.length;for(let H=7;H>=0;--H)h[a+H]=e&255,e/=256;a+=8;for(let H=7;H>=0;--H)h[a+H]=r&255,r/=256;a+=8,P(h,i.length,a),a+=4,h.set(i,a),a+=i.length;for(let H=7;H>=0;--H)h[a+H]=s&255,s/=256;this._requests[d]={cb:o};let l=We(this,h);if(this._debug){let H=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${H} copy-data`)}}ext_home_dir(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["home-directory"]!=="1")throw new Error("Server does not support this extended request");if(typeof t!="string")throw new TypeError("username is not a string");let i=0,s=Buffer.byteLength(t),o=Buffer.allocUnsafe(31+s);P(o,o.length-4,i),i+=4,o[i]=ye.EXTENDED,++i;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,i),i+=4,P(o,14,i),i+=4,o.utf8Write("home-directory",i,14),i+=14,P(o,s,i),i+=4,o.utf8Write(t,i,s),i+=s,this._requests[f]={cb:(h,d)=>{if(typeof e=="function"){if(h)return e(h);if(!d||!d.length)return e(new Error("Response missing home directory"));e(void 0,d[0].filename)}}};let a=We(this,o);if(this._debug){let h=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${h} home-directory`)}}ext_users_groups(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["users-groups-by-id@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Array.isArray(t))throw new TypeError("uids is not an array");for(let h of t)if(!Number.isInteger(h)||h<0||h>2**32-1)throw new Error("uid values must all be 32-bit unsigned integers");if(!Array.isArray(e))throw new TypeError("gids is not an array");for(let h of e)if(!Number.isInteger(h)||h<0||h>2**32-1)throw new Error("gid values must all be 32-bit unsigned integers");let s=0,o=Buffer.allocUnsafe(47+4*t.length+4+4*e.length);P(o,o.length-4,s),s+=4,o[s]=ye.EXTENDED,++s;let f=this._writeReqid=this._writeReqid+1&tt;P(o,f,s),s+=4,P(o,30,s),s+=4,o.utf8Write("users-groups-by-id@openssh.com",s,30),s+=30,P(o,4*t.length,s),s+=4;for(let h of t)P(o,h,s),s+=4;P(o,4*e.length,s),s+=4;for(let h of e)P(o,h,s),s+=4;this._requests[f]={extended:"users-groups-by-id@openssh.com",cb:r};let a=We(this,o);if(this._debug){let h=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${h} users-groups-by-id@openssh.com`)}}handle(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let r=e.length;if(r>256)throw new Error("handle too large (> 256 bytes)");let i=9,s=Buffer.allocUnsafe(13+r);P(s,s.length-4,0),s[4]=Dt.HANDLE,P(s,t,5),P(s,r,i),r&&s.set(e,i+=4);let o=We(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} HANDLE`)}status(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");if(!gu.has(e))throw new Error(`Bad status code: ${e}`);r||(r="");let i=Buffer.byteLength(r),s=9,o=Buffer.allocUnsafe(17+i+4);P(o,o.length-4,0),o[4]=Dt.STATUS,P(o,t,5),P(o,e,s),P(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),P(o,0,s);let f=We(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STATUS`)}data(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");let i=Buffer.isBuffer(e);if(!i&&typeof e!="string")throw new Error("data is not a Buffer or string");let s;!i&&!r&&(r=void 0,s=!0);let o=i?e.length:Buffer.byteLength(e,r),f=9,a=Buffer.allocUnsafe(13+o);P(a,a.length-4,0),a[4]=Dt.DATA,P(a,t,5),P(a,o,f),o&&(i?a.set(e,f+=4):s?a.utf8Write(e,f+=4,o):a.write(e,f+=4,o,r));let h=We(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} DATA`)}name(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(e)){if(typeof e!="object"||e===null)throw new Error("names is not an object or array");e=[e]}let r=e.length,i=0,s,o=[];for(let d=0;d<r;++d){let l=e[d],H=!l||!l.filename||typeof l.filename!="string"?"":l.filename;i+=4+Buffer.byteLength(H);let g=!l||!l.longname||typeof l.longname!="string"?"":l.longname;if(i+=4+Buffer.byteLength(g),typeof l.attrs=="object"&&l.attrs!==null){if(s=Ln(l.attrs),i+=4+s.nb,s.nb){let I;s.nb===we.length?I=new Uint8Array(we):(I=new Uint8Array(s.nb),_n(we,I,0,s.nb,0)),s.bytes=I}o.push(s)}else i+=4,o.push(null)}let f=9,a=Buffer.allocUnsafe(13+i);P(a,a.length-4,0),a[4]=Dt.NAME,P(a,t,5),P(a,r,f),f+=4;for(let d=0;d<r;++d){let l=e[d];{let g=!l||!l.filename||typeof l.filename!="string"?"":l.filename,I=Buffer.byteLength(g);P(a,I,f),f+=4,I&&(a.utf8Write(g,f,I),f+=I)}{let g=!l||!l.longname||typeof l.longname!="string"?"":l.longname,I=Buffer.byteLength(g);P(a,I,f),f+=4,I&&(a.utf8Write(g,f,I),f+=I)}let H=o[d];H?(P(a,H.flags,f),f+=4,H.flags&&H.bytes&&(a.set(H.bytes,f),f+=H.nb)):(P(a,0,f),f+=4)}let h=We(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} NAME`)}attrs(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof e!="object"||e===null)throw new Error("attrs is not an object");e=Ln(e);let r=e.flags,i=e.nb,s=9,o=Buffer.allocUnsafe(13+i);P(o,o.length-4,0),o[4]=Dt.ATTRS,P(o,t,5),P(o,r,s),i&&(s+=4,i===we.length?o.set(we,s):_n(we,o,0,i,s),s+=i);let f=We(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} ATTRS`)}};function yu(n){try{return Buffer.allocUnsafe(n)}catch(t){return t}}function ga(n,t,e,r,i,s,o,f){let a=n._maxReadLen,h=Math.max(i-a,0);h&&(i=a);let d=t.length,l=9,H=s,g=Buffer.allocUnsafe(13+d+8+4);P(g,g.length-4,0),g[4]=ye.READ;let I=n._writeReqid=n._writeReqid+1&tt;P(g,I,5),P(g,d,l),g.set(t,l+=4),l+=d;for(let B=7;B>=0;--B)g[l+B]=H&255,H/=256;P(g,i,l+=8),typeof o!="function"&&(o=Ea);let b=f||{nb:0,position:s,off:r,origOff:r,len:void 0,overflow:void 0,cb:(B,U,J)=>{let T=b.len,Z=b.overflow;if(B){if(o._wantEOFError||B.code!==Ve.EOF)return o(B)}else{if(J>T)return o(new Error("Received more data than requested"));if(J===T&&Z){b.nb+=J,b.position+=J,b.off+=J,ga(n,t,e,b.off,Z,b.position,o,b);return}}J=J||0,b.origOff===0&&e.length===b.nb?U=e:U=jn(e,b.origOff,b.origOff+b.nb+J),o(void 0,b.nb+J,U,b.position)},buffer:void 0};b.len=i,b.overflow=h,b.buffer=jn(e,r,r+i),n._requests[I]=b;let L=We(n,g);n._debug&&n._debug(`SFTP: Outbound: ${L?"Buffered":"Sending"} READ`)}function ua(n,t,e,r,i,s){let o=64,f=32768,a,h,d;typeof i=="function"?s=i:typeof i=="object"&&i!==null&&(typeof i.concurrency=="number"&&i.concurrency>0&&!isNaN(i.concurrency)&&(o=i.concurrency),typeof i.chunkSize=="number"&&i.chunkSize>0&&!isNaN(i.chunkSize)&&(f=i.chunkSize),typeof i.fileSize=="number"&&i.fileSize>0&&!isNaN(i.fileSize)&&(d=i.fileSize),typeof i.step=="function"&&(a=i.step),(typeof i.mode=="string"||typeof i.mode=="number")&&(h=no(i.mode)));let l,H=0,g=0,I=!1,b,L,B,U=f*o;function J(T){if(I)return;I=!0;let Z=0,ee;b||L?(ee=()=>{--Z===0&&s(T)},b&&(n===Hn||n.outgoing.state==="open")&&++Z,L&&(t===Hn||t.outgoing.state==="open")&&++Z,b&&(n===Hn||n.outgoing.state==="open")&&n.close(b,ee),L&&(t===Hn||t.outgoing.state==="open")&&t.close(L,ee)):s(T)}n.open(e,"r",(T,Z)=>{if(T)return J(T);b=Z,d===void 0?n.fstat(b,ee):ee(null,{size:d});function ee($,x){if($){if(n!==Hn){n.stat(e,(S,R)=>{if(S)return J($);ee(null,R)});return}return J($)}l=x.size,t.open(r,"w",(S,R)=>{if(S)return J(S);if(L=R,l<=0)return J();for(;U>l;){if(o===1){U=l;break}U-=f,--o}if(B=yu(U),B instanceof Error)return J(B);h!==void 0?t.fchmod(L,h,function Y(te){if(te){t.chmod(r,h,ie=>Y());return}z()}):z();function M(Y,te,ie,k,Q,F){if(Y)return J(Y);Q=Q||0,t.write(L,B,Q,te,k,V);function V(le){if(le)return J(le);if(g+=te,a&&a(g,te,l),te<F)return re(Q,k+te,F-te);if(g===l){t.close(L,Ae=>{if(L=void 0,Ae)return J(Ae);n.close(b,st=>{if(b=void 0,st)return J(st);s()})});return}if(H>=l)return;let He=H+f>l?l-H:f;re(Q,H,He),H+=He}}function O(Y,te,ie){return(k,Q,F)=>{M(k,Q,F,te,Y,ie)}}function re(Y,te,ie){n.read(b,B,Y,ie,te,O(Y,te,ie))}function z(){let Y=0,te=0;for(;H<l&&Y<o;){let ie=H+f>l?l-H:f;re(te,H,ie),te+=ie,H+=ie,++Y}}})}})}function js(n,t,e,r,i,s,o){let f=typeof o=="function"?o:void 0;n.write(t,e,r,i,s,(a,h)=>{if(a)return n.close(t,()=>{f&&f(a)});h===i?n.close(t,f):(r+=h,i-=h,s+=h,js(n,t,e,r,i,s,f))})}var xi=class{constructor(t){this.mode=t&&t.mode,this.uid=t&&t.uid,this.gid=t&&t.gid,this.size=t&&t.size,this.atime=t&&t.atime,this.mtime=t&&t.mtime,this.extended=t&&t.extended}isDirectory(){return(this.mode&vt.S_IFMT)===vt.S_IFDIR}isFile(){return(this.mode&vt.S_IFMT)===vt.S_IFREG}isBlockDevice(){return(this.mode&vt.S_IFMT)===vt.S_IFBLK}isCharacterDevice(){return(this.mode&vt.S_IFMT)===vt.S_IFCHR}isSymbolicLink(){return(this.mode&vt.S_IFMT)===vt.S_IFLNK}isFIFO(){return(this.mode&vt.S_IFMT)===vt.S_IFIFO}isSocket(){return(this.mode&vt.S_IFMT)===vt.S_IFSOCK}};function Ln(n){let t=0,e=0;if(typeof n=="object"&&n!==null){if(typeof n.size=="number"){t|=on.SIZE;let r=n.size;we[e++]=r/72057594037927940,we[e++]=r/281474976710656,we[e++]=r/1099511627776,we[e++]=r/4294967296,we[e++]=r/16777216,we[e++]=r/65536,we[e++]=r/256,we[e++]=r}if(typeof n.uid=="number"&&typeof n.gid=="number"){t|=on.UIDGID;let r=n.uid,i=n.gid;we[e++]=r>>>24,we[e++]=r>>>16,we[e++]=r>>>8,we[e++]=r,we[e++]=i>>>24,we[e++]=i>>>16,we[e++]=i>>>8,we[e++]=i}if(typeof n.mode=="number"||typeof n.mode=="string"){let r=no(n.mode);t|=on.PERMISSIONS,we[e++]=r>>>24,we[e++]=r>>>16,we[e++]=r>>>8,we[e++]=r}if((typeof n.atime=="number"||Ys(n.atime))&&(typeof n.mtime=="number"||Ys(n.mtime))){let r=Yn(n.atime),i=Yn(n.mtime);t|=on.ACMODTIME,we[e++]=r>>>24,we[e++]=r>>>16,we[e++]=r>>>8,we[e++]=r,we[e++]=i>>>24,we[e++]=i>>>16,we[e++]=i>>>8,we[e++]=i}}return{flags:t,nb:e}}function Yn(n){if(typeof n=="number"&&n===n)return n;if(Ys(n))return parseInt(n.getTime()/1e3,10);throw new Error(`Cannot parse time: ${n}`)}function no(n){if(typeof n=="number"&&n===n)return n;if(typeof n=="string")return no(parseInt(n,8));throw new Error(`Cannot parse mode: ${n}`)}var zs={r:be.READ,"r+":be.READ|be.WRITE,w:be.TRUNC|be.CREAT|be.WRITE,wx:be.TRUNC|be.CREAT|be.WRITE|be.EXCL,xw:be.TRUNC|be.CREAT|be.WRITE|be.EXCL,"w+":be.TRUNC|be.CREAT|be.READ|be.WRITE,"wx+":be.TRUNC|be.CREAT|be.READ|be.WRITE|be.EXCL,"xw+":be.TRUNC|be.CREAT|be.READ|be.WRITE|be.EXCL,a:be.APPEND|be.CREAT|be.WRITE,ax:be.APPEND|be.CREAT|be.WRITE|be.EXCL,xa:be.APPEND|be.CREAT|be.WRITE|be.EXCL,"a+":be.APPEND|be.CREAT|be.READ|be.WRITE,"ax+":be.APPEND|be.CREAT|be.READ|be.WRITE|be.EXCL,"xa+":be.APPEND|be.CREAT|be.READ|be.WRITE|be.EXCL};function pa(n){let t=zs[n];return t!==void 0?t:null}var Cu=(()=>{let n=Object.keys(zs);return t=>{for(let e=0;e<n.length;++e){let r=n[e];if(zs[r]===t)return r}return null}})();function Zn(n){let t=m.readUInt32BE();if(t===void 0)return;let e=new xi;if(t&on.SIZE){let r=m.readUInt64BE(n);if(r===void 0)return;e.size=r}if(t&on.UIDGID){let r=m.readUInt32BE(),i=m.readUInt32BE();if(i===void 0)return;e.uid=r,e.gid=i}if(t&on.PERMISSIONS){let r=m.readUInt32BE();if(r===void 0)return;e.mode=r}if(t&on.ACMODTIME){let r=m.readUInt32BE(),i=m.readUInt32BE();if(i===void 0)return;e.atime=r,e.mtime=i}if(t&on.EXTENDED){let r=m.readUInt32BE();if(r===void 0)return;let i={};for(let s=0;s<r;++s){let o=m.readString(!0),f=m.readString();if(f===void 0)return;i[o]=f}e.extended=i}return e}function We(n,t){let e=Ia(n,t);return e!==void 0?(n._buffer.push(e),!1):!0}function Ia(n,t){let e=n.outgoing;if(e.state!=="open")return;if(e.window===0)return n._waitWindow=!0,n._chunkcb=la,t;let r,i=t.length,s=0;for(;i-s>0&&e.window>0;){let o=Math.min(i-s,e.window,e.packetSize);e.window-=o,e.window===0&&(n._waitWindow=!0,n._chunkcb=la),s===0&&o===i?n._protocol.channelData(n.outgoing.id,t):n._protocol.channelData(n.outgoing.id,jn(t,s,s+o)),s+=o}return i-s>0&&(s>0?r=jn(t,s,i):r=t),r}function la(){this._chunkcb=void 0;let n=this._buffer,t=0;for(;t<n.length;){let e=n[t],r=Ia(this,e);if(r!==void 0){r!==e&&(n[t]=r),t>0&&(this._buffer=n.slice(t));return}++t}t>0&&(this._buffer=[])}function ze(n,t,e){let r=new Error(t);return r.level="sftp-protocol",!e&&n._debug&&n._debug(`SFTP: Inbound: ${t}`),n.emit("error",r),n.destroy(),ba(n),!1}function ba(n){let t=Object.keys(n._requests);if(t.length===0)return;let e=n._requests;n._requests={};let r=new Error("No response from server");for(let i=0;i<t.length;++i){let s=e[t[i]];typeof s.cb=="function"&&s.cb(r)}}function wu(n,t){let e=9,r=Buffer.allocUnsafe(31);P(r,r.length-4,0),r[4]=ye.EXTENDED;let i=n._writeReqid=n._writeReqid+1&tt;P(r,i,5),P(r,18,e),r.utf8Write("limits@openssh.com",e+=4,18),n._requests[i]={extended:"limits@openssh.com",cb:t};let s=We(n,r);if(n._debug){let o=s?"Buffered":"Sending";n._debug(`SFTP: Outbound: ${o} limits@openssh.com`)}}var Lu={[Dt.VERSION]:(n,t)=>{if(n._version!==-1)return ze(n,"Duplicate VERSION packet");let e={};m.init(t,1);let r=m.readUInt32BE();for(;m.avail();){let i=m.readString(!0),s=m.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(m.clear(),r===void 0)return ze(n,"Malformed VERSION packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received VERSION (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received VERSION (v${r})`)}if(n._version=r,n._extensions=e,e["limits@openssh.com"]==="1")return wu(n,(i,s)=>{i||(s.maxPktLen>0&&(n._maxOutPktLen=s.maxPktLen),s.maxReadLen>0&&(n._maxReadLen=s.maxReadLen),s.maxWriteLen>0&&(n._maxWriteLen=s.maxWriteLen),n.maxOpenHandles=s.maxOpenHandles>0?s.maxOpenHandles:1/0),n.emit("ready")});n.emit("ready")},[Dt.STATUS]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readUInt32BE(),i=m.readString(!0);if(m.clear(),n._debug){let o=JSON.stringify(i);n._debug(`SFTP: Inbound: Received STATUS (id:${e}, ${r}, ${o})`)}let s=n._requests[e];if(delete n._requests[e],s&&typeof s.cb=="function"){if(r===Ve.OK){s.cb();return}let o=new Error(i||pu[r]||"Unknown status");o.code=r,s.cb(o)}},[Dt.HANDLE]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString();if(m.clear(),r===void 0)return e!==void 0&&delete n._requests[e],ze(n,"Malformed HANDLE packet");n._debug&&n._debug(`SFTP: Inbound: Received HANDLE (id:${e})`);let i=n._requests[e];delete n._requests[e],i&&typeof i.cb=="function"&&i.cb(void 0,r)},[Dt.DATA]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r;if(e!==void 0&&(r=n._requests[e],delete n._requests[e]),r&&typeof r.cb=="function")if(r.buffer){let i=m.readString(r.buffer);if(m.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`),r.cb(void 0,r.buffer,i);return}}else{let i=m.readString();if(m.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i.length})`),r.cb(void 0,i);return}}else{let i=m.skipString();if(m.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`);return}}return ze(n,"Malformed DATA packet")},[Dt.NAME]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=m.readUInt32BE();if(i!==void 0){let s=[];for(let o=0;o<i;++o){let f=m.readString(!0),a=m.readString(!0),h=Zn(n._biOpt);if(h===void 0){s=void 0;break}s.push({filename:f,longname:a,attrs:h})}if(s!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received NAME (id:${e}, ${s.length})`),m.clear(),r&&typeof r.cb=="function"&&r.cb(void 0,s);return}}return m.clear(),ze(n,"Malformed NAME packet")},[Dt.ATTRS]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=Zn(n._biOpt);if(m.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received ATTRS (id:${e})`),r&&typeof r.cb=="function"&&r.cb(void 0,i);return}return ze(n,"Malformed ATTRS packet")},[Dt.EXTENDED]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE();if(e!==void 0){let r=n._requests[e];if(r)switch(delete n._requests[e],r.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{let i=n._biOpt,s={f_bsize:m.readUInt64BE(i),f_frsize:m.readUInt64BE(i),f_blocks:m.readUInt64BE(i),f_bfree:m.readUInt64BE(i),f_bavail:m.readUInt64BE(i),f_files:m.readUInt64BE(i),f_ffree:m.readUInt64BE(i),f_favail:m.readUInt64BE(i),f_sid:m.readUInt64BE(i),f_flag:m.readUInt64BE(i),f_namemax:m.readUInt64BE(i)};if(s.f_namemax===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),m.clear(),typeof r.cb=="function"&&r.cb(void 0,s);return}case"limits@openssh.com":{let i={maxPktLen:m.readUInt64BE(),maxReadLen:m.readUInt64BE(),maxWriteLen:m.readUInt64BE(),maxOpenHandles:m.readUInt64BE()};if(i.maxOpenHandles===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),m.clear(),typeof r.cb=="function"&&r.cb(void 0,i);return}case"users-groups-by-id@openssh.com":{let i=m.readUInt32BE();if(i===void 0)break;let s=new Array(i);for(let a=0;a<s.length;++a)s[a]=m.readString(!0);let o=m.readUInt32BE();if(o===void 0)break;let f=new Array(o);for(let a=0;a<f.length;++a)f[a]=m.readString(!0);if(f.length>0&&f[f.length-1]===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),m.clear(),typeof r.cb=="function"&&r.cb(void 0,s,f);return}default:n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),m.clear(),typeof r.cb=="function"&&r.cb();return}else{n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),m.clear();return}}return m.clear(),ze(n,"Malformed EXTENDED_REPLY packet")}},mu={[ye.INIT]:(n,t)=>{if(n._version!==-1)return ze(n,"Duplicate INIT packet");let e={};m.init(t,1);let r=m.readUInt32BE();for(;m.avail();){let i=m.readString(!0),s=m.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(m.clear(),r===void 0)return ze(n,"Malformed INIT packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received INIT (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received INIT (v${r})`)}We(n,bu),n._version=r,n._extensions=e,n.emit("ready")},[ye.OPEN]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0),i=m.readUInt32BE(),s=Zn(n._biOpt);if(m.clear(),s===void 0)return ze(n,"Malformed OPEN packet");n._debug&&n._debug(`SFTP: Inbound: Received OPEN (id:${e})`),n.emit("OPEN",e,r,i,s)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.CLOSE]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString();if(m.clear(),r===void 0||r.length>256)return ze(n,"Malformed CLOSE packet");n._debug&&n._debug(`SFTP: Inbound: Received CLOSE (id:${e})`),n.emit("CLOSE",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.READ]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(),i=m.readUInt64BE(n._biOpt),s=m.readUInt32BE();if(m.clear(),s===void 0||r.length>256)return ze(n,"Malformed READ packet");n._debug&&n._debug(`SFTP: Inbound: Received READ (id:${e})`),n.emit("READ",e,r,i,s)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.WRITE]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(),i=m.readUInt64BE(n._biOpt),s=m.readString();if(m.clear(),s===void 0||r.length>256)return ze(n,"Malformed WRITE packet");n._debug&&n._debug(`SFTP: Inbound: Received WRITE (id:${e})`),n.emit("WRITE",e,r,i,s)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.LSTAT]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed LSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received LSTAT (id:${e})`),n.emit("LSTAT",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.FSTAT]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString();if(m.clear(),r===void 0||r.length>256)return ze(n,"Malformed FSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSTAT (id:${e})`),n.emit("FSTAT",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.SETSTAT]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0),i=Zn(n._biOpt);if(m.clear(),i===void 0)return ze(n,"Malformed SETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received SETSTAT (id:${e})`),n.emit("SETSTAT",e,r,i)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.FSETSTAT]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(),i=Zn(n._biOpt);if(m.clear(),i===void 0||r.length>256)return ze(n,"Malformed FSETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSETSTAT (id:${e})`),n.emit("FSETSTAT",e,r,i)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.OPENDIR]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed OPENDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received OPENDIR (id:${e})`),n.emit("OPENDIR",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.READDIR]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString();if(m.clear(),r===void 0||r.length>256)return ze(n,"Malformed READDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received READDIR (id:${e})`),n.emit("READDIR",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.REMOVE]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed REMOVE packet");n._debug&&n._debug(`SFTP: Inbound: Received REMOVE (id:${e})`),n.emit("REMOVE",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.MKDIR]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0),i=Zn(n._biOpt);if(m.clear(),i===void 0)return ze(n,"Malformed MKDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received MKDIR (id:${e})`),n.emit("MKDIR",e,r,i)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.RMDIR]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed RMDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received RMDIR (id:${e})`),n.emit("RMDIR",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.REALPATH]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed REALPATH packet");n._debug&&n._debug(`SFTP: Inbound: Received REALPATH (id:${e})`),n.emit("REALPATH",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.STAT]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed STAT packet");n._debug&&n._debug(`SFTP: Inbound: Received STAT (id:${e})`),n.emit("STAT",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.RENAME]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0),i=m.readString(!0);if(m.clear(),i===void 0)return ze(n,"Malformed RENAME packet");n._debug&&n._debug(`SFTP: Inbound: Received RENAME (id:${e})`),n.emit("RENAME",e,r,i)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.READLINK]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(m.clear(),r===void 0)return ze(n,"Malformed READLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received READLINK (id:${e})`),n.emit("READLINK",e,r)||n.status(e,Ve.OP_UNSUPPORTED)},[ye.SYMLINK]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0),i=m.readString(!0);if(m.clear(),i===void 0)return ze(n,"Malformed SYMLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received SYMLINK (id:${e})`);let s;n._isOpenSSH?s=n.emit("SYMLINK",e,i,r):s=n.emit("SYMLINK",e,r,i),s||n.status(e,Ve.OP_UNSUPPORTED)},[ye.EXTENDED]:(n,t)=>{m.init(t,1);let e=m.readUInt32BE(),r=m.readString(!0);if(r===void 0)return m.clear(),ze(n,"Malformed EXTENDED packet");let i;m.avail()&&(i=m.readRaw()),m.clear(),n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED (id:${e})`),n.emit("EXTENDED",e,r,i)||n.status(e,Ve.OP_UNSUPPORTED)}},{ERR_INVALID_ARG_TYPE:Nu,ERR_OUT_OF_RANGE:bi,validateNumber:Bu}=ca(),da=128,Bt,Js=[];function ku(n){Js.length>0?Bt=Js.pop():Bt=Buffer.allocUnsafe(n),Bt.used=0}function eo(n,t){if(!Number.isSafeInteger(n))throw Bu(n,t),Number.isInteger(n)?new bi(t,">= 0 and <= 2 ** 53 - 1",n):new bi(t,"an integer",n);if(n<0)throw new bi(t,">= 0 and <= 2 ** 53 - 1",n)}function $s(n){return n+7&-8}function fn(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}if(e.highWaterMark===void 0&&(e.highWaterMark=64*1024),e.emitClose=!1,e.autoDestroy=!1,_a.call(this,e),this.path=t,this.flags=e.flags===void 0?"r":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.end=e.end,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesRead=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(eo(this.start,"start"),this.pos=this.start),this.end===void 0)this.end=1/0;else if(this.end!==1/0&&(eo(this.end,"end"),this.start!==void 0&&this.start>this.end))throw new bi("start",`<= "end" (here: ${this.end})`,this.start);this.on("end",function(){this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}Ha(fn,_a);fn.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t,this.emit("open",t),this.emit("ready"),this.read()}))};fn.prototype._read=function(n){if(!Buffer.isBuffer(this.handle))return this.once("open",()=>this._read(n));if(this.destroyed)return;(!Bt||Bt.length-Bt.used<da)&&ku(this.readableHighWaterMark||this._readableState.highWaterMark);let t=Bt,e=Math.min(Bt.length-Bt.used,n),r=Bt.used;if(this.end!==void 0&&(e=Math.min(this.end-this.pos+1,e)),e<=0)return this.push(null);this.sftp.read(this.handle,Bt,Bt.used,e,this.pos,(i,s)=>{if(i){this.emit("error",i),this.autoClose&&this.destroy();return}let o=null;if(r+e===t.used&&t===Bt)t.used=$s(t.used+s-e);else{let f=r+e&-8,a=$s(r+s);f-a>=da&&Js.push(t.slice(a,f))}s>0&&(this.bytesRead+=s,o=t.slice(r,r+s)),this.pos+=s,this.push(o)}),Bt.used=$s(Bt.used+e)};fn.prototype._destroy=function(n,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",Aa.bind(null,this,t,n));return}Aa(this,t,n),this.handle=null,this._opening=!1};function Aa(n,t,e){if(!n.handle)return r();n.sftp.close(n.handle,r);function r(i){i=i||e,t(i),n.isClosed=!0,i||n.emit("close")}}fn.prototype.close=function(n){this.destroy(null,n)};Object.defineProperty(fn.prototype,"pending",{get(){return this.handle===null},configurable:!0});function Kt(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}e.emitClose=!1,e.autoDestroy=!1,to.call(this,e),this.path=t,this.flags=e.flags===void 0?"w":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesWritten=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(eo(this.start,"start"),this.pos=this.start),e.encoding&&this.setDefaultEncoding(e.encoding),this.on("finish",function(){this._writableState.finalCalled||this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}Ha(Kt,to);Kt.prototype._final=function(n){this.autoClose&&this.destroy(),n()};Kt.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t;let e=r=>{if(r){this.sftp.chmod(this.path,this.mode,i=>e());return}if(this.flags[0]==="a"){let i=(s,o)=>{if(s){this.sftp.stat(this.path,(f,a)=>{if(f){this.destroy(),this.emit("error",s);return}i(null,a)});return}this.pos=o.size,this.emit("open",t),this.emit("ready")};this.sftp.fstat(t,i);return}this.emit("open",t),this.emit("ready")};this.sftp.fchmod(t,this.mode,e)}))};Kt.prototype._write=function(n,t,e){if(!Buffer.isBuffer(n)){let r=new Nu("data","Buffer",n);return this.emit("error",r)}if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._write(n,t,e)});this.sftp.write(this.handle,n,0,n.length,this.pos,(r,i)=>{if(r)return this.autoClose&&this.destroy(),e(r);this.bytesWritten+=i,e()}),this.pos+=n.length};Kt.prototype._writev=function(n,t){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._writev(n,t)});let e=this.sftp,r=this.handle,i=n.length,s=(o,f)=>{if(o)return this.destroy(),t(o);this.bytesWritten+=f,--i===0&&t()};for(let o=0;o<n.length;++o){let f=n[o].chunk;e.write(r,f,0,f.length,this.pos,s),this.pos+=f.length}};typeof to.prototype.destroy!="function"&&(Kt.prototype.destroy=fn.prototype.destroy);Kt.prototype._destroy=fn.prototype._destroy;Kt.prototype.close=function(n){if(n){if(this.isClosed){process.nextTick(n);return}this.on("close",n)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()};Kt.prototype.destroySoon=Kt.prototype.end;Object.defineProperty(Kt.prototype,"pending",{get(){return this.handle===null},configurable:!0});xa.exports={flagsToString:Cu,OPEN_MODE:be,SFTP:Zs,Stats:xi,STATUS_CODE:Ve,stringToFlags:pa}});var ao=je((Wd,wa)=>{"use strict";var{Duplex:Ru,Readable:vu,Writable:Du}=require("stream"),{CHANNEL_EXTENDED_DATATYPE:{STDERR:Sa}}=nn(),{bufferSlice:Si}=Wt(),Tu=32*1024,Nr=2*1024*1024,oo=Nr/2,ro=class extends vu{constructor(t,e){super(e),this._channel=t}_read(t){this._channel._waitChanDrain&&(this._channel._waitChanDrain=!1,this._channel.incoming.window<=oo&&fo(this._channel))}},io=class extends Du{constructor(t){super({highWaterMark:Nr}),this._channel=t}_write(t,e,r){let i=this._channel,s=i._client._protocol,o=i.outgoing,f=o.packetSize,a=o.id,h=o.window,d=t.length,l=0;if(o.state==="open"){for(;d-l>0&&h>0;){let H=d-l;H>h&&(H=h),H>f&&(H=f),l===0&&H===d?s.channelExtData(a,t,Sa):s.channelExtData(a,Si(t,l,l+H),Sa),l+=H,h-=H}if(o.window=h,d-l>0){h===0&&(i._waitWindow=!0),l>0?i._chunkErr=Si(t,l,d):i._chunkErr=t,i._chunkcbErr=r;return}r()}}},so=class extends Ru{constructor(t,e,r){let i={highWaterMark:Nr,allowHalfOpen:!r||r&&r.allowHalfOpen!==!1,emitClose:!1};super(i),this.allowHalfOpen=i.allowHalfOpen;let s=!!(r&&r.server);this.server=s,this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this._callbacks=[],this._client=t,this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this.stdin=this.stdout=this,s?this.stderr=new io(this):this.stderr=new ro(this,i),this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",ya).on("prefinish",ya),this.on("end",Ca).on("close",Ca)}_read(t){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=oo&&fo(this))}_write(t,e,r){let i=this._client._protocol,s=this.outgoing,o=s.packetSize,f=s.id,a=s.window,h=t.length,d=0;if(s.state==="open"){for(;h-d>0&&a>0;){let l=h-d;l>a&&(l=a),l>o&&(l=o),d===0&&l===h?i.channelData(f,t):i.channelData(f,Si(t,d,d+l)),d+=l,a-=l}if(s.window=a,h-d>0){a===0&&(this._waitWindow=!0),d>0?this._chunk=Si(t,d,h):this._chunk=t,this._chunkcb=r;return}r()}}eof(){this.outgoing.state==="open"&&(this.outgoing.state="eof",this._client._protocol.channelEOF(this.outgoing.id))}close(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._client._protocol.channelClose(this.outgoing.id))}destroy(){return this.end(),this.close(),this}setWindow(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.windowChange(this.outgoing.id,t,e,r,i)}signal(t){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.signal(this.outgoing.id,t)}exit(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&(typeof t=="number"?this._client._protocol.exitStatus(this.outgoing.id,t):this._client._protocol.exitSignal(this.outgoing.id,t,e,r))}};function ya(){this.eof(),(this.server||!this.allowHalfOpen)&&this.close(),this.writable=!1}function Ca(){this.readable=!1}function fo(n){if(n.outgoing.state==="closed")return;let t=Nr-n.incoming.window;t<=0||(n.incoming.window+=t,n._client._protocol.channelWindowAdjust(n.outgoing.id,t))}wa.exports={Channel:so,MAX_WINDOW:Nr,PACKET_SIZE:Tu,windowAdjust:fo,WINDOW_THRESHOLD:oo}});var uo=je((qd,Na)=>{"use strict";var{SFTP:Pu}=mr(),Br=2**32-1;function La(n,t,e,r){if(n._chanMgr.remove(t),typeof r!="function")return;let i;e instanceof Error?i=e:typeof e=="object"&&e!==null?(i=new Error(`(SSH) Channel open failure: ${e.description}`),i.reason=e.reason):(i=new Error("(SSH) Channel open failure: server closed channel unexpectedly"),i.reason=""),r(i)}function ma(n,t,e,r,i){if(typeof e=="function"){La(n,t,r,e);return}if(typeof e!="object"||e===null||e.incoming&&e.incoming.state==="closed"||(n._chanMgr.remove(t),e.server&&e.constructor.name==="Session"))return;e.incoming.state="closed",e.readable&&e.push(null),e.server?e.stderr.writable&&e.stderr.end():e.stderr.readable&&e.stderr.push(null),e.constructor!==Pu&&(e.outgoing.state==="open"||e.outgoing.state==="eof")&&!i&&e.close(),e.outgoing.state==="closing"&&(e.outgoing.state="closed");let s=e._readableState,o=e._writableState;o&&!o.ending&&!o.finished&&!i&&e.end();let f=e._callbacks;e._callbacks=[];for(let a=0;a<f.length;++a)f[a](!0);if(e.server)!e.readable||e.destroyed||s&&s.endEmitted?e.emit("close"):e.once("end",()=>e.emit("close"));else{let a;switch(e.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":a=()=>e.emit("close");break;default:{let d=e._exit;a=()=>{d.code===null?e.emit("close",d.code,d.signal,d.dump,d.desc):e.emit("close",d.code)}}}!e.readable||e.destroyed||s&&s.endEmitted?a():e.once("end",a);let h=e.stderr._readableState;!e.stderr.readable||e.stderr.destroyed||h&&h.endEmitted?e.stderr.emit("close"):e.stderr.once("end",()=>e.stderr.emit("close"))}}var ho=class{constructor(t){this._client=t,this._channels={},this._cur=-1,this._count=0}add(t){let e;if(this._cur<Br)e=++this._cur;else if(this._count===0)this._cur=0,e=0;else{let r=this._channels;for(let i=0;i<Br;++i)if(r[i]===void 0){e=i;break}}return e===void 0?-1:(this._channels[e]=t||!0,++this._count,e)}update(t,e){if(typeof t!="number"||t<0||t>=Br||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);e&&this._channels[t]&&(this._channels[t]=e)}get(t){if(typeof t!="number"||t<0||t>=Br||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);return this._channels[t]}remove(t){if(typeof t!="number"||t<0||t>=Br||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);this._channels[t]&&(delete this._channels[t],this._count&&--this._count)}cleanup(t){let e=this._channels;this._channels={},this._cur=-1,this._count=0;let r=Object.keys(e),i=this._client;for(let s=0;s<r.length;++s){let o=+r[s],f=e[o];ma(i,o,f._channel||f,t,!0)}}},co=(()=>{let n=Object.prototype.toString;return t=>n.call(t)==="[object RegExp]"})();function Uu(n,t,e){if(Array.isArray(n)&&n.length>0){for(let r=0;r<n.length;++r)if(e.indexOf(n[r])===-1)throw new Error(`Unsupported algorithm: ${n[r]}`);return n}if(typeof n=="object"&&n!==null){let r=Object.keys(n),i=t;for(let s=0;s<r.length;++s){let o=r[s],f=n[o];switch(o){case"append":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let h=f[a];if(typeof h=="string"){if(!h||i.indexOf(h)!==-1)continue;if(e.indexOf(h)===-1)throw new Error(`Unsupported algorithm: ${h}`);i===t&&(i=i.slice()),i.push(h)}else if(co(h))for(let d=0;d<e.length;++d){let l=e[d];if(h.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.push(l)}}}break;case"prepend":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=f.length;a>=0;--a){let h=f[a];if(typeof h=="string"){if(!h||i.indexOf(h)!==-1)continue;if(e.indexOf(h)===-1)throw new Error(`Unsupported algorithm: ${h}`);i===t&&(i=i.slice()),i.unshift(h)}else if(co(h))for(let d=e.length;d>=0;--d){let l=e[d];if(h.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.unshift(l)}}}break;case"remove":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let h=f[a];if(typeof h=="string"){if(!h)continue;let d=i.indexOf(h);if(d===-1)continue;i===t&&(i=i.slice()),i.splice(d,1)}else if(co(h))for(let d=0;d<i.length;++d)h.test(i[d])&&(i===t&&(i=i.slice()),i.splice(d,1),--d)}break}}return i}return t}Na.exports={ChannelManager:ho,generateAlgorithmList:Uu,onChannelOpenFailure:La,onCHANNEL_CLOSE:ma,isWritable:n=>n&&n.writable&&n._readableState&&n._readableState.ended===!1}});var Eo=je((Xd,ja)=>{"use strict";var{createHash:Ou,getHashes:Fu,randomFillSync:Qu}=require("crypto"),{Socket:Mu}=require("net"),{lookup:Gu}=require("dns"),Ku=require("events"),Wu=Fu(),{COMPAT:$a,CHANNEL_EXTENDED_DATATYPE:{STDERR:qu},CHANNEL_OPEN_FAILURE:kr,DEFAULT_CIPHER:Ba,DEFAULT_COMPRESSION:ka,DEFAULT_KEX:Ra,DEFAULT_MAC:va,DEFAULT_SERVER_HOST_KEY:Da,DISCONNECT_REASON:Ta,DISCONNECT_REASON_BY_VALUE:Xu,SUPPORTED_CIPHER:Vu,SUPPORTED_COMPRESSION:$u,SUPPORTED_KEX:Yu,SUPPORTED_MAC:Zu,SUPPORTED_SERVER_HOST_KEY:ju}=nn(),{init:zu}=un(),Ju=Xs(),{parseKey:wi}=An(),{SFTP:el}=mr(),{bufferCopy:Pa,makeBufferParser:Ya,makeError:tl,readUInt32BE:nl,sigSSHToASN1:rl,writeUInt32BE:lo}=Wt(),{AgentContext:Ua,createAgent:Oa,isAgent:Fa}=ks(),{Channel:Za,MAX_WINDOW:Li,PACKET_SIZE:mi,windowAdjust:Qa,WINDOW_THRESHOLD:Ma}=ao(),{ChannelManager:il,generateAlgorithmList:Rr,isWritable:Ht,onChannelOpenFailure:sl,onCHANNEL_CLOSE:ol}=uo(),yi=Ya(),Ci=Ya(),vr=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,_o=n=>{},Ho=class extends Ku{constructor(){super(),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,ident:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._agent=void 0,this._readyTimeout=void 0,this._chanMgr=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._remoteVer=void 0,this._protocol=void 0,this._sock=void 0,this._resetKA=void 0}connect(t){if(this._sock&&Ht(this._sock))return this.once("close",()=>{this.connect(t)}),this.end(),this;this.config.host=t.hostname||t.host||"localhost",this.config.port=t.port||22,this.config.localAddress=typeof t.localAddress=="string"?t.localAddress:void 0,this.config.localPort=typeof t.localPort=="string"||typeof t.localPort=="number"?t.localPort:void 0,this.config.forceIPv4=t.forceIPv4||!1,this.config.forceIPv6=t.forceIPv6||!1,this.config.keepaliveCountMax=typeof t.keepaliveCountMax=="number"&&t.keepaliveCountMax>=0?t.keepaliveCountMax:3,this.config.keepaliveInterval=typeof t.keepaliveInterval=="number"&&t.keepaliveInterval>0?t.keepaliveInterval:0,this.config.readyTimeout=typeof t.readyTimeout=="number"&&t.readyTimeout>=0?t.readyTimeout:2e4,this.config.ident=typeof t.ident=="string"||Buffer.isBuffer(t.ident)?t.ident:void 0;let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:[]},sc:void 0},r=!0;if(typeof t.algorithms=="object"&&t.algorithms!==null&&(e.kex=Rr(t.algorithms.kex,Ra,Yu),e.kex!==Ra&&(r=!1),e.serverHostKey=Rr(t.algorithms.serverHostKey,Da,ju),e.serverHostKey!==Da&&(r=!1),e.cs.cipher=Rr(t.algorithms.cipher,Ba,Vu),e.cs.cipher!==Ba&&(r=!1),e.cs.mac=Rr(t.algorithms.hmac,va,Zu),e.cs.mac!==va&&(r=!1),e.cs.compress=Rr(t.algorithms.compress,ka,$u),e.cs.compress!==ka&&(r=!1),r||(e.sc=e.cs)),typeof t.username=="string")this.config.username=t.username;else if(typeof t.user=="string")this.config.username=t.user;else throw new Error("Invalid username");this.config.password=typeof t.password=="string"?t.password:void 0,this.config.privateKey=typeof t.privateKey=="string"||Buffer.isBuffer(t.privateKey)?t.privateKey:void 0,this.config.localHostname=typeof t.localHostname=="string"?t.localHostname:void 0,this.config.localUsername=typeof t.localUsername=="string"?t.localUsername:void 0,this.config.tryKeyboard=t.tryKeyboard===!0,typeof t.agent=="string"&&t.agent.length?this.config.agent=Oa(t.agent):Fa(t.agent)?this.config.agent=t.agent:this.config.agent=void 0,this.config.allowAgentFwd=t.agentForward===!0&&this.config.agent!==void 0;let i=this.config.authHandler=typeof t.authHandler=="function"||Array.isArray(t.authHandler)?t.authHandler:void 0;this.config.strictVendor=typeof t.strictVendor=="boolean"?t.strictVendor:!0;let s=this.config.debug=typeof t.debug=="function"?t.debug:void 0;if(t.agentForward===!0&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");let o=this._callbacks=[];this._chanMgr=new il(this),this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._agent=this.config.agent?this.config.agent:void 0,this._remoteVer=void 0;let f;if(this.config.privateKey){if(f=wi(this.config.privateKey,t.passphrase),f instanceof Error)throw new Error(`Cannot parse privateKey: ${f.message}`);if(Array.isArray(f)&&(f=f[0]),f.getPrivatePEM()===null)throw new Error("privateKey value does not contain a (valid) private key")}let a;if(typeof t.hostVerifier=="function"){let k=t.hostVerifier,Q;Wu.indexOf(t.hostHash)!==-1&&(Q=Ou(t.hostHash)),a=(F,V)=>{Q&&(Q.update(F),F=Q.digest("hex"));let le=k(F,V);le!==void 0&&V(le)}}let h=this._sock=t.sock||new Mu,d=!1,l=!1;this._protocol&&this._protocol.cleanup();let H=s?(k,Q,F)=>{s(`Debug output from server: ${JSON.stringify(F)}`)}:void 0,g,I=this._protocol=new Ju({ident:this.config.ident,offer:r?void 0:e,onWrite:k=>{Ht(h)&&h.write(k)},onError:k=>{k.level==="handshake"&&clearTimeout(this._readyTimeout),I._destruct||h.removeAllListeners("data"),this.emit("error",k);try{h.end()}catch{}},onHeader:k=>{l=!0,this._remoteVer=k.versions.software,k.greeting&&this.emit("greeting",k.greeting)},onHandshakeComplete:k=>{this.emit("handshake",k),d||(d=!0,I.service("ssh-userauth"))},debug:s,hostVerifier:a,messageHandlers:{DEBUG:H,DISCONNECT:(k,Q,F)=>{if(Q!==Ta.BY_APPLICATION){F||(F=Xu[Q],F===void 0&&(F=`Unexpected disconnection reason: ${Q}`));let V=new Error(F);V.code=Q,this.emit("error",V)}h.end()},SERVICE_ACCEPT:(k,Q)=>{Q==="ssh-userauth"&&Y()},EXT_INFO:(k,Q)=>{if(g===void 0){for(let F of Q)if(F.name==="server-sig-algs"){g=F.algs;return}g=null}},USERAUTH_BANNER:(k,Q)=>{this.emit("banner",Q)},USERAUTH_SUCCESS:k=>{T(),clearTimeout(this._readyTimeout),this.emit("ready")},USERAUTH_FAILURE:(k,Q,F)=>{if(x.keyAlgos){let V=x.keyAlgos[0][0];if(s&&s(`Client: ${x.type} (${V}) auth failed`),x.keyAlgos.shift(),x.keyAlgos.length){let[le,He]=x.keyAlgos[0];switch(x.type){case"agent":I.authPK(x.username,x.agentCtx.currentKey(),le);return;case"publickey":I.authPK(x.username,x.key,le);return;case"hostbased":I.authHostbased(x.username,x.key,x.localHostname,x.localUsername,le,(Ae,st)=>{let St=x.key.sign(Ae,He);if(St instanceof Error)return St.message=`Error while signing with key: ${St.message}`,St.level="client-authentication",this.emit("error",St),Y();st(St)});return}}else x.keyAlgos=void 0}if(x.type==="agent"){let V=x.agentCtx.pos();return s&&s(`Client: Agent key #${V+1} failed`),te()}s&&s(`Client: ${x.type} auth failed`),S=F,R=Q,Y()},USERAUTH_PASSWD_CHANGEREQ:(k,Q)=>{x.type==="password"&&this.emit("change password",Q,F=>{I.authPassword(this.config.username,this.config.password,F)})},USERAUTH_PK_OK:k=>{let Q,F;if(x.keyAlgos&&([Q,F]=x.keyAlgos[0]),x.type==="agent"){let V=x.agentCtx.currentKey();I.authPK(x.username,V,Q,(le,He)=>{let Ae={hash:F};x.agentCtx.sign(V,le,Ae,(st,St)=>{if(st)st.level="agent",this.emit("error",st);else return He(St);te()})})}else x.type==="publickey"&&I.authPK(x.username,x.key,Q,(V,le)=>{let He=x.key.sign(V,F);if(He instanceof Error)return He.message=`Error signing data with key: ${He.message}`,He.level="client-authentication",this.emit("error",He),Y();le(He)})},USERAUTH_INFO_REQUEST:(k,Q,F,V)=>{if(x.type==="keyboard-interactive"){if((Array.isArray(V)?V.length:0)===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE"),I.authInfoRes();return}x.prompt(Q,F,"",V,He=>{I.authInfoRes(He)})}},REQUEST_SUCCESS:(k,Q)=>{o.length&&o.shift()(!1,Q)},REQUEST_FAILURE:k=>{o.length&&o.shift()(!0)},GLOBAL_REQUEST:(k,Q,F,V)=>{switch(Q){case"hostkeys-00@openssh.com":ul(this,V,(le,He)=>{le||this.emit("hostkeys",He)}),F&&I.requestSuccess();break;default:F&&I.requestFailure()}},CHANNEL_OPEN:(k,Q)=>{cl(this,Q)},CHANNEL_OPEN_CONFIRMATION:(k,Q)=>{let F=this._chanMgr.get(Q.recipient);if(typeof F!="function")return;let V=F.type==="sftp",He={type:V?"session":F.type,incoming:{id:Q.recipient,window:Li,packetSize:mi,state:"open"},outgoing:{id:Q.sender,window:Q.window,packetSize:Q.packetSize,state:"open"}},Ae=V?new el(this,He,{debug:s}):new Za(this,He);this._chanMgr.update(Q.recipient,Ae),F(void 0,Ae)},CHANNEL_OPEN_FAILURE:(k,Q,F,V)=>{let le=this._chanMgr.get(Q);if(typeof le!="function")return;sl(this,Q,{reason:F,description:V},le)},CHANNEL_DATA:(k,Q,F)=>{let V=this._chanMgr.get(Q);if(!(typeof V!="object"||V===null)&&V.incoming.window!==0){if(V.incoming.window-=F.length,V.push(F)===!1){V._waitChanDrain=!0;return}V.incoming.window<=Ma&&Qa(V)}},CHANNEL_EXTENDED_DATA:(k,Q,F,V)=>{if(V!==qu)return;let le=this._chanMgr.get(Q);if(!(typeof le!="object"||le===null)&&le.incoming.window!==0){if(le.incoming.window-=F.length,!le.stderr.push(F)){le._waitChanDrain=!0;return}le.incoming.window<=Ma&&Qa(le)}},CHANNEL_WINDOW_ADJUST:(k,Q,F)=>{let V=this._chanMgr.get(Q);typeof V!="object"||V===null||(V.outgoing.window+=F,V._waitWindow&&(V._waitWindow=!1,V._chunk?V._write(V._chunk,null,V._chunkcb):V._chunkcb?V._chunkcb():V._chunkErr?V.stderr._write(V._chunkErr,null,V._chunkcbErr):V._chunkcbErr&&V._chunkcbErr()))},CHANNEL_SUCCESS:(k,Q)=>{let F=this._chanMgr.get(Q);typeof F!="object"||F===null||(this._resetKA(),F._callbacks.length&&F._callbacks.shift()(!1))},CHANNEL_FAILURE:(k,Q)=>{let F=this._chanMgr.get(Q);typeof F!="object"||F===null||(this._resetKA(),F._callbacks.length&&F._callbacks.shift()(!0))},CHANNEL_REQUEST:(k,Q,F,V,le)=>{let He=this._chanMgr.get(Q);if(typeof He!="object"||He===null)return;let Ae=He._exit;if(Ae.code===void 0){switch(F){case"exit-status":He.emit("exit",Ae.code=le);return;case"exit-signal":He.emit("exit",Ae.code=null,Ae.signal=`SIG${le.signal}`,Ae.dump=le.coreDumped,Ae.desc=le.errorMessage);return}V&&k.channelFailure(He.outgoing.id)}},CHANNEL_EOF:(k,Q)=>{let F=this._chanMgr.get(Q);typeof F!="object"||F===null||F.incoming.state==="open"&&(F.incoming.state="eof",F.readable&&F.push(null),F.stderr.readable&&F.stderr.push(null))},CHANNEL_CLOSE:(k,Q)=>{ol(this,Q,this._chanMgr.get(Q))}}});h.pause();let b=this.config.keepaliveInterval,L=this.config.keepaliveCountMax,B=0,U,J=()=>{if(++B>L){if(clearInterval(U),h.readable){let k=new Error("Keepalive timeout");k.level="client-timeout",this.emit("error",k),h.destroy()}return}Ht(h)?(o.push(T),I.ping()):clearInterval(U)};function T(){b>0&&(B=0,clearInterval(U),Ht(h)&&(U=setInterval(J,b)))}this._resetKA=T;let Z=(()=>{let k=!1;return()=>{if(!k&&(k=!0,$&&!l)){let Q=tl("Connection lost before handshake","protocol",!0);this.emit("error",Q)}}})(),ee=(()=>{let k=!1;return()=>{k||(k=!0,$=!0,s&&s("Socket connected"),this.emit("connect"),zu.then(()=>{I.start(),h.on("data",Q=>{try{I.parse(Q,0,Q.length)}catch(F){this.emit("error",F);try{Ht(h)&&h.end()}catch{}}}),h.stderr&&typeof h.stderr.resume=="function"&&h.stderr.resume(),h.resume()}).catch(Q=>{this.emit("error",Q);try{Ht(h)&&h.end()}catch{}}))}})(),$=!1;h.on("connect",ee).on("timeout",()=>{this.emit("timeout")}).on("error",k=>{s&&s(`Socket error: ${k.message}`),clearTimeout(this._readyTimeout),k.level="client-socket",this.emit("error",k)}).on("end",()=>{s&&s("Socket ended"),Z(),I.cleanup(),clearTimeout(this._readyTimeout),clearInterval(U),this.emit("end")}).on("close",()=>{s&&s("Socket closed"),Z(),I.cleanup(),clearTimeout(this._readyTimeout),clearInterval(U),this.emit("close");let k=o;o=this._callbacks=[];let Q=new Error("No response from server");for(let F=0;F<k.length;++F)k[F](Q);this._chanMgr.cleanup(Q)});let x,S=null,R=null,M=["none"];this.config.password!==void 0&&M.push("password"),f!==void 0&&M.push("publickey"),this._agent!==void 0&&M.push("agent"),this.config.tryKeyboard&&M.push("keyboard-interactive"),f!==void 0&&this.config.localHostname!==void 0&&this.config.localUsername!==void 0&&M.push("hostbased"),Array.isArray(i)?i=Va(i):typeof i!="function"&&(i=Va(M));let O=!1,re=k=>{if(!O){if(O=!0,k===!1){let Q=new Error("All configured authentication methods failed");Q.level="client-authentication",this.emit("error",Q),this.end();return}if(typeof k=="string"){let Q=k;if(M.indexOf(Q)===-1)return z(`Authentication method not allowed: ${Q}`);let F=this.config.username;switch(Q){case"password":k={type:Q,username:F,password:this.config.password};break;case"publickey":k={type:Q,username:F,key:f};break;case"hostbased":k={type:Q,username:F,key:f,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":k={type:Q,username:F,agentCtx:new Ua(this._agent)};break;case"keyboard-interactive":k={type:Q,username:F,prompt:(...V)=>this.emit("keyboard-interactive",...V)};break;case"none":k={type:Q,username:F};break;default:return z(`Skipping unsupported authentication method: ${k}`)}}else{if(typeof k!="object"||k===null)return z(`Skipping invalid authentication attempt: ${k}`);{let Q=k.username;if(typeof Q!="string")return z(`Skipping invalid authentication attempt: ${k}`);let F=k.type;switch(F){case"password":{let{password:V}=k;if(typeof V!="string"&&!Buffer.isBuffer(V))return z("Skipping invalid password auth attempt");k={type:F,username:Q,password:V};break}case"publickey":{let V=wi(k.key,k.passphrase);if(V instanceof Error)return z("Skipping invalid key auth attempt");if(!V.isPrivateKey())return z("Skipping non-private key");k={type:F,username:Q,key:V};break}case"hostbased":{let{localHostname:V,localUsername:le}=k,He=wi(k.key,k.passphrase);if(He instanceof Error||typeof V!="string"||typeof le!="string")return z("Skipping invalid hostbased auth attempt");if(!He.isPrivateKey())return z("Skipping non-private key");k={type:F,username:Q,key:He,localHostname:V,localUsername:le};break}case"agent":{let V=k.agent;if(typeof V=="string"&&V.length)V=Oa(V);else if(!Fa(V))return z(`Skipping invalid agent: ${k.agent}`);k={type:F,username:Q,agentCtx:new Ua(V)};break}case"keyboard-interactive":{let{prompt:V}=k;if(typeof V!="function")return z("Skipping invalid keyboard-interactive auth attempt");k={type:F,username:Q,prompt:V};break}case"none":k={type:F,username:Q};break;default:return z(`Skipping unsupported authentication method: ${k}`)}}}x=k;try{let Q=x.username;switch(x.type){case"password":I.authPassword(Q,x.password);break;case"publickey":{let F;if(x.keyAlgos=Ao(this,x.key,g),x.keyAlgos)if(x.keyAlgos.length)F=x.keyAlgos[0][0];else return z("Skipping key authentication (no mutual hash algorithm)");I.authPK(Q,x.key,F);break}case"hostbased":{let F,V;if(x.keyAlgos=Ao(this,x.key,g),x.keyAlgos)if(x.keyAlgos.length)[F,V]=x.keyAlgos[0];else return z("Skipping hostbased authentication (no mutual hash algorithm)");I.authHostbased(Q,x.key,x.localHostname,x.localUsername,F,(le,He)=>{let Ae=x.key.sign(le,V);if(Ae instanceof Error)return Ae.message=`Error while signing with key: ${Ae.message}`,Ae.level="client-authentication",this.emit("error",Ae),Y();He(Ae)});break}case"agent":x.agentCtx.init(F=>{if(F)return F.level="agent",this.emit("error",F),Y();te()});break;case"keyboard-interactive":I.authKeyboard(Q);break;case"none":I.authNone(Q);break}}finally{O=!1}}};function z(k){s&&s(k),process.nextTick(Y)}function Y(){O=!1;let k=i(R,S,re);O||k===void 0||re(k)}let te=()=>{if(x.type==="agent"){let k=x.agentCtx.nextKey();if(k===!1)s&&s("Agent: No more keys left to try"),s&&s("Client: agent auth failed"),Y();else{let Q=x.agentCtx.pos(),F;if(x.keyAlgos=Ao(this,k,g),x.keyAlgos)if(x.keyAlgos.length)F=x.keyAlgos[0][0];else{s&&s(`Agent: Skipping key #${Q+1} (no mutual hash algorithm)`),te();return}s&&s(`Agent: Trying key #${Q+1}`),I.authPK(x.username,k,F)}}},ie=()=>{this.config.readyTimeout>0&&(this._readyTimeout=setTimeout(()=>{let k=new Error("Timed out while waiting for handshake");k.level="client-timeout",this.emit("error",k),h.destroy()},this.config.readyTimeout))};if(t.sock)ie(),typeof h.connecting=="boolean"&&h.connecting||ee();else{let k=this.config.host,Q=this.config.forceIPv4,F=this.config.forceIPv6;s&&s(`Client: Trying ${k} on port ${this.config.port} ...`);let V=()=>{ie(),h.connect({host:k,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort}),h.setMaxListeners(0),h.setTimeout(typeof t.timeout=="number"?t.timeout:0)};!Q&&!F||Q&&F?V():Gu(k,Q?4:6,(le,He,Ae)=>{if(le){let st=Q?"IPv4":"IPv6",St=new Error(`Error while looking up ${st} address for '${k}': ${le}`);clearTimeout(this._readyTimeout),St.level="client-dns",this.emit("error",St),this.emit("close");return}k=He,V()})}return this}end(){return this._sock&&Ht(this._sock)&&(this._protocol.disconnect(Ta.BY_APPLICATION),this._sock.end()),this}destroy(){return this._sock&&Ht(this._sock)&&this._sock.destroy(),this}exec(t,e,r){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");typeof e=="function"&&(r=e,e={});let i={allowHalfOpen:e.allowHalfOpen!==!1};return zn(this,"session",i,(s,o)=>{if(s){r(s);return}let f=[];function a(h){if(h){o.close(),r(h);return}f.length&&f.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&f.push(()=>Wa(o,a)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&qa(o,e.env),(typeof e.pty=="object"&&e.pty!==null||e.pty===!0)&&f.push(()=>Ka(o,e.pty,a)),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&f.push(()=>Ga(o,e.x11,a))),f.push(()=>al(o,t,e,r)),f.shift()()}),this}shell(t,e,r){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");return typeof t=="function"?(r=t,t=e=void 0):typeof e=="function"&&(r=e,e=void 0),t&&(t.x11!==void 0||t.env!==void 0)&&(e=t,t=void 0),zn(this,"session",(i,s)=>{if(i){r(i);return}let o=[];function f(a){if(a){s.close(),r(a);return}o.length&&o.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&o.push(()=>Wa(s,f)),t!==!1&&o.push(()=>Ka(s,t,f)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&qa(s,e.env),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&o.push(()=>Ga(s,e.x11,f))),o.push(()=>fl(s,r)),o.shift()()}),this}subsys(t,e){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");return zn(this,"session",(r,i)=>{if(r){e(r);return}Xa(i,t,(s,o)=>{if(s){e(s);return}e(void 0,o)})}),this}forwardIn(t,e,r){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push((s,o)=>{if(s){r(s!==!0?s:new Error(`Unable to bind to ${t}:${e}`));return}let f=e;e===0&&o&&o.length>=4&&(f=nl(o,0),this._protocol._compatFlags&$a.DYN_RPORT_BUG||(e=f)),this._forwarding[`${t}:${e}`]=f,r(void 0,f)}),this._protocol.tcpipForward(t,e,i),this}unforwardIn(t,e,r){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push(s=>{if(s){r(s!==!0?s:new Error(`Unable to unbind from ${t}:${e}`));return}delete this._forwarding[`${t}:${e}`],r()}),this._protocol.cancelTcpipForward(t,e,i),this}forwardOut(t,e,r,i,s){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let o={srcIP:t,srcPort:e,dstIP:r,dstPort:i};return typeof s!="function"&&(s=_o),zn(this,"direct-tcpip",o,s),this}openssh_noMoreSessions(t){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let e=typeof t=="function";return!this.config.strictVendor||this.config.strictVendor&&vr.test(this._remoteVer)?(e&&this._callbacks.push(r=>{if(r){t(r!==!0?r:new Error("Unable to disable future sessions"));return}t()}),this._protocol.openssh_noMoreSessions(e),this):e?(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardInStreamLocal(t,e){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&vr.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to bind to ${t}`));return}this._forwardingUnix[t]=!0,e()}),this._protocol.openssh_streamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_unforwardInStreamLocal(t,e){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&vr.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to unbind from ${t}`));return}delete this._forwardingUnix[t],e()}),this._protocol.openssh_cancelStreamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardOutStreamLocal(t,e){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");return typeof e!="function"&&(e=_o),!this.config.strictVendor||this.config.strictVendor&&vr.test(this._remoteVer)?(zn(this,"direct-streamlocal@openssh.com",{socketPath:t},e),this):(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this)}sftp(t){if(!this._sock||!Ht(this._sock))throw new Error("Not connected");return zn(this,"sftp",(e,r)=>{if(e){t(e);return}Xa(r,"sftp",(i,s)=>{if(i){t(i);return}function o(){r.removeListener("ready",f),r.removeListener("error",a),r.removeListener("exit",h),r.removeListener("close",h)}function f(){o(),t(void 0,r)}function a(d){o(),t(d)}function h(d,l){o();let H;typeof d=="number"?H=`Received exit code ${d} while establishing SFTP session`:l!==void 0?H=`Received signal ${l} while establishing SFTP session`:H="Received unexpected SFTP session termination";let g=new Error(H);g.code=d,g.signal=l,t(g)}r.on("ready",f).on("error",a).on("exit",h).on("close",h),r._init()})}),this}setNoDelay(t){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(t),this}};function zn(n,t,e,r){let i=Li,s=mi;typeof e=="function"&&(r=e,e={});let o=(a,h)=>{r(a,h)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"session":case"sftp":n._protocol.session(f,i,s);break;case"direct-tcpip":n._protocol.directTcpip(f,i,s,e);break;case"direct-streamlocal@openssh.com":n._protocol.openssh_directStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function Ga(n,t,e){let r={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.single=="boolean"&&(r.single=t.single),typeof t.screen=="number"&&(r.screen=t.screen),typeof t.protocol=="string"&&(r.protocol=t.protocol),typeof t.cookie=="string"?r.cookie=t.cookie:Buffer.isBuffer(t.cookie)&&(r.cookie=t.cookie.hexSlice(0,t.cookie.length))),r.cookie===void 0&&(r.cookie=hl());let i=typeof e=="function";if(n.outgoing.state!=="open"){i&&e(new Error("Channel is not open"));return}i&&n._callbacks.push(s=>{if(s){e(s!==!0?s:new Error("Unable to request X11"));return}n._hasX11=!0,++n._client._acceptX11,n.once("close",()=>{n._client._acceptX11&&--n._client._acceptX11}),e()}),n._client._protocol.x11Forward(n.outgoing.id,r,i)}function Ka(n,t,e){let r=24,i=80,s=640,o=480,f="vt100",a=null;typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.rows=="number"&&(r=t.rows),typeof t.cols=="number"&&(i=t.cols),typeof t.width=="number"&&(s=t.width),typeof t.height=="number"&&(o=t.height),typeof t.term=="string"&&(f=t.term),typeof t.modes=="object"&&(a=t.modes));let h=typeof e=="function";if(n.outgoing.state!=="open"){h&&e(new Error("Channel is not open"));return}h&&n._callbacks.push(d=>{if(d){e(d!==!0?d:new Error("Unable to request a pseudo-terminal"));return}e()}),n._client._protocol.pty(n.outgoing.id,r,i,o,s,f,a,h)}function Wa(n,t){let e=typeof t=="function";if(n.outgoing.state!=="open"){e&&t(new Error("Channel is not open"));return}if(n._client._agentFwdEnabled){e&&t(!1);return}n._client._agentFwdEnabled=!0,n._callbacks.push(r=>{if(r){n._client._agentFwdEnabled=!1,e&&t(r!==!0?r:new Error("Unable to request agent forwarding"));return}e&&t()}),n._client._protocol.openssh_agentForward(n.outgoing.id,!0)}function fl(n,t){if(n.outgoing.state!=="open"){t(new Error("Channel is not open"));return}n._callbacks.push(e=>{if(e){t(e!==!0?e:new Error("Unable to open shell"));return}n.subtype="shell",t(void 0,n)}),n._client._protocol.shell(n.outgoing.id,!0)}function al(n,t,e,r){if(n.outgoing.state!=="open"){r(new Error("Channel is not open"));return}n._callbacks.push(i=>{if(i){r(i!==!0?i:new Error("Unable to exec"));return}n.subtype="exec",n.allowHalfOpen=e.allowHalfOpen!==!1,r(void 0,n)}),n._client._protocol.exec(n.outgoing.id,t,!0)}function qa(n,t){if(n.outgoing.state!=="open")return;let e=Object.keys(t||{});for(let r=0;r<e.length;++r){let i=e[r],s=t[i];n._client._protocol.env(n.outgoing.id,i,s,!1)}}function Xa(n,t,e){if(n.outgoing.state!=="open"){e(new Error("Channel is not open"));return}n._callbacks.push(r=>{if(r){e(r!==!0?r:new Error(`Unable to start subsystem: ${t}`));return}n.subtype="subsystem",e(void 0,n)}),n._client._protocol.subsystem(n.outgoing.id,t,!0)}function cl(n,t){let e=-1,r,i=()=>{let a={type:t.type,incoming:{id:e,window:Li,packetSize:mi,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},h=new Za(n,a);return n._chanMgr.update(e,h),n._protocol.channelOpenConfirm(t.sender,e,Li,mi),h},s=()=>{r===void 0&&(e===-1?r=kr.RESOURCE_SHORTAGE:r=kr.CONNECT_FAILED),e!==-1&&n._chanMgr.remove(e),n._protocol.channelOpenFail(t.sender,r,"")},o=()=>(e=n._chanMgr.add(),e===-1&&(r=kr.RESOURCE_SHORTAGE,n.config.debug&&n.config.debug("Client: Automatic rejection of incoming channel open: no channels available")),e!==-1),f=t.data;switch(t.type){case"forwarded-tcpip":{let a=n._forwarding[`${f.destIP}:${f.destPort}`];if(a!==void 0&&o()){f.destPort===0&&(f.destPort=a),n.emit("tcp connection",f,i,s);return}break}case"forwarded-streamlocal@openssh.com":if(n._forwardingUnix[f.socketPath]!==void 0&&o()){n.emit("unix connection",f,i,s);return}break;case"auth-agent@openssh.com":if(n._agentFwdEnabled&&typeof n._agent.getStream=="function"&&o()){n._agent.getStream((a,h)=>{if(a)return s();let d=i();d.pipe(h).pipe(d)});return}break;case"x11":if(n._acceptX11!==0&&o()){n.emit("x11",f,i,s);return}break;default:r=kr.UNKNOWN_CHANNEL_TYPE,n.config.debug&&n.config.debug(`Client: Automatic rejection of unsupported incoming channel open type: ${t.type}`)}r===void 0&&(r=kr.ADMINISTRATIVELY_PROHIBITED,n.config.debug&&n.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)),s()}var hl=(()=>{let n=Buffer.allocUnsafe(16);return()=>(Qu(n,0,16),n.hexSlice(0,16))})();function Va(n){if(!Array.isArray(n))throw new Error("authList must be an array");let t=0;return(e,r,i)=>t===n.length?!1:n[t++]}function ul(n,t,e){if(!n._sock||!Ht(n._sock))return;if(typeof e!="function"&&(e=_o),!Array.isArray(t))throw new TypeError("Invalid keys argument type");let r=[];for(let i of t){let s=wi(i);if(s instanceof Error)throw s;r.push(s)}if(!n.config.strictVendor||n.config.strictVendor&&vr.test(n._remoteVer)){n._callbacks.push((i,s)=>{if(i){e(i!==!0?i:new Error("Server failed to prove supplied keys"));return}let o=[],f=0;for(yi.init(s,0);yi.avail()&&f!==r.length;){let a=r[f++],h=a.getPublicSSH(),d=yi.readString();Ci.init(d,0);let l=Ci.readString(!0),H=Ci.readString(),g;if(l!==a.type)if(a.type==="ssh-rsa")switch(l){case"rsa-sha2-256":g="sha256";break;case"rsa-sha2-512":g="sha512";break;default:continue}else continue;let I=n._protocol._kex.sessionID,b=Buffer.allocUnsafe(37+I.length+4+h.length),L=0;lo(b,29,L),b.utf8Write("hostkeys-prove-00@openssh.com",L+=4,29),lo(b,I.length,L+=29),Pa(I,b,0,I.length,L+=4),lo(b,h.length,L+=I.length),Pa(h,b,0,h.length,L+=4),(H=rl(H,l))&&a.verify(b,H,g)===!0&&o.push(a)}Ci.clear(),yi.clear(),e(null,o)}),n._protocol.openssh_hostKeysProve(r);return}process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}function Ao(n,t,e){switch(t.type){case"ssh-rsa":if(n._protocol._compatFlags&$a.IMPLY_RSA_SHA2_SIGALGS&&(Array.isArray(e)?e=["rsa-sha2-256","rsa-sha2-512",...e]:e=["rsa-sha2-256","rsa-sha2-512"]),Array.isArray(e)){if(e.indexOf("rsa-sha2-256")!==-1)return[["rsa-sha2-256","sha256"]];if(e.indexOf("rsa-sha2-512")!==-1)return[["rsa-sha2-512","sha512"]];if(e.indexOf("ssh-rsa")===-1)return[]}return[["ssh-rsa","sha1"]]}}ja.exports=Ho});var Ja=je(za=>{"use strict";var{Agent:po}=require("http"),{Agent:ll}=require("https"),{connect:dl}=require("tls"),go;for(let n of[po,ll]){class t extends n{constructor(r,i){super(i),this._connectCfg=r,this._defaultSrcIP=i&&i.srcIP||"localhost"}createConnection(r,i){let s=r&&r.localAddress||this._defaultSrcIP,o=r&&r.localPort||0,f=r.host,a=r.port;go===void 0&&(go=Eo());let h=new go,d=!1;h.on("ready",()=>{h.forwardOut(s,o,f,a,(l,H)=>{if(d=!0,l)return h.end(),i(l);H.once("close",()=>h.end()),i(null,Al(H,n,r))})}).on("error",i).on("close",()=>{d||i(new Error("Unexpected connection close"))}).connect(this._connectCfg)}}za[n===po?"SSHTTPAgent":"SSHTTPSAgent"]=t}function Dr(){}function Al(n,t,e){if(t===po)return n.setKeepAlive=Dr,n.setNoDelay=Dr,n.setTimeout=Dr,n.ref=Dr,n.unref=Dr,n.destroySoon=n.destroy,n;e.socket=n;let r=dl(e),i=(()=>{let s=!1;return()=>{s||(s=!0,n.isPaused()&&n.resume())}})();return r.on("end",i).on("close",i),r}});var tc=je(($d,So)=>{"use strict";var{Server:_l}=require("net"),Pr=require("events"),{listenerCount:mt}=Pr,{CHANNEL_OPEN_FAILURE:Jn,DEFAULT_CIPHER:Hl,DEFAULT_COMPRESSION:El,DEFAULT_KEX:gl,DEFAULT_MAC:pl,DEFAULT_SERVER_HOST_KEY:Il,DISCONNECT_REASON:er,DISCONNECT_REASON_BY_VALUE:bl,SUPPORTED_CIPHER:xl,SUPPORTED_COMPRESSION:Sl,SUPPORTED_KEX:yl,SUPPORTED_MAC:Cl,SUPPORTED_SERVER_HOST_KEY:wl}=nn(),{init:Ll}=un(),{KexInit:ml}=ui(),{parseKey:ec}=An(),Nl=Xs(),{SFTP:Bl}=mr(),{writeUInt32BE:kl}=Wt(),{Channel:tr,MAX_WINDOW:En,PACKET_SIZE:gn,windowAdjust:Rl,WINDOW_THRESHOLD:vl}=ao(),{ChannelManager:Dl,generateAlgorithmList:Tr,isWritable:Ni,onChannelOpenFailure:Tl,onCHANNEL_CLOSE:Pl}=uo(),Ul=10,pn=class extends Pr{constructor(t,e,r,i,s){super(),this.username=this.user=e,this.service=r,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=(o,f,a)=>{this._finalResponse||(this._finalResponse=!0,s(this,o,f,a))},this._protocol=t}accept(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)}reject(t,e){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,t,e)}},Bi=class extends pn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._multistep=!0,this._cb=void 0,this._onInfoResponse=f=>{let a=this._cb;a&&(this._cb=void 0,a(f))},this.submethods=s,this.on("abort",()=>{this._cb&&this._cb(new Error("Authentication request aborted"))})}prompt(t,e,r,i){Array.isArray(t)||(t=[t]),typeof e=="function"?(i=e,e=r=void 0):typeof r=="function"?(i=r,r=void 0):typeof i!="function"&&(i=void 0);for(let s=0;s<t.length;++s)typeof t[s]=="string"&&(t[s]={prompt:t[s],echo:!0});this._cb=i,this._initialResponse=!0,this._protocol.authInfoReq(e,r,t)}},bo=class extends pn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob}accept(){this.signature?pn.prototype.accept.call(this):(this._initialResponse=!0,this._protocol.authPKOK(this.key.algo,this.key.data))}},xo=class extends pn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.hashAlgo=s.hashAlgo,this.signature=s.signature,this.blob=s.blob,this.localHostname=s.localHostname,this.localUsername=s.localUsername}},ki=class extends pn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.password=s,this._changeCb=void 0}requestChange(t,e){if(this._changeCb)throw new Error("Change request already in progress");if(typeof t!="string")throw new Error("prompt argument must be a string");if(typeof e!="function")throw new Error("Callback argument must be a function");this._changeCb=e,this._protocol.authPasswdChg(t)}},jt=class extends Pr{constructor(t,e,r){super(),this.type="session",this.subtype=void 0,this.server=!0,this._ending=!1,this._channel=void 0,this._chanInfo={type:"session",incoming:{id:r,window:En,packetSize:gn,state:"open"},outgoing:{id:e.sender,window:e.window,packetSize:e.packetSize,state:"open"}}}},Ot=class extends Pr{constructor(t,e){if(super(),typeof t!="object"||t===null)throw new Error("Missing configuration object");let r=Object.create(null),i=[],s=t.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");let o=typeof t.algorithms=="object"&&t.algorithms!==null?t.algorithms:{},f=Tr(o.serverHostKey,Il,wl);for(let H=0;H<s.length;++H){let g;if(Buffer.isBuffer(s[H])||typeof s[H]=="string"?g=ec(s[H]):g=ec(s[H].key,s[H].passphrase),g instanceof Error)throw new Error(`Cannot parse privateKey: ${g.message}`);if(Array.isArray(g)&&(g=g[0]),g.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(!i.includes(g.type))if(g.type==="ssh-rsa"){let I=f.indexOf("ssh-rsa"),b=f.indexOf("rsa-sha2-256"),L=f.indexOf("rsa-sha2-512");I===-1&&(I=1/0),[I,b,L].sort(Ol).forEach(B=>{if(B===-1)return;let U;switch(B){case I:U="ssh-rsa";break;case b:U="rsa-sha2-256";break;case L:U="rsa-sha2-512";break;default:return}r[U]=g,i.push(U)})}else r[g.type]=g,i.push(g.type)}let a={kex:Tr(o.kex,gl,yl).concat(["kex-strict-s-v00@openssh.com"]),serverHostKey:i,cs:{cipher:Tr(o.cipher,Hl,xl),mac:Tr(o.hmac,pl,Cl),compress:Tr(o.compress,El,Sl),lang:[]},sc:void 0};a.sc=a.cs,typeof e=="function"&&this.on("connection",e);let h=typeof t.debug=="function"?t.debug:void 0,d=t.ident?Buffer.from(t.ident):void 0,l=new ml(a);this._srv=new _l(H=>{if(this._connections>=this.maxConnections){H.destroy();return}++this._connections,H.once("close",()=>{--this._connections});let g;if(h){let I=`[${process.hrtime().join(".")}] `;g=b=>{h(`${I}${b}`)}}new Ri(H,r,d,l,g,this,t)}).on("error",H=>{this.emit("error",H)}).on("listening",()=>{this.emit("listening")}).on("close",()=>{this.emit("close")}),this._connections=0,this.maxConnections=1/0}injectSocket(t){this._srv.emit("connection",t)}listen(...t){return this._srv.listen(...t),this}address(){return this._srv.address()}getConnections(t){return this._srv.getConnections(t),this}close(t){return this._srv.close(t),this}ref(){return this._srv.ref(),this}unref(){return this._srv.unref(),this}};Ot.KEEPALIVE_CLIENT_INTERVAL=15e3;Ot.KEEPALIVE_CLIENT_COUNT_MAX=3;var Ri=class extends Pr{constructor(t,e,r,i,s,o,f){super();let a=0,h=!1,d=[],l,H,g,I=[];this._sock=t,this._chanMgr=new Dl(this),this._debug=s,this.noMoreSessions=!1,this.authenticated=!1;function b($){}this.on("error",b);let L=s?($,x,S)=>{s(`Debug output from client: ${JSON.stringify(S)}`)}:void 0,B=typeof f.keepaliveInterval=="number"&&isFinite(f.keepaliveInterval)&&f.keepaliveInterval>0?f.keepaliveInterval:typeof Ot.KEEPALIVE_CLIENT_INTERVAL=="number"&&isFinite(Ot.KEEPALIVE_CLIENT_INTERVAL)&&Ot.KEEPALIVE_CLIENT_INTERVAL>0?Ot.KEEPALIVE_CLIENT_INTERVAL:-1,U=typeof f.keepaliveCountMax=="number"&&isFinite(f.keepaliveCountMax)&&f.keepaliveCountMax>=0?f.keepaliveCountMax:typeof Ot.KEEPALIVE_CLIENT_COUNT_MAX=="number"&&isFinite(Ot.KEEPALIVE_CLIENT_COUNT_MAX)&&Ot.KEEPALIVE_CLIENT_COUNT_MAX>=0?Ot.KEEPALIVE_CLIENT_COUNT_MAX:-1,J=0;B!==-1&&U!==-1&&(this.once("ready",()=>{let $=()=>{clearInterval(H)};this.on("close",$).on("end",$),H=setInterval(()=>{if(++J>U){clearInterval(H);let x=new Error("Keepalive timeout");x.level="client-timeout",this.emit("error",x),this.end()}else T.ping()},B)}),g=()=>{H&&H.refresh(),J=0});let T=this._protocol=new Nl({server:!0,hostKeys:e,ident:r,offer:i,onPacket:g,greeting:f.greeting,banner:f.banner,onWrite:$=>{Ni(t)&&t.write($)},onError:$=>{T._destruct||t.removeAllListeners("data"),this.emit("error",$);try{t.end()}catch{}},onHeader:$=>{this.removeListener("error",b);let x={ip:t.remoteAddress,family:t.remoteFamily,port:t.remotePort,header:$};if(!o.emit("connection",this,x)){T.disconnect(er.BY_APPLICATION),t.end();return}$.greeting&&this.emit("greeting",$.greeting)},onHandshakeComplete:$=>{++a>1&&this.emit("rekey"),this.emit("handshake",$)},debug:s,messageHandlers:{DEBUG:L,DISCONNECT:($,x,S)=>{if(x!==er.BY_APPLICATION){S||(S=bl[x],S===void 0&&(S=`Unexpected disconnection reason: ${x}`));let R=new Error(S);R.code=x,this.emit("error",R)}t.end()},CHANNEL_OPEN:($,x)=>{if(x.type==="session"&&this.noMoreSessions||!this.authenticated){let te=Jn.ADMINISTRATIVELY_PROHIBITED;return T.channelOpenFail(x.sender,te)}let S=-1,R,M=!1,O,re=()=>{M||(M=!0,R===void 0&&(S===-1?R=Jn.RESOURCE_SHORTAGE:R=Jn.CONNECT_FAILED),S!==-1&&this._chanMgr.remove(S),T.channelOpenFail(x.sender,R,""))},z=()=>(S=this._chanMgr.add(),S===-1&&(R=Jn.RESOURCE_SHORTAGE,s&&s("Automatic rejection of incoming channel open: no channels available")),S!==-1),Y=x.data;switch(x.type){case"session":if(mt(this,"session")&&z()){O=()=>{if(M)return;M=!0;let te=new jt(this,x,S);return this._chanMgr.update(S,te),T.channelOpenConfirm(x.sender,S,En,gn),te},this.emit("session",O,re);return}break;case"direct-tcpip":if(mt(this,"tcpip")&&z()){O=()=>{if(M)return;M=!0;let te={type:void 0,incoming:{id:S,window:En,packetSize:gn,state:"open"},outgoing:{id:x.sender,window:x.window,packetSize:x.packetSize,state:"open"}},ie=new tr(this,te,{server:!0});return this._chanMgr.update(S,ie),T.channelOpenConfirm(x.sender,S,En,gn),ie},this.emit("tcpip",O,re,Y);return}break;case"direct-streamlocal@openssh.com":if(mt(this,"openssh.streamlocal")&&z()){O=()=>{if(M)return;M=!0;let te={type:void 0,incoming:{id:S,window:En,packetSize:gn,state:"open"},outgoing:{id:x.sender,window:x.window,packetSize:x.packetSize,state:"open"}},ie=new tr(this,te,{server:!0});return this._chanMgr.update(S,ie),T.channelOpenConfirm(x.sender,S,En,gn),ie},this.emit("openssh.streamlocal",O,re,Y);return}break;default:R=Jn.UNKNOWN_CHANNEL_TYPE,s&&s(`Automatic rejection of unsupported incoming channel open type: ${x.type}`)}R===void 0&&(R=Jn.ADMINISTRATIVELY_PROHIBITED,s&&s(`Automatic rejection of unexpected incoming channel open for: ${x.type}`)),re()},CHANNEL_OPEN_CONFIRMATION:($,x)=>{let S=this._chanMgr.get(x.recipient);if(typeof S!="function")return;let R={type:S.type,incoming:{id:x.recipient,window:En,packetSize:gn,state:"open"},outgoing:{id:x.sender,window:x.window,packetSize:x.packetSize,state:"open"}},M=new tr(this,R,{server:!0});this._chanMgr.update(x.recipient,M),S(void 0,M)},CHANNEL_OPEN_FAILURE:($,x,S,R)=>{let M=this._chanMgr.get(x);if(typeof M!="function")return;Tl(this,x,{reason:S,description:R},M)},CHANNEL_DATA:($,x,S)=>{let R=this._chanMgr.get(x);if(!(typeof R!="object"||R===null)&&!(R.constructor===jt&&(R=R._channel,!R))&&R.incoming.window!==0){if(R.incoming.window-=S.length,R.push(S)===!1){R._waitChanDrain=!0;return}R.incoming.window<=vl&&Rl(R)}},CHANNEL_EXTENDED_DATA:($,x,S,R)=>{},CHANNEL_WINDOW_ADJUST:($,x,S)=>{let R=this._chanMgr.get(x);typeof R!="object"||R===null||R.constructor===jt&&(R=R._channel,!R)||(R.outgoing.window+=S,R._waitWindow&&(R._waitWindow=!1,R._chunk?R._write(R._chunk,null,R._chunkcb):R._chunkcb?R._chunkcb():R._chunkErr?R.stderr._write(R._chunkErr,null,R._chunkcbErr):R._chunkcbErr&&R._chunkcbErr()))},CHANNEL_SUCCESS:($,x)=>{let S=this._chanMgr.get(x);typeof S!="object"||S===null||S.constructor===jt&&(S=S._channel,!S)||S._callbacks.length&&S._callbacks.shift()(!1)},CHANNEL_FAILURE:($,x)=>{let S=this._chanMgr.get(x);typeof S!="object"||S===null||S.constructor===jt&&(S=S._channel,!S)||S._callbacks.length&&S._callbacks.shift()(!0)},CHANNEL_REQUEST:($,x,S,R,M)=>{let O=this._chanMgr.get(x);if(typeof O!="object"||O===null)return;let re=!1,z,Y;if(O.constructor!==jt){R&&T.channelFailure(O.outgoing.id);return}if(R&&(S!=="shell"&&S!=="exec"&&S!=="subsystem"&&(z=()=>{re||O._ending||O._channel||(re=!0,T.channelSuccess(O._chanInfo.outgoing.id))}),Y=()=>{re||O._ending||O._channel||(re=!0,T.channelFailure(O._chanInfo.outgoing.id))}),O._ending){Y&&Y();return}switch(S){case"env":if(mt(O,"env")){O.emit("env",z,Y,{key:M.name,val:M.value});return}break;case"pty-req":if(mt(O,"pty")){O.emit("pty",z,Y,M);return}break;case"window-change":mt(O,"window-change")?O.emit("window-change",z,Y,M):Y&&Y();break;case"x11-req":if(mt(O,"x11")){O.emit("x11",z,Y,M);return}break;case"signal":if(mt(O,"signal")){O.emit("signal",z,Y,{name:M});return}break;case"auth-agent-req@openssh.com":if(mt(O,"auth-agent")){O.emit("auth-agent",z,Y);return}break;case"shell":if(mt(O,"shell")){z=()=>{if(re||O._ending||O._channel)return;re=!0,R&&T.channelSuccess(O._chanInfo.outgoing.id);let te=new tr(this,O._chanInfo,{server:!0});return te.subtype=O.subtype=S,O._channel=te,te},O.emit("shell",z,Y);return}break;case"exec":if(mt(O,"exec")){z=()=>{if(re||O._ending||O._channel)return;re=!0,R&&T.channelSuccess(O._chanInfo.outgoing.id);let te=new tr(this,O._chanInfo,{server:!0});return te.subtype=O.subtype=S,O._channel=te,te},O.emit("exec",z,Y,{command:M});return}break;case"subsystem":{let te=M==="sftp";if(z=()=>{if(re||O._ending||O._channel)return;re=!0,R&&T.channelSuccess(O._chanInfo.outgoing.id);let ie;return te?ie=new Bl(this,O._chanInfo,{server:!0,debug:s}):(ie=new tr(this,O._chanInfo,{server:!0}),ie.subtype=O.subtype=`${S}:${M}`),O._channel=ie,ie},M==="sftp"){if(mt(O,"sftp")){O.emit("sftp",z,Y);return}te=!1}if(mt(O,"subsystem")){O.emit("subsystem",z,Y,{name:M});return}break}}s&&s(`Automatic rejection of incoming channel request: ${S}`),Y&&Y()},CHANNEL_EOF:($,x)=>{let S=this._chanMgr.get(x);typeof S!="object"||S===null||S.constructor===jt&&(S._ending||(S._ending=!0,S.emit("eof"),S.emit("end")),S=S._channel,!S)||S.incoming.state==="open"&&(S.incoming.state="eof",S.readable&&S.push(null))},CHANNEL_CLOSE:($,x)=>{let S=this._chanMgr.get(x);typeof S!="object"||S===null||S.constructor===jt&&(S._ending=!0,S.emit("close"),S=S._channel,!S)||Pl(this,x,S)},SERVICE_REQUEST:($,x)=>{if(a===0||h||this.authenticated||x!=="ssh-userauth"){T.disconnect(er.SERVICE_NOT_AVAILABLE),t.end();return}h=!0,T.serviceAccept(x)},USERAUTH_REQUEST:($,x,S,R,M)=>{if(a===0||this.authenticated||l&&(l.username!==x||l.service!==S)||R!=="password"&&R!=="publickey"&&R!=="hostbased"&&R!=="keyboard-interactive"&&R!=="none"||d.length===Ul){T.disconnect(er.PROTOCOL_ERROR),t.end();return}else if(S!=="ssh-connection"){T.disconnect(er.SERVICE_NOT_AVAILABLE),t.end();return}let O;switch(R){case"keyboard-interactive":O=new Bi(T,x,S,R,M,Z);break;case"publickey":O=new bo(T,x,S,R,M,Z);break;case"hostbased":O=new xo(T,x,S,R,M,Z);break;case"password":if(l&&l instanceof ki&&l._changeCb){let re=l._changeCb;l._changeCb=void 0,re(M.newPassword);return}O=new ki(T,x,S,R,M,Z);break;case"none":O=new pn(T,x,S,R,Z);break}if(l)if(l._initialResponse)l._multistep&&!l._finalResponse&&(l._cleanup&&l._cleanup(),l.emit("abort"));else return d.push(O);l=O,mt(this,"authentication")?this.emit("authentication",l):l.reject()},USERAUTH_INFO_RESPONSE:($,x)=>{l&&l instanceof Bi&&l._onInfoResponse(x)},GLOBAL_REQUEST:($,x,S,R)=>{let M={type:null,buf:null};function O(re,z){M.type=re,M.buf=z,ee()}if(S&&I.push(M),(x==="tcpip-forward"||x==="cancel-tcpip-forward"||x==="no-more-sessions@openssh.com"||x==="streamlocal-forward@openssh.com"||x==="cancel-streamlocal-forward@openssh.com")&&mt(this,"request")&&this.authenticated){let re,z;if(S){let Y=!1;re=te=>{if(Y)return;Y=!0;let ie;x==="tcpip-forward"&&R.bindPort===0&&typeof te=="number"&&(ie=Buffer.allocUnsafe(4),kl(ie,te,0)),O("SUCCESS",ie)},z=()=>{Y||(Y=!0,O("FAILURE"))}}if(x==="no-more-sessions@openssh.com"){this.noMoreSessions=!0,re&&re();return}this.emit("request",re,z,x,R)}else S&&O("FAILURE")}}});t.pause(),Ll.then(()=>{T.start(),t.on("data",$=>{try{T.parse($,0,$.length)}catch(x){this.emit("error",x);try{Ni(t)&&t.end()}catch{}}}),t.resume()}).catch($=>{this.emit("error",$);try{Ni(t)&&t.end()}catch{}}),t.on("error",$=>{$.level="socket",this.emit("error",$)}).once("end",()=>{s&&s("Socket ended"),T.cleanup(),this.emit("end")}).once("close",()=>{s&&s("Socket closed"),T.cleanup(),this.emit("close");let $=new Error("No response from server");this._chanMgr.cleanup($)});let Z=($,x,S,R)=>{l===$&&!this.authenticated&&(x?(l=void 0,this.authenticated=!0,T.authSuccess(),d=[],this.emit("ready")):(T.authFailure(S,R),d.length&&(l=d.pop(),mt(this,"authentication")?this.emit("authentication",l):l.reject())))};function ee(){for(;I.length>0&&I[0].type;){let $=I.shift();$.type==="SUCCESS"&&T.requestSuccess($.buf),$.type==="FAILURE"&&T.requestFailure()}}}end(){return this._sock&&Ni(this._sock)&&(this._protocol.disconnect(er.BY_APPLICATION),this._sock.end()),this}x11(t,e,r){return Io(this,"x11",{originAddr:t,originPort:e},r),this}forwardOut(t,e,r,i,s){return Io(this,"forwarded-tcpip",{boundAddr:t,boundPort:e,remoteAddr:r,remotePort:i},s),this}openssh_forwardOutStreamLocal(t,e){return Io(this,"forwarded-streamlocal@openssh.com",{socketPath:t},e),this}rekey(t){let e;try{this._protocol.rekey()}catch(r){e=r}typeof t=="function"&&(e?process.nextTick(t,e):this.once("rekey",t))}setNoDelay(t){return this._sock&&typeof this._sock.setNoDelay=="function"&&this._sock.setNoDelay(t),this}};function Io(n,t,e,r){let i=En,s=gn;typeof e=="function"&&(r=e,e={});let o=(a,h)=>{r(a,h)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":n._protocol.forwardedTcpip(f,i,s,e);break;case"x11":n._protocol.x11(f,i,s,e);break;case"forwarded-streamlocal@openssh.com":n._protocol.openssh_forwardedStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function Ol(n,t){return n-t}So.exports=Ot;So.exports.IncomingClient=Ri});var oc=je((Yd,sc)=>{"use strict";var{createCipheriv:Fl,generateKeyPair:Ql,generateKeyPairSync:Ml,getCurves:Gl,randomBytes:nc}=require("crypto"),{Ber:ft}=cr(),Kl=Ki().pbkdf,{CIPHER_INFO:Wl}=un(),ql=16,Xl=16,Vl=Gl(),$l=new Map(Object.entries(Wl));function rc(n,t){if(typeof n!="string")throw new TypeError("Key type must be a string");let e={type:"spki",format:"der"},r={type:"pkcs8",format:"der"};switch(n.toLowerCase()){case"rsa":{if(typeof t!="object"||t===null)throw new TypeError("Missing options object for RSA key");let i=t.bits;if(!Number.isInteger(i))throw new TypeError("RSA bits must be an integer");if(i<=0||i>16384)throw new RangeError("RSA bits must be non-zero and <= 16384");return["rsa",{modulusLength:i,publicKeyEncoding:e,privateKeyEncoding:r}]}case"ecdsa":{if(typeof t!="object"||t===null)throw new TypeError("Missing options object for ECDSA key");if(!Number.isInteger(t.bits))throw new TypeError("ECDSA bits must be an integer");let i;switch(t.bits){case 256:i="prime256v1";break;case 384:i="secp384r1";break;case 521:i="secp521r1";break;default:throw new Error("ECDSA bits must be 256, 384, or 521")}if(!Vl.includes(i))throw new Error("Unsupported ECDSA bits value");return["ec",{namedCurve:i,publicKeyEncoding:e,privateKeyEncoding:r}]}case"ed25519":return["ed25519",{publicKeyEncoding:e,privateKeyEncoding:r}];default:throw new Error(`Unsupported key type: ${n}`)}}function Yl(n,t,e){switch(n){case"rsa":{let r=new ft.Reader(e);if(r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in RSA private key");if(r.readSequence(),r.readOID()!=="1.2.840.113549.1.1.1")throw new Error("Bad RSA private OID");if(r.readByte()!==ft.Null)throw new Error("Malformed RSA private key (expected null)");if(r.readByte()!==0)throw new Error("Malformed RSA private key (expected zero-length null)");if(r=new ft.Reader(r.readString(ft.OctetString,!0)),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in RSA private key");let i=r.readString(ft.Integer,!0),s=r.readString(ft.Integer,!0),o=r.readString(ft.Integer,!0),f=r.readString(ft.Integer,!0),a=r.readString(ft.Integer,!0);r.readString(ft.Integer,!0),r.readString(ft.Integer,!0);let h=r.readString(ft.Integer,!0),d=Buffer.from("ssh-rsa"),l=Buffer.allocUnsafe(4+d.length+4+i.length+4+s.length+4+o.length+4+h.length+4+f.length+4+a.length),H=0;l.writeUInt32BE(d.length,H+=0),l.set(d,H+=4),l.writeUInt32BE(i.length,H+=d.length),l.set(i,H+=4),l.writeUInt32BE(s.length,H+=i.length),l.set(s,H+=4),l.writeUInt32BE(o.length,H+=s.length),l.set(o,H+=4),l.writeUInt32BE(h.length,H+=o.length),l.set(h,H+=4),l.writeUInt32BE(f.length,H+=h.length),l.set(f,H+=4),l.writeUInt32BE(a.length,H+=f.length),l.set(a,H+=4);let g=Buffer.allocUnsafe(4+d.length+4+s.length+4+i.length);return H=0,g.writeUInt32BE(d.length,H+=0),g.set(d,H+=4),g.writeUInt32BE(s.length,H+=d.length),g.set(s,H+=4),g.writeUInt32BE(i.length,H+=s.length),g.set(i,H+=4),{sshName:d.toString(),priv:l,pub:g}}case"ec":{let r=new ft.Reader(t);if(r.readSequence(),r.readSequence(),r.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA public OID");r.readOID();let i=r.readString(ft.BitString,!0);{let H=0;for(;H<i.length&&i[H]===0;++H);H>0&&(i=i.slice(H))}if(r=new ft.Reader(e),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in ECDSA private key");if(r.readSequence(),r.readOID()!=="1.2.840.10045.2.1")throw new Error("Bad ECDSA private OID");let s=r.readOID(),o;switch(s){case"1.2.840.10045.3.1.7":o="nistp256";break;case"1.3.132.0.34":o="nistp384";break;case"1.3.132.0.35":o="nistp521";break;default:throw new Error("Unsupported curve in ECDSA private key")}if(r=new ft.Reader(r.readString(ft.OctetString,!0)),r.readSequence(),r.readInt()!==1)throw new Error("Unsupported version in ECDSA private key");let f=Buffer.concat([Buffer.from([0]),r.readString(ft.OctetString,!0)]),a=Buffer.from(`ecdsa-sha2-${o}`);o=Buffer.from(o);let h=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length+4+f.length),d=0;h.writeUInt32BE(a.length,d+=0),h.set(a,d+=4),h.writeUInt32BE(o.length,d+=a.length),h.set(o,d+=4),h.writeUInt32BE(i.length,d+=o.length),h.set(i,d+=4),h.writeUInt32BE(f.length,d+=i.length),h.set(f,d+=4);let l=Buffer.allocUnsafe(4+a.length+4+o.length+4+i.length);return d=0,l.writeUInt32BE(a.length,d+=0),l.set(a,d+=4),l.writeUInt32BE(o.length,d+=a.length),l.set(o,d+=4),l.writeUInt32BE(i.length,d+=o.length),l.set(i,d+=4),{sshName:a.toString(),priv:h,pub:l}}case"ed25519":{let r=new ft.Reader(t);if(r.readSequence(),r.readSequence(),r.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 public OID");let i=r.readString(ft.BitString,!0);{let d=0;for(;d<i.length&&i[d]===0;++d);d>0&&(i=i.slice(d))}if(r=new ft.Reader(e),r.readSequence(),r.readInt()!==0)throw new Error("Unsupported version in ED25519 private key");if(r.readSequence(),r.readOID()!=="1.3.101.112")throw new Error("Bad ED25519 private OID");r=new ft.Reader(r.readString(ft.OctetString,!0));let s=r.readString(ft.OctetString,!0),o=Buffer.from("ssh-ed25519"),f=Buffer.allocUnsafe(4+o.length+4+i.length+4+(s.length+i.length)),a=0;f.writeUInt32BE(o.length,a+=0),f.set(o,a+=4),f.writeUInt32BE(i.length,a+=o.length),f.set(i,a+=4),f.writeUInt32BE(s.length+i.length,a+=i.length),f.set(s,a+=4),f.set(i,a+=s.length);let h=Buffer.allocUnsafe(4+o.length+4+i.length);return a=0,h.writeUInt32BE(o.length,a+=0),h.set(o,a+=4),h.writeUInt32BE(i.length,a+=o.length),h.set(i,a+=4),{sshName:o.toString(),priv:f,pub:h}}}}function ic(n,t,e,r){let i="new",s,o="";if(typeof r=="object"&&r!==null&&(typeof r.comment=="string"&&r.comment&&(o=r.comment),typeof r.format=="string"&&r.format&&(i=r.format),r.passphrase)){let f;if(typeof r.passphrase=="string")f=Buffer.from(r.passphrase);else if(Buffer.isBuffer(r.passphrase))f=r.passphrase;else throw new Error("Invalid passphrase");if(r.cipher===void 0)throw new Error("Missing cipher name");let a=$l.get(r.cipher);if(a===void 0)throw new Error("Invalid cipher name");if(i==="new"){let h=Xl;if(r.rounds!==void 0){if(!Number.isInteger(r.rounds))throw new TypeError("rounds must be an integer");r.rounds>0&&(h=r.rounds)}let d=Buffer.allocUnsafe(a.keyLen+a.ivLen),l=nc(ql);if(Kl(f,f.length,l,l.length,d,d.length,h)!==0)return new Error("Failed to generate information to encrypt key");let g=Buffer.allocUnsafe(4+l.length+4);{let I=0;g.writeUInt32BE(l.length,I+=0),g.set(l,I+=4),g.writeUInt32BE(h,I+=l.length)}s={cipher:a,cipherName:r.cipher,kdfName:"bcrypt",kdfOptions:g,key:d.slice(0,a.keyLen),iv:d.slice(a.keyLen)}}}switch(i){case"new":{let f=`-----BEGIN OPENSSH PRIVATE KEY-----
`,a,h=Buffer.from(s?s.cipherName:"none"),d=Buffer.from(s?s.kdfName:"none"),l=s?s.kdfOptions:Buffer.alloc(0),H=s?s.cipher.blockLen:8,g=Yl(n,t,e),I=nc(4),b=Buffer.from(o),L=8+g.priv.length+4+b.length,B=[];for(let ee=1;(L+B.length)%H;++ee)B.push(ee&255);B=Buffer.from(B);let U=Buffer.allocUnsafe(L+B.length),J;{let ee=0;U.set(I,ee+=0),U.set(I,ee+=4),U.set(g.priv,ee+=4),U.writeUInt32BE(b.length,ee+=g.priv.length),U.set(b,ee+=4),U.set(B,ee+=b.length)}if(s){let ee={authTagLength:s.cipher.authLen},$=Fl(s.cipher.sslName,s.key,s.iv,ee);$.setAutoPadding(!1),U=Buffer.concat([$.update(U),$.final()]),s.cipher.authLen>0?J=$.getAuthTag():J=Buffer.alloc(0),s.key.fill(0),s.iv.fill(0)}else J=Buffer.alloc(0);let T=Buffer.from("openssh-key-v1\0"),Z=Buffer.allocUnsafe(T.length+4+h.length+4+d.length+4+l.length+4+4+g.pub.length+4+U.length+J.length);{let ee=0;Z.set(T,ee+=0),Z.writeUInt32BE(h.length,ee+=T.length),Z.set(h,ee+=4),Z.writeUInt32BE(d.length,ee+=h.length),Z.set(d,ee+=4),Z.writeUInt32BE(l.length,ee+=d.length),Z.set(l,ee+=4),Z.writeUInt32BE(1,ee+=l.length),Z.writeUInt32BE(g.pub.length,ee+=4),Z.set(g.pub,ee+=4),Z.writeUInt32BE(U.length,ee+=g.pub.length),Z.set(U,ee+=4),Z.set(J,ee+=U.length)}{let ee=Z.base64Slice(0,Z.length),$=ee.replace(/.{64}/g,`$&
`);ee.length&63&&($+=`
`),f+=$}{let ee=g.pub.base64Slice(0,g.pub.length);a=`${g.sshName} ${ee}${o?` ${o}`:""}`}return f+=`-----END OPENSSH PRIVATE KEY-----
`,{private:f,public:a}}default:throw new Error("Invalid output key format")}}function Zl(){}sc.exports={generateKeyPair:(n,t,e)=>{typeof t=="function"&&(e=t,t=void 0),typeof e!="function"&&(e=Zl);let r=rc(n,t);Ql(...r,(i,s,o)=>{if(i)return e(i);let f;try{f=ic(r[0],s,o,t)}catch(a){return e(a)}e(null,f)})},generateKeyPairSync:(n,t)=>{let e=rc(n,t),{publicKey:r,privateKey:i}=Ml(...e);return ic(e[0],r,i,t)}}});var ac=je((Zd,fc)=>{"use strict";var{AgentProtocol:jl,BaseAgent:zl,createAgent:Jl,CygwinAgent:ed,OpenSSHAgent:td,PageantAgent:nd}=ks(),{SSHTTPAgent:rd,SSHTTPSAgent:id}=Ja(),{parseKey:sd}=An(),{flagsToString:od,OPEN_MODE:fd,STATUS_CODE:ad,stringToFlags:cd}=mr();fc.exports={AgentProtocol:jl,BaseAgent:zl,createAgent:Jl,Client:Eo(),CygwinAgent:ed,HTTPAgent:rd,HTTPSAgent:id,OpenSSHAgent:td,PageantAgent:nd,Server:tc(),utils:{parseKey:sd,...oc(),sftp:{flagsToString:od,OPEN_MODE:fd,STATUS_CODE:ad,stringToFlags:cd}}}});var hd=require("net"),{Client:ud}=ac(),jd=require("os");function ld(n,t){t.on("close",()=>{n.getConnections((e,r)=>{r===0&&n.close()})})}async function cc(n){let t=Object.assign({},n);return!t.port&&!t.path&&(t=null),new Promise((e,r)=>{let i=hd.createServer(),s=function(o){r(o)};i.on("error",s),process.on("uncaughtException",s),i.listen(t),i.on("listening",()=>{process.removeListener("uncaughtException",s),e(i)})})}async function hc(n){return new Promise(function(t,e){let r=new ud;r.on("ready",()=>t(r)),r.on("error",e),r.connect(n)})}async function dd(n,t,e,r){let i=Object.assign({port:22,username:"root"},e),s=Object.assign({dstAddr:"0.0.0.0"},r),o=Object.assign({autoClose:!1,reconnectOnError:!1},n||{}),f,a;return new Promise(async function(h,d){try{a=await hc(i),l(a)}catch(I){return f&&f.close(),d(I)}try{f=await cc(t),H(f)}catch(I){return d(I)}function l(I){o.reconnectOnError&&I.on("error",async()=>{I.isBroken=!0,I=await hc(i),l(I)})}function H(I){o.reconnectOnError&&I.on("error",async()=>{I=await cc(t),H(I)}),I.on("connection",g),I.on("close",()=>a.end())}function g(I){s.srcPort||(s.srcPort=f.address().port),s.srcAddr||(s.srcAddr=f.address().address),o.autoClose&&ld(f,I),!a.isBroken&&a.forwardOut(s.srcAddr,s.srcPort,s.dstAddr,s.dstPort,(b,L)=>{b?(f&&f.close(),a.emit("error",b)):I.pipe(L).pipe(I)})}h([f,a])})}exports.createTunnel=dd;
