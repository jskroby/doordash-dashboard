"use strict";var d=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var M=d((Mc,ss)=>{var mn=()=>`${process.platform}-${process.arch}`,yn=i=>{switch(i){case"linux-x64":return require("@duckdb/node-bindings-linux-x64/duckdb.node");case"linux-arm64":return require("@duckdb/node-bindings-linux-arm64/duckdb.node");case"darwin-arm64":return require("@duckdb/node-bindings-darwin-arm64/duckdb.node");case"darwin-x64":return require("@duckdb/node-bindings-darwin-x64/duckdb.node");case"win32-x64":return require("@duckdb/node-bindings-win32-x64/duckdb.node");default:let[t,e]=i.split("-");throw new Error(`Error loading duckdb native binding: unsupported arch '${e}' for platform '${t}'`)}};ss.exports=yn(mn())});var W=d(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.DuckDBTypeId=void 0;var ns;(function(i){i[i.INVALID=0]="INVALID",i[i.BOOLEAN=1]="BOOLEAN",i[i.TINYINT=2]="TINYINT",i[i.SMALLINT=3]="SMALLINT",i[i.INTEGER=4]="INTEGER",i[i.BIGINT=5]="BIGINT",i[i.UTINYINT=6]="UTINYINT",i[i.USMALLINT=7]="USMALLINT",i[i.UINTEGER=8]="UINTEGER",i[i.UBIGINT=9]="UBIGINT",i[i.FLOAT=10]="FLOAT",i[i.DOUBLE=11]="DOUBLE",i[i.TIMESTAMP=12]="TIMESTAMP",i[i.DATE=13]="DATE",i[i.TIME=14]="TIME",i[i.INTERVAL=15]="INTERVAL",i[i.HUGEINT=16]="HUGEINT",i[i.UHUGEINT=32]="UHUGEINT",i[i.VARCHAR=17]="VARCHAR",i[i.BLOB=18]="BLOB",i[i.DECIMAL=19]="DECIMAL",i[i.TIMESTAMP_S=20]="TIMESTAMP_S",i[i.TIMESTAMP_MS=21]="TIMESTAMP_MS",i[i.TIMESTAMP_NS=22]="TIMESTAMP_NS",i[i.ENUM=23]="ENUM",i[i.LIST=24]="LIST",i[i.STRUCT=25]="STRUCT",i[i.MAP=26]="MAP",i[i.ARRAY=33]="ARRAY",i[i.UUID=27]="UUID",i[i.UNION=28]="UNION",i[i.BIT=29]="BIT",i[i.TIME_TZ=30]="TIME_TZ",i[i.TIMESTAMP_TZ=31]="TIMESTAMP_TZ",i[i.ANY=34]="ANY",i[i.VARINT=35]="VARINT",i[i.SQLNULL=36]="SQLNULL"})(ns||(se.DuckDBTypeId=ns={}))});var ae=d(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.quotedString=pn;ne.quotedIdentifier=Dn;function pn(i){return`'${i.replace("'","''")}'`}function Dn(i){return`"${i.replace('"','""')}"`}});var bt=d(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.displayStringForDuckDBValue=gn;var Tn=ae();function gn(i){return i==null?"NULL":typeof i=="string"?(0,Tn.quotedString)(i):i.toString()}});var as=d(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.DuckDBArrayValue=void 0;Mt.arrayValue=_n;var wn=bt(),ue=class{items;constructor(t){this.items=t}toString(){return`[${this.items.map(wn.displayStringForDuckDBValue).join(", ")}]`}};Mt.DuckDBArrayValue=ue;function _n(i){return new ue(i)}});var us=d(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.DuckDBBitValue=void 0;St.bitValue=In;var ce=class i{data;constructor(t){this.data=t}padding(){return this.data[0]}get length(){return(this.data.length-1)*8-this.padding()}getBool(t){let e=t+this.padding(),r=Math.floor(e/8)+1;return(this.data[r]>>7-e%8&1)!==0}toBools(){let t=[],e=this.length;for(let r=0;r<e;r++)t.push(this.getBool(r));return t}getBit(t){return this.getBool(t)?1:0}toBits(){let t=[],e=this.length;for(let r=0;r<e;r++)t.push(this.getBit(r));return t}toString(){let t=this.length,e=Array.from({length:t});for(let r=0;r<t;r++)e[r]=this.getBool(r)?"1":"0";return e.join("")}static fromString(t,e="1"){return i.fromLengthAndPredicate(t.length,r=>t[r]===e)}static fromBits(t,e=1){return i.fromLengthAndPredicate(t.length,r=>t[r]===e)}static fromBools(t){return i.fromLengthAndPredicate(t.length,e=>t[e])}static fromLengthAndPredicate(t,e){let r=Math.ceil(t/8)+1,s=(8-t%8)%8,n=new Uint8Array(r),u=0;n[u++]=s;let o=0,g=0;for(;g<s;)o<<=1,o|=1,g++;let j=0;for(;u<r;){for(;g<8;)o<<=1,e(j++)&&(o|=1),g++;n[u++]=o,o=0,g=0}return new i(n)}};St.DuckDBBitValue=ce;function In(i){return ce.fromString(i)}});var cs=d(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.bytesFromString=Vn;var Bn=new TextEncoder;function Vn(i){return Bn.encode(i)}});var os=d(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.stringFromBlob=kn;function kn(i){let t=[];for(let e of i)e<=31||e===34||e===39||e>=127?t.push(`\\x${e.toString(16).toUpperCase().padStart(2,"0")}`):t.push(String.fromCharCode(e));return t.join("")}});var ls=d(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.DuckDBBlobValue=void 0;Nt.blobValue=Mn;var vn=cs(),bn=os(),Et=class i{bytes;constructor(t){this.bytes=t}toString(){return(0,bn.stringFromBlob)(this.bytes)}static fromString(t){return new i(Buffer.from((0,vn.bytesFromString)(t)))}};Nt.DuckDBBlobValue=Et;function Mn(i){return typeof i=="string"?Et.fromString(i):new Et(i)}});var x=d(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.getDuckDBDateStringFromYearMonthDay=fs;R.getDuckDBDateStringFromDays=cr;R.getTimezoneOffsetString=ms;R.getAbsoluteOffsetStringFromParts=ys;R.getOffsetStringFromAbsoluteSeconds=ps;R.getOffsetStringFromSeconds=Rn;R.getDuckDBTimeStringFromParts=Ds;R.getDuckDBTimeStringFromPartsNS=Ts;R.getDuckDBTimeStringFromPositiveMicroseconds=or;R.getDuckDBTimeStringFromPositiveNanoseconds=gs;R.getDuckDBTimeStringFromMicrosecondsInDay=ws;R.getDuckDBTimeStringFromNanosecondsInDay=_s;R.getDuckDBTimeStringFromMicroseconds=Is;R.getDuckDBTimestampStringFromDaysAndMicroseconds=Bs;R.getDuckDBTimestampStringFromDaysAndNanoseconds=Vs;R.getDuckDBTimestampStringFromMicroseconds=lr;R.getDuckDBTimestampStringFromSeconds=Cn;R.getDuckDBTimestampStringFromMilliseconds=Ln;R.getDuckDBTimestampStringFromNanoseconds=On;R.getDuckDBIntervalString=Un;var ds=146097,Sn=864e5,de=1000000n,En=1000n,hs=1000000000n,At=60n,he=60n,oe=86400000000n,le=86400000000000n,Nn=-9223372036854775807n,An=9223372036854775807n;function fs(i,t,e){let r=String(Math.abs(i)).padStart(4,"0"),s=String(t).padStart(2,"0"),n=String(e).padStart(2,"0");return`${r}-${s}-${n}${i<0?" (BC)":""}`}function cr(i){let t=Math.abs(i),e=i<0?-1:1,r=Math.floor(t/ds),s=e*r*400,n=t%ds,u=e*n*Sn,o=new Date(u),g=s+o.getUTCFullYear();g<0&&g--;let j=o.getUTCMonth()+1,K=o.getUTCDate();return fs(g,j,K)}function ms(i){if(i===void 0)return;let t=i<0,e=Math.abs(i),r=e%60,s=Math.floor(e/60),n=r!==0?String(r).padStart(2,"0"):"",u=String(s).padStart(2,"0");return`${t?"-":"+"}${u}${n?`:${n}`:""}`}function ys(i,t,e){let r=String(i).padStart(2,"0"),s=t!==0||e!==0?String(t).padStart(2,"0"):"",n=e!==0?String(e).padStart(2,"0"):"",u=r;return s&&(u+=`:${s}`,n&&(u+=`:${n}`)),u}function ps(i){let t=i%60,e=Math.floor(i/60),r=e%60,s=Math.floor(e/60);return ys(s,r,t)}function Rn(i){let t=i<0,e=t?-i:i,r=ps(e);return`${t?"-":"+"}${r}`}function Ds(i,t,e,r){let s=String(i).padStart(2,"0"),n=String(t).padStart(2,"0"),u=String(e).padStart(2,"0"),o=String(r).padStart(6,"0").replace(/0+$/,"");return`${s}:${n}:${u}${o.length>0?`.${o}`:""}`}function Ts(i,t,e,r){let s=String(i).padStart(2,"0"),n=String(t).padStart(2,"0"),u=String(e).padStart(2,"0"),o=String(r).padStart(9,"0").replace(/0+$/,"");return`${s}:${n}:${u}${o.length>0?`.${o}`:""}`}function or(i){let t=i%de,e=i/de,r=e%At,s=e/At,n=s%he,u=s/he;return Ds(u,n,r,t)}function gs(i){let t=i%hs,e=i/hs,r=e%At,s=e/At,n=s%he,u=s/he;return Ts(u,n,r,t)}function ws(i){let t=i<0?i+oe:i;return or(t)}function _s(i){let t=i<0?i+le:i;return gs(t)}function Is(i){let t=i<0,e=t?-i:i,r=or(e);return t?`-${r}`:r}function Bs(i,t,e){let r=cr(Number(i)),s=ws(t);return`${r} ${s}${e??""}`}function Vs(i,t){let e=cr(Number(i)),r=_s(t);return`${e} ${r}`}function lr(i,t){if(i===Nn)return"-infinity";if(i===An)return"infinity";let e=t!==void 0?i+BigInt(t)*de*At:i,r=e/oe,s=e%oe;return s<0&&(r--,s+=oe),Bs(r,s,ms(t))}function Cn(i){return lr(i*de)}function Ln(i){return lr(i*En)}function On(i){let t=i/le,e=i%le;return e<0&&(t--,e+=le),Vs(t,e)}function ur(i,t){return`${i} ${t}${Math.abs(i)!==1?"s":""}`}function Un(i,t,e){let r=[];if(i!==0){let s=i<0?-1:1,n=Math.abs(i),u=Math.floor(n/12),o=s*u,g=s*(n-u*12);o!==0&&r.push(ur(o,"year")),g!==0&&r.push(ur(g,"month"))}return t!==0&&r.push(ur(t,"day")),e!==0n&&r.push(Is(e)),r.length>0?r.join(" "):"00:00:00"}});var ks=d(X=>{"use strict";var Pn=X&&X.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(X,"__esModule",{value:!0});X.DuckDBDateValue=void 0;X.dateValue=qn;var dr=Pn(M()),Fn=x(),fe=class i{days;constructor(t){this.days=t}get isFinite(){return dr.default.is_finite_date(this)}toString(){return(0,Fn.getDuckDBDateStringFromDays)(this.days)}toParts(){return dr.default.from_date(this)}static fromParts(t){return new i(dr.default.to_date(t).days)}static Epoch=new i(0);static Max=new i(2**31-2);static Min=new i(-(2**31-2));static PosInf=new i(2**31-1);static NegInf=new i(-(2**31-1))};X.DuckDBDateValue=fe;function qn(i){return new fe(i)}});var vs=d(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.stringFromDecimal=Gn;function jn(i){return new Intl.NumberFormat(i,{useGrouping:!1}).formatToParts(.1).find(e=>e.type==="decimal")?.value??"."}var hr={};function xn(i){let t=JSON.stringify(i);if(t in hr)return hr[t];let e=jn(i);return hr[t]=e,e}function $n(i,t){if(i){let{minimumFractionDigits:e,maximumFractionDigits:r,...s}=i.options??{};return t.toLocaleString(i?.locales,s)}return String(t)}function Yn(i,t,e){let r=String(t).padStart(e,"0");if(!i)return r;let s=i?.options?.minimumFractionDigits??0,n=i?.options?.maximumFractionDigits??20;return r.padEnd(s,"0").slice(0,n)}function Gn(i,t,e){if(t>0){let r=BigInt(10)**BigInt(t),s=i<0?-i:i,n=i<0?"-":"",u=s/r,o=$n(e,u),g=s%r,j=Yn(e,g,t),K=e?xn(e.locales):".";return`${n}${o}${K}${j}`}return e?i.toLocaleString(e?.locales,e?.options):String(i)}});var Ms=d(tt=>{"use strict";var Zn=tt&&tt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(tt,"__esModule",{value:!0});tt.DuckDBDecimalValue=void 0;tt.decimalValue=Hn;var bs=Zn(M()),zn=vs(),me=class i{width;scale;value;constructor(t,e,r){this.width=e,this.scale=r,this.value=t}toString(){return(0,zn.stringFromDecimal)(this.value,this.scale)}toDouble(){return bs.default.decimal_to_double(this)}static fromDouble(t,e,r){let s=bs.default.double_to_decimal(t,e,r);return new i(s.value,s.width,s.scale)}};tt.DuckDBDecimalValue=me;function Hn(i,t,e){return new me(i,t,e)}});var Ss=d(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.DuckDBIntervalValue=void 0;Rt.intervalValue=Qn;var Jn=x(),ye=class{months;days;micros;constructor(t,e,r){this.months=t,this.days=e,this.micros=r}toString(){return(0,Jn.getDuckDBIntervalString)(this.months,this.days,this.micros)}};Rt.DuckDBIntervalValue=ye;function Qn(i,t,e){return new ye(i,t,e)}});var Es=d(Ct=>{"use strict";Object.defineProperty(Ct,"__esModule",{value:!0});Ct.DuckDBListValue=void 0;Ct.listValue=Wn;var Kn=bt(),pe=class{items;constructor(t){this.items=t}toString(){return`[${this.items.map(Kn.displayStringForDuckDBValue).join(", ")}]`}};Ct.DuckDBListValue=pe;function Wn(i){return new pe(i)}});var As=d(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.DuckDBMapValue=void 0;Lt.mapValue=Xn;var Ns=bt(),De=class{entries;constructor(t){this.entries=t}toString(){return`{${this.entries.map(({key:t,value:e})=>`${(0,Ns.displayStringForDuckDBValue)(t)}: ${(0,Ns.displayStringForDuckDBValue)(e)}`).join(", ")}}`}};Lt.DuckDBMapValue=De;function Xn(i){return new De(i)}});var Cs=d(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.DuckDBStructValue=void 0;Ot.structValue=ta;var Rs=bt(),Te=class{entries;constructor(t){this.entries=t}toString(){let t=[];for(let e in this.entries)t.push(`${(0,Rs.displayStringForDuckDBValue)(e)}: ${(0,Rs.displayStringForDuckDBValue)(this.entries[e])}`);return`{${t.join(", ")}}`}};Ot.DuckDBStructValue=Te;function ta(i){return new Te(i)}});var mr=d(et=>{"use strict";var ea=et&&et.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(et,"__esModule",{value:!0});et.DuckDBTimestampSecondsValue=void 0;et.timestampSecondsValue=sa;var ia=ea(M()),ra=x(),ge=class i{seconds;constructor(t){this.seconds=t}get isFinite(){return ia.default.is_finite_timestamp_s(this)}toString(){return(0,ra.getDuckDBTimestampStringFromSeconds)(this.seconds)}static Epoch=new i(0n);static Max=new i(9223372036854n);static Min=new i(-9223372022400n);static PosInf=new i(2n**63n-1n);static NegInf=new i(-(2n**63n-1n))};et.DuckDBTimestampSecondsValue=ge;function sa(i){return new ge(i)}});var yr=d(it=>{"use strict";var na=it&&it.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(it,"__esModule",{value:!0});it.DuckDBTimestampMillisecondsValue=void 0;it.timestampMillisValue=oa;var aa=na(M()),ua=x(),ca=mr(),we=class i{millis;constructor(t){this.millis=t}get isFinite(){return aa.default.is_finite_timestamp_ms(this)}toString(){return(0,ua.getDuckDBTimestampStringFromMilliseconds)(this.millis)}static Epoch=new i(0n);static Max=new i((2n**63n-2n)/1000n);static Min=new i(ca.DuckDBTimestampSecondsValue.Min.seconds*1000n);static PosInf=new i(2n**63n-1n);static NegInf=new i(-(2n**63n-1n))};it.DuckDBTimestampMillisecondsValue=we;function oa(i){return new we(i)}});var Ls=d(rt=>{"use strict";var la=rt&&rt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(rt,"__esModule",{value:!0});rt.DuckDBTimestampNanosecondsValue=void 0;rt.timestampNanosValue=fa;var da=la(M()),ha=x(),_e=class i{nanos;constructor(t){this.nanos=t}get isFinite(){return da.default.is_finite_timestamp_ns(this)}toString(){return(0,ha.getDuckDBTimestampStringFromNanoseconds)(this.nanos)}static Epoch=new i(0n);static Max=new i(2n**63n-2n);static Min=new i(-9223286400000000000n);static PosInf=new i(2n**63n-1n);static NegInf=new i(-(2n**63n-1n))};rt.DuckDBTimestampNanosecondsValue=_e;function fa(i){return new _e(i)}});var Dr=d(Y=>{"use strict";var ma=Y&&Y.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Y,"__esModule",{value:!0});Y.DuckDBTimestampMicrosecondsValue=Y.DuckDBTimestampValue=void 0;Y.timestampValue=Da;var pr=ma(M()),ya=x(),pa=yr(),Ut=class i{micros;constructor(t){this.micros=t}get isFinite(){return pr.default.is_finite_timestamp(this)}toString(){return(0,ya.getDuckDBTimestampStringFromMicroseconds)(this.micros)}toParts(){return pr.default.from_timestamp(this)}static fromParts(t){return new i(pr.default.to_timestamp(t).micros)}static Epoch=new i(0n);static Max=new i(2n**63n-2n);static Min=new i(pa.DuckDBTimestampMillisecondsValue.Min.millis*1000n);static PosInf=new i(2n**63n-1n);static NegInf=new i(-(2n**63n-1n))};Y.DuckDBTimestampValue=Ut;Y.DuckDBTimestampMicrosecondsValue=Ut;function Da(i){return new Ut(i)}});var Os=d(st=>{"use strict";var Ta=st&&st.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(st,"__esModule",{value:!0});st.DuckDBTimestampTZValue=void 0;st.timestampTZValue=wa;var Tr=Ta(M()),ga=x(),Ie=Dr(),Be=class i{static timezoneOffsetInMinutes=-new Date().getTimezoneOffset();micros;constructor(t){this.micros=t}get isFinite(){return Tr.default.is_finite_timestamp(this)}toString(){return(0,ga.getDuckDBTimestampStringFromMicroseconds)(this.micros,i.timezoneOffsetInMinutes)}toParts(){return Tr.default.from_timestamp(this)}static fromParts(t){return new i(Tr.default.to_timestamp(t).micros)}static Epoch=new i(0n);static Max=new i(Ie.DuckDBTimestampValue.Max.micros);static Min=new i(Ie.DuckDBTimestampValue.Min.micros);static PosInf=new i(Ie.DuckDBTimestampValue.PosInf.micros);static NegInf=new i(Ie.DuckDBTimestampValue.NegInf.micros)};st.DuckDBTimestampTZValue=Be;function wa(i){return new Be(i)}});var Fs=d(nt=>{"use strict";var _a=nt&&nt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(nt,"__esModule",{value:!0});nt.DuckDBTimeTZValue=void 0;nt.timeTZValue=Ia;var Us=_a(M()),Ps=x(),Ve=class i{bits;micros;offset;constructor(t,e,r){this.bits=t,this.micros=e,this.offset=r}toString(){return`${(0,Ps.getDuckDBTimeStringFromMicrosecondsInDay)(this.micros)}${(0,Ps.getOffsetStringFromSeconds)(this.offset)}`}toParts(){return Us.default.from_time_tz(this)}static TimeBits=40;static OffsetBits=24;static MaxOffset=16*60*60-1;static MinOffset=-i.MaxOffset;static MaxMicros=24n*60n*60n*1000n*1000n;static MinMicros=0n;static fromBits(t){let e=BigInt.asUintN(i.TimeBits,t>>BigInt(i.OffsetBits)),r=i.MaxOffset-Number(BigInt.asUintN(i.OffsetBits,t));return new i(t,e,r)}static fromMicrosAndOffset(t,e){let r=BigInt.asUintN(i.TimeBits,t)<<BigInt(i.OffsetBits)|BigInt.asUintN(i.OffsetBits,BigInt(i.MaxOffset-e));return new i(r,t,e)}static fromParts(t){return i.fromMicrosAndOffset(Us.default.to_time(t.time).micros,t.offset)}static Max=i.fromMicrosAndOffset(i.MaxMicros,i.MinOffset);static Min=i.fromMicrosAndOffset(i.MinMicros,i.MaxOffset)};nt.DuckDBTimeTZValue=Ve;function Ia(i,t){return Ve.fromMicrosAndOffset(i,t)}});var js=d(at=>{"use strict";var Ba=at&&at.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(at,"__esModule",{value:!0});at.DuckDBTimeValue=void 0;at.timeValue=ka;var qs=Ba(M()),Va=x(),ke=class i{micros;constructor(t){this.micros=t}toString(){return(0,Va.getDuckDBTimeStringFromMicrosecondsInDay)(this.micros)}toParts(){return qs.default.from_time(this)}static fromParts(t){return new i(qs.default.to_time(t).micros)}static Max=new i(24n*60n*60n*1000n*1000n);static Min=new i(0n)};at.DuckDBTimeValue=ke;function ka(i){return new ke(i)}});var xs=d(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.DuckDBUnionValue=void 0;Pt.unionValue=va;var ve=class{tag;value;constructor(t,e){this.tag=t,this.value=e}toString(){return this.value==null?"NULL":this.value.toString()}};Pt.DuckDBUnionValue=ve;function va(i,t){return new ve(i,t)}});var $s=d(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.DuckDBUUIDValue=void 0;Ft.uuidValue=ba;var be=class i{hugeint;constructor(t){this.hugeint=t}toUint128(){return(this.hugeint^0x80000000000000000000000000000000n)&0xffffffffffffffffffffffffffffffffn}toString(){let t=(this.toUint128()|0x100000000000000000000000000000000n).toString(16);return`${t.substring(1,9)}-${t.substring(9,13)}-${t.substring(13,17)}-${t.substring(17,21)}-${t.substring(21,33)}`}static fromUint128(t){return new i((t^0x80000000000000000000000000000000n)&0xffffffffffffffffffffffffffffffffn)}static fromStoredHugeInt(t){return new i(t)}static Max=new i(2n**127n-1n);static Min=new i(-(2n**127n))};Ft.DuckDBUUIDValue=be;function ba(i){return be.fromUint128(i)}});var Gs=d(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0})});var ut=d(E=>{"use strict";var Ma=E&&E.__createBinding||(Object.create?function(i,t,e,r){r===void 0&&(r=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(i,r,s)}:function(i,t,e,r){r===void 0&&(r=e),i[r]=t[e]}),O=E&&E.__exportStar||function(i,t){for(var e in i)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Ma(t,i,e)};Object.defineProperty(E,"__esModule",{value:!0});O(as(),E);O(us(),E);O(ls(),E);O(ks(),E);O(Ms(),E);O(Ss(),E);O(Es(),E);O(As(),E);O(Cs(),E);O(yr(),E);O(Ls(),E);O(mr(),E);O(Os(),E);O(Dr(),E);O(Fs(),E);O(js(),E);O(xs(),E);O($s(),E);O(Gs(),E)});var gr=d(qt=>{"use strict";var Sa=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(qt,"__esModule",{value:!0});qt.createValue=Me;var k=Sa(M()),m=W(),P=ut();function Me(i,t){if(t===null)return k.default.create_null_value();let{typeId:e}=i;switch(e){case m.DuckDBTypeId.BOOLEAN:if(typeof t=="boolean")return k.default.create_bool(t);throw new Error("input is not a boolean");case m.DuckDBTypeId.TINYINT:if(typeof t=="number")return k.default.create_int8(t);throw new Error("input is not a number");case m.DuckDBTypeId.SMALLINT:if(typeof t=="number")return k.default.create_int16(t);throw new Error("input is not a number");case m.DuckDBTypeId.INTEGER:if(typeof t=="number")return k.default.create_int32(t);throw new Error("input is not a number");case m.DuckDBTypeId.BIGINT:if(typeof t=="bigint")return k.default.create_int64(t);throw new Error("input is not a bigint");case m.DuckDBTypeId.UTINYINT:if(typeof t=="number")return k.default.create_uint8(t);throw new Error("input is not a number");case m.DuckDBTypeId.USMALLINT:if(typeof t=="number")return k.default.create_uint16(t);throw new Error("input is not a number");case m.DuckDBTypeId.UINTEGER:if(typeof t=="number")return k.default.create_uint32(t);throw new Error("input is not a number");case m.DuckDBTypeId.UBIGINT:if(typeof t=="bigint")return k.default.create_uint64(t);throw new Error("input is not a bigint");case m.DuckDBTypeId.FLOAT:if(typeof t=="number")return k.default.create_float(t);throw new Error("input is not a number");case m.DuckDBTypeId.DOUBLE:if(typeof t=="number")return k.default.create_double(t);throw new Error("input is not a number");case m.DuckDBTypeId.TIMESTAMP:if(t instanceof P.DuckDBTimestampValue)return k.default.create_timestamp(t);throw new Error("input is not a DuckDBTimestampValue");case m.DuckDBTypeId.DATE:if(t instanceof P.DuckDBDateValue)return k.default.create_date(t);throw new Error("input is not a DuckDBDateValue");case m.DuckDBTypeId.TIME:if(t instanceof P.DuckDBTimeValue)return k.default.create_time(t);throw new Error("input is not a DuckDBTimeValue");case m.DuckDBTypeId.INTERVAL:if(t instanceof P.DuckDBIntervalValue)return k.default.create_interval(t);throw new Error("input is not a DuckDBIntervalValue");case m.DuckDBTypeId.HUGEINT:if(typeof t=="bigint")return k.default.create_hugeint(t);throw new Error("input is not a bigint");case m.DuckDBTypeId.UHUGEINT:if(typeof t=="bigint")return k.default.create_uhugeint(t);throw new Error("input is not a bigint");case m.DuckDBTypeId.VARCHAR:if(typeof t=="string")return k.default.create_varchar(t);throw new Error("input is not a string");case m.DuckDBTypeId.BLOB:if(t instanceof P.DuckDBBlobValue)return k.default.create_blob(t.bytes);throw new Error("input is not a DuckDBBlobValue");case m.DuckDBTypeId.DECIMAL:if(t instanceof P.DuckDBDecimalValue)return k.default.create_decimal(t);throw new Error("input is not a DuckDBDecimalValue");case m.DuckDBTypeId.TIMESTAMP_S:if(t instanceof P.DuckDBTimestampSecondsValue)return k.default.create_timestamp_s(t);throw new Error("input is not a DuckDBTimestampSecondsValue");case m.DuckDBTypeId.TIMESTAMP_MS:if(t instanceof P.DuckDBTimestampMillisecondsValue)return k.default.create_timestamp_ms(t);throw new Error("input is not a DuckDBTimestampMillisecondsValue");case m.DuckDBTypeId.TIMESTAMP_NS:if(t instanceof P.DuckDBTimestampNanosecondsValue)return k.default.create_timestamp_ns(t);throw new Error("input is not a DuckDBTimestampNanosecondsValue");case m.DuckDBTypeId.ENUM:if(typeof t=="string")return k.default.create_enum_value(i.toLogicalType().logical_type,i.indexForValue(t));throw new Error("input is not a string");case m.DuckDBTypeId.LIST:if(t instanceof P.DuckDBListValue){if(i.valueType.typeId===m.DuckDBTypeId.ANY)throw new Error("Cannot create lists with item type of ANY. Specify a specific type.");return k.default.create_list_value(i.valueType.toLogicalType().logical_type,t.items.map(r=>Me(i.valueType,r)))}throw new Error("input is not a DuckDBListValue");case m.DuckDBTypeId.STRUCT:if(t instanceof P.DuckDBStructValue){if(i.entryTypes.find(r=>r.typeId===m.DuckDBTypeId.ANY))throw new Error("Cannot create structs with an entry type of ANY. Specify a specific type.");return k.default.create_struct_value(i.toLogicalType().logical_type,Object.values(t.entries).map((r,s)=>Me(i.entryTypes[s],r)))}throw new Error("input is not a DuckDBStructValue");case m.DuckDBTypeId.MAP:throw new Error("not yet implemented for MAP");case m.DuckDBTypeId.ARRAY:if(t instanceof P.DuckDBArrayValue){if(i.valueType.typeId===m.DuckDBTypeId.ANY)throw new Error("Cannot create arrays with item type of ANY. Specify a specific type.");return k.default.create_array_value(i.valueType.toLogicalType().logical_type,t.items.map(r=>Me(i.valueType,r)))}throw new Error("input is not a DuckDBArrayValue");case m.DuckDBTypeId.UUID:if(t instanceof P.DuckDBUUIDValue)return k.default.create_uuid(t.toUint128());throw new Error("input is not a bigint");case m.DuckDBTypeId.UNION:throw new Error("not yet implemented for UNION");case m.DuckDBTypeId.BIT:if(t instanceof P.DuckDBBitValue)return k.default.create_bit(t.data);throw new Error("input is not a DuckDBBitValue");case m.DuckDBTypeId.TIME_TZ:if(t instanceof P.DuckDBTimeTZValue)return k.default.create_time_tz_value(t);throw new Error("input is not a DuckDBTimeTZValue");case m.DuckDBTypeId.TIMESTAMP_TZ:if(t instanceof P.DuckDBTimestampTZValue)return k.default.create_timestamp_tz(t);throw new Error("input is not a DuckDBTimestampTZValue");case m.DuckDBTypeId.ANY:throw new Error("Cannot create values of type ANY. Specify a specific type.");case m.DuckDBTypeId.VARINT:if(typeof t=="bigint")return k.default.create_varint(t);throw new Error("input is not a bigint");case m.DuckDBTypeId.SQLNULL:return k.default.create_null_value();default:throw new Error(`unrecognized type id ${e}`)}}});var ct=d(a=>{"use strict";var Ea=a&&a.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(a,"__esModule",{value:!0});a.DuckDBStructType=a.DuckDBListType=a.DuckDBEnumType=a.TIMESTAMP_NS=a.DuckDBTimestampNanosecondsType=a.TIMESTAMP_MS=a.DuckDBTimestampMillisecondsType=a.TIMESTAMP_S=a.DuckDBTimestampSecondsType=a.DuckDBDecimalType=a.BLOB=a.DuckDBBlobType=a.VARCHAR=a.DuckDBVarCharType=a.UHUGEINT=a.DuckDBUHugeIntType=a.HUGEINT=a.DuckDBHugeIntType=a.INTERVAL=a.DuckDBIntervalType=a.TIME=a.DuckDBTimeType=a.DATE=a.DuckDBDateType=a.DuckDBTimestampMicrosecondsType=a.TIMESTAMP=a.DuckDBTimestampType=a.DOUBLE=a.DuckDBDoubleType=a.FLOAT=a.DuckDBFloatType=a.UBIGINT=a.DuckDBUBigIntType=a.UINTEGER=a.DuckDBUIntegerType=a.USMALLINT=a.DuckDBUSmallIntType=a.UTINYINT=a.DuckDBUTinyIntType=a.BIGINT=a.DuckDBBigIntType=a.INTEGER=a.DuckDBIntegerType=a.SMALLINT=a.DuckDBSmallIntType=a.TINYINT=a.DuckDBTinyIntType=a.BOOLEAN=a.DuckDBBooleanType=a.BaseDuckDBType=void 0;a.SQLNULL=a.DuckDBSQLNullType=a.VARINT=a.DuckDBVarIntType=a.ANY=a.DuckDBAnyType=a.TIMESTAMPTZ=a.DuckDBTimestampTZType=a.TIMETZ=a.DuckDBTimeTZType=a.BIT=a.DuckDBBitType=a.DuckDBUnionType=a.UUID=a.DuckDBUUIDType=a.DuckDBArrayType=a.DuckDBMapType=void 0;a.DECIMAL=Aa;a.ENUM8=Zs;a.ENUM16=zs;a.ENUM32=Hs;a.ENUM=Ra;a.LIST=Ca;a.STRUCT=La;a.MAP=Oa;a.ARRAY=Ua;a.UNION=Pa;var Na=Ea(M()),Z=ot(),f=W(),wr=ae(),w=ut(),y=class{typeId;alias;constructor(t,e){this.typeId=t,this.alias=e}toString(){return f.DuckDBTypeId[this.typeId]}toLogicalType(){let t=Z.DuckDBLogicalType.create(Na.default.create_logical_type(this.typeId));return this.alias&&(t.alias=this.alias),t}};a.BaseDuckDBType=y;var Se=class i extends y{constructor(t){super(f.DuckDBTypeId.BOOLEAN,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBBooleanType=Se;a.BOOLEAN=Se.instance;var Ee=class i extends y{constructor(t){super(f.DuckDBTypeId.TINYINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**7-1;static Min=-(2**7);get max(){return i.Max}get min(){return i.Min}};a.DuckDBTinyIntType=Ee;a.TINYINT=Ee.instance;var Ne=class i extends y{constructor(t){super(f.DuckDBTypeId.SMALLINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**15-1;static Min=-(2**15);get max(){return i.Max}get min(){return i.Min}};a.DuckDBSmallIntType=Ne;a.SMALLINT=Ne.instance;var Ae=class i extends y{constructor(t){super(f.DuckDBTypeId.INTEGER,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**31-1;static Min=-(2**31);get max(){return i.Max}get min(){return i.Min}};a.DuckDBIntegerType=Ae;a.INTEGER=Ae.instance;var Re=class i extends y{constructor(t){super(f.DuckDBTypeId.BIGINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2n**63n-1n;static Min=-(2n**63n);get max(){return i.Max}get min(){return i.Min}};a.DuckDBBigIntType=Re;a.BIGINT=Re.instance;var Ce=class i extends y{constructor(t){super(f.DuckDBTypeId.UTINYINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**8-1;static Min=0;get max(){return i.Max}get min(){return i.Min}};a.DuckDBUTinyIntType=Ce;a.UTINYINT=Ce.instance;var Le=class i extends y{constructor(t){super(f.DuckDBTypeId.USMALLINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**16-1;static Min=0;get max(){return i.Max}get min(){return i.Min}};a.DuckDBUSmallIntType=Le;a.USMALLINT=Le.instance;var Oe=class i extends y{constructor(t){super(f.DuckDBTypeId.UINTEGER,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2**32-1;static Min=0;get max(){return i.Max}get min(){return i.Min}};a.DuckDBUIntegerType=Oe;a.UINTEGER=Oe.instance;var Ue=class i extends y{constructor(t){super(f.DuckDBTypeId.UBIGINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2n**64n-1n;static Min=0n;get max(){return i.Max}get min(){return i.Min}};a.DuckDBUBigIntType=Ue;a.UBIGINT=Ue.instance;var Pe=class i extends y{constructor(t){super(f.DuckDBTypeId.FLOAT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=Math.fround(34028235e31);static Min=Math.fround(-34028235e31);get max(){return i.Max}get min(){return i.Min}};a.DuckDBFloatType=Pe;a.FLOAT=Pe.instance;var Fe=class i extends y{constructor(t){super(f.DuckDBTypeId.DOUBLE,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=Number.MAX_VALUE;static Min=-Number.MAX_VALUE;get max(){return i.Max}get min(){return i.Min}};a.DuckDBDoubleType=Fe;a.DOUBLE=Fe.instance;var jt=class i extends y{constructor(t){super(f.DuckDBTypeId.TIMESTAMP,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBTimestampValue.Epoch}get max(){return w.DuckDBTimestampValue.Max}get min(){return w.DuckDBTimestampValue.Min}get posInf(){return w.DuckDBTimestampValue.PosInf}get negInf(){return w.DuckDBTimestampValue.NegInf}};a.DuckDBTimestampType=jt;a.TIMESTAMP=jt.instance;a.DuckDBTimestampMicrosecondsType=jt;var qe=class i extends y{constructor(t){super(f.DuckDBTypeId.DATE,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBDateValue.Epoch}get max(){return w.DuckDBDateValue.Max}get min(){return w.DuckDBDateValue.Min}get posInf(){return w.DuckDBDateValue.PosInf}get negInf(){return w.DuckDBDateValue.NegInf}};a.DuckDBDateType=qe;a.DATE=qe.instance;var je=class i extends y{constructor(t){super(f.DuckDBTypeId.TIME,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get max(){return w.DuckDBTimeValue.Max}get min(){return w.DuckDBTimeValue.Min}};a.DuckDBTimeType=je;a.TIME=je.instance;var xe=class i extends y{constructor(t){super(f.DuckDBTypeId.INTERVAL,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBIntervalType=xe;a.INTERVAL=xe.instance;var $e=class i extends y{constructor(t){super(f.DuckDBTypeId.HUGEINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2n**127n-1n;static Min=-(2n**127n);get max(){return i.Max}get min(){return i.Min}};a.DuckDBHugeIntType=$e;a.HUGEINT=$e.instance;var Ye=class i extends y{constructor(t){super(f.DuckDBTypeId.UHUGEINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=2n**128n-1n;static Min=0n;get max(){return i.Max}get min(){return i.Min}};a.DuckDBUHugeIntType=Ye;a.UHUGEINT=Ye.instance;var Ge=class i extends y{constructor(t){super(f.DuckDBTypeId.VARCHAR,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBVarCharType=Ge;a.VARCHAR=Ge.instance;var Ze=class i extends y{constructor(t){super(f.DuckDBTypeId.BLOB,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBBlobType=Ze;a.BLOB=Ze.instance;var ht=class i extends y{width;scale;constructor(t,e,r){super(f.DuckDBTypeId.DECIMAL,r),this.width=t,this.scale=e}toString(){return`DECIMAL(${this.width},${this.scale})`}toLogicalType(){let t=Z.DuckDBLogicalType.createDecimal(this.width,this.scale);return this.alias&&(t.alias=this.alias),t}static default=new i(18,3)};a.DuckDBDecimalType=ht;function Aa(i,t,e){return i===void 0?ht.default:t===void 0?new ht(i,0):new ht(i,t,e)}var ze=class i extends y{constructor(t){super(f.DuckDBTypeId.TIMESTAMP_S,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBTimestampSecondsValue.Epoch}get max(){return w.DuckDBTimestampSecondsValue.Max}get min(){return w.DuckDBTimestampSecondsValue.Min}get posInf(){return w.DuckDBTimestampSecondsValue.PosInf}get negInf(){return w.DuckDBTimestampSecondsValue.NegInf}};a.DuckDBTimestampSecondsType=ze;a.TIMESTAMP_S=ze.instance;var He=class i extends y{constructor(t){super(f.DuckDBTypeId.TIMESTAMP_MS,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBTimestampMillisecondsValue.Epoch}get max(){return w.DuckDBTimestampMillisecondsValue.Max}get min(){return w.DuckDBTimestampMillisecondsValue.Min}get posInf(){return w.DuckDBTimestampMillisecondsValue.PosInf}get negInf(){return w.DuckDBTimestampMillisecondsValue.NegInf}};a.DuckDBTimestampMillisecondsType=He;a.TIMESTAMP_MS=He.instance;var Je=class i extends y{constructor(t){super(f.DuckDBTypeId.TIMESTAMP_NS,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBTimestampNanosecondsValue.Epoch}get max(){return w.DuckDBTimestampNanosecondsValue.Max}get min(){return w.DuckDBTimestampNanosecondsValue.Min}get posInf(){return w.DuckDBTimestampNanosecondsValue.PosInf}get negInf(){return w.DuckDBTimestampNanosecondsValue.NegInf}};a.DuckDBTimestampNanosecondsType=Je;a.TIMESTAMP_NS=Je.instance;var ft=class extends y{values;valueIndexes;internalTypeId;constructor(t,e,r){super(f.DuckDBTypeId.ENUM,r),this.values=t;let s={};for(let n=0;n<t.length;n++)s[t[n]]=n;this.valueIndexes=s,this.internalTypeId=e}indexForValue(t){return this.valueIndexes[t]}toString(){return`ENUM(${this.values.map(wr.quotedString).join(", ")})`}toLogicalType(){let t=Z.DuckDBLogicalType.createEnum(this.values);return this.alias&&(t.alias=this.alias),t}};a.DuckDBEnumType=ft;function Zs(i,t){return new ft(i,f.DuckDBTypeId.UTINYINT,t)}function zs(i,t){return new ft(i,f.DuckDBTypeId.USMALLINT,t)}function Hs(i,t){return new ft(i,f.DuckDBTypeId.UINTEGER,t)}function Ra(i,t){if(i.length<256)return Zs(i,t);if(i.length<65536)return zs(i,t);if(i.length<4294967296)return Hs(i,t);throw new Error(`ENUM types cannot have more than 4294967295 values; received ${i.length}`)}var Qe=class extends y{valueType;constructor(t,e){super(f.DuckDBTypeId.LIST,e),this.valueType=t}toString(){return`${this.valueType}[]`}toLogicalType(){let t=Z.DuckDBLogicalType.createList(this.valueType.toLogicalType());return this.alias&&(t.alias=this.alias),t}};a.DuckDBListType=Qe;function Ca(i,t){return new Qe(i,t)}var Ke=class extends y{entryNames;entryTypes;entryIndexes;constructor(t,e,r){if(super(f.DuckDBTypeId.STRUCT,r),t.length!==e.length)throw new Error(`Could not create DuckDBStructType:         entryNames length (${t.length}) does not match entryTypes length (${e.length})`);this.entryNames=t,this.entryTypes=e;let s={};for(let n=0;n<t.length;n++)s[t[n]]=n;this.entryIndexes=s}get entryCount(){return this.entryNames.length}indexForEntry(t){return this.entryIndexes[t]}typeForEntry(t){return this.entryTypes[this.entryIndexes[t]]}toString(){let t=[];for(let e=0;e<this.entryNames.length;e++)t.push(`${(0,wr.quotedIdentifier)(this.entryNames[e])} ${this.entryTypes[e]}`);return`STRUCT(${t.join(", ")})`}toLogicalType(){let t=Z.DuckDBLogicalType.createStruct(this.entryNames,this.entryTypes.map(e=>e.toLogicalType()));return this.alias&&(t.alias=this.alias),t}};a.DuckDBStructType=Ke;function La(i,t){let e=Object.keys(i),r=Object.values(i);return new Ke(e,r,t)}var We=class extends y{keyType;valueType;constructor(t,e,r){super(f.DuckDBTypeId.MAP,r),this.keyType=t,this.valueType=e}toString(){return`MAP(${this.keyType}, ${this.valueType})`}toLogicalType(){let t=Z.DuckDBLogicalType.createMap(this.keyType.toLogicalType(),this.valueType.toLogicalType());return this.alias&&(t.alias=this.alias),t}};a.DuckDBMapType=We;function Oa(i,t,e){return new We(i,t,e)}var Xe=class extends y{valueType;length;constructor(t,e,r){super(f.DuckDBTypeId.ARRAY,r),this.valueType=t,this.length=e}toString(){return`${this.valueType}[${this.length}]`}toLogicalType(){let t=Z.DuckDBLogicalType.createArray(this.valueType.toLogicalType(),this.length);return this.alias&&(t.alias=this.alias),t}};a.DuckDBArrayType=Xe;function Ua(i,t,e){return new Xe(i,t,e)}var ti=class i extends y{constructor(t){super(f.DuckDBTypeId.UUID,t)}static instance=new i;static create(t){return t?new i(t):i.instance}get max(){return w.DuckDBUUIDValue.Max}get min(){return w.DuckDBUUIDValue.Min}};a.DuckDBUUIDType=ti;a.UUID=ti.instance;var ei=class extends y{memberTags;tagMemberIndexes;memberTypes;constructor(t,e,r){if(super(f.DuckDBTypeId.UNION,r),t.length!==e.length)throw new Error(`Could not create DuckDBUnionType:         tags length (${t.length}) does not match valueTypes length (${e.length})`);this.memberTags=t;let s={};for(let n=0;n<t.length;n++)s[t[n]]=n;this.tagMemberIndexes=s,this.memberTypes=e}memberIndexForTag(t){return this.tagMemberIndexes[t]}memberTypeForTag(t){return this.memberTypes[this.tagMemberIndexes[t]]}get memberCount(){return this.memberTags.length}toString(){let t=[];for(let e=0;e<this.memberTags.length;e++)t.push(`${(0,wr.quotedIdentifier)(this.memberTags[e])} ${this.memberTypes[e]}`);return`UNION(${t.join(", ")})`}toLogicalType(){let t=Z.DuckDBLogicalType.createUnion(this.memberTags,this.memberTypes.map(e=>e.toLogicalType()));return this.alias&&(t.alias=this.alias),t}};a.DuckDBUnionType=ei;function Pa(i,t){let e=Object.keys(i),r=Object.values(i);return new ei(e,r,t)}var ii=class i extends y{constructor(t){super(f.DuckDBTypeId.BIT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBBitType=ii;a.BIT=ii.instance;var ri=class i extends y{constructor(t){super(f.DuckDBTypeId.TIME_TZ,t)}toString(){return"TIME WITH TIME ZONE"}static instance=new i;static create(t){return t?new i(t):i.instance}get max(){return w.DuckDBTimeTZValue.Max}get min(){return w.DuckDBTimeTZValue.Min}};a.DuckDBTimeTZType=ri;a.TIMETZ=ri.instance;var si=class i extends y{constructor(t){super(f.DuckDBTypeId.TIMESTAMP_TZ,t)}toString(){return"TIMESTAMP WITH TIME ZONE"}static instance=new i;static create(t){return t?new i(t):i.instance}get epoch(){return w.DuckDBTimestampTZValue.Epoch}get max(){return w.DuckDBTimestampTZValue.Max}get min(){return w.DuckDBTimestampTZValue.Min}get posInf(){return w.DuckDBTimestampTZValue.PosInf}get negInf(){return w.DuckDBTimestampTZValue.NegInf}};a.DuckDBTimestampTZType=si;a.TIMESTAMPTZ=si.instance;var ni=class i extends y{constructor(t){super(f.DuckDBTypeId.ANY,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBAnyType=ni;a.ANY=ni.instance;var ai=class i extends y{constructor(t){super(f.DuckDBTypeId.VARINT,t)}static instance=new i;static create(t){return t?new i(t):i.instance}static Max=179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368n;static Min=-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368n;get max(){return i.Max}get min(){return i.Min}};a.DuckDBVarIntType=ai;a.VARINT=ai.instance;var ui=class i extends y{constructor(t){super(f.DuckDBTypeId.SQLNULL,t)}static instance=new i;static create(t){return t?new i(t):i.instance}};a.DuckDBSQLNullType=ui;a.SQLNULL=ui.instance});var ot=d(C=>{"use strict";var Fa=C&&C.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(C,"__esModule",{value:!0});C.DuckDBUnionLogicalType=C.DuckDBArrayLogicalType=C.DuckDBMapLogicalType=C.DuckDBStructLogicalType=C.DuckDBListLogicalType=C.DuckDBEnumLogicalType=C.DuckDBDecimalLogicalType=C.DuckDBLogicalType=void 0;var B=Fa(M()),I=ct(),_=W(),F=class i{logical_type;constructor(t){this.logical_type=t}static create(t){switch(B.default.get_type_id(t)){case B.default.Type.DECIMAL:return new xt(t);case B.default.Type.ENUM:return new $t(t);case B.default.Type.LIST:return new Yt(t);case B.default.Type.STRUCT:return new Gt(t);case B.default.Type.MAP:return new Zt(t);case B.default.Type.ARRAY:return new zt(t);case B.default.Type.UNION:return new Ht(t);default:return new i(t)}}static createDecimal(t,e){return new xt(B.default.create_decimal_type(t,e))}static createEnum(t){return new $t(B.default.create_enum_type(t))}static createList(t){return new Yt(B.default.create_list_type(t.logical_type))}static createStruct(t,e){let r=t.length;if(r!==e.length)throw new Error(`Could not create struct:         entryNames length (${t.length}) does not match entryLogicalTypes length (${e.length})`);let s=[],n=[];for(let u=0;u<r;u++)s.push(e[u].logical_type),n.push(t[u]);return new Gt(B.default.create_struct_type(s,n))}static createMap(t,e){return new Zt(B.default.create_map_type(t.logical_type,e.logical_type))}static createArray(t,e){return new zt(B.default.create_array_type(t.logical_type,e))}static createUnion(t,e){let r=t.length;if(r!==e.length)throw new Error(`Could not create union:         memberTags length (${t.length}) does not match memberLogicalTypes length (${e.length})`);let s=[],n=[];for(let u=0;u<r;u++)s.push(e[u].logical_type),n.push(t[u]);return new Ht(B.default.create_union_type(s,n))}get typeId(){return B.default.get_type_id(this.logical_type)}get alias(){return B.default.logical_type_get_alias(this.logical_type)||void 0}set alias(t){B.default.logical_type_set_alias(this.logical_type,t||"")}asType(){let t=this.alias;switch(this.typeId){case _.DuckDBTypeId.BOOLEAN:return I.DuckDBBooleanType.create(t);case _.DuckDBTypeId.TINYINT:return I.DuckDBTinyIntType.create(t);case _.DuckDBTypeId.SMALLINT:return I.DuckDBSmallIntType.create(t);case _.DuckDBTypeId.INTEGER:return I.DuckDBIntegerType.create(t);case _.DuckDBTypeId.BIGINT:return I.DuckDBBigIntType.create(t);case _.DuckDBTypeId.UTINYINT:return I.DuckDBUTinyIntType.create(t);case _.DuckDBTypeId.USMALLINT:return I.DuckDBUSmallIntType.create(t);case _.DuckDBTypeId.UINTEGER:return I.DuckDBUIntegerType.create(t);case _.DuckDBTypeId.UBIGINT:return I.DuckDBUBigIntType.create(t);case _.DuckDBTypeId.FLOAT:return I.DuckDBFloatType.create(t);case _.DuckDBTypeId.DOUBLE:return I.DuckDBDoubleType.create(t);case _.DuckDBTypeId.TIMESTAMP:return I.DuckDBTimestampType.create(t);case _.DuckDBTypeId.DATE:return I.DuckDBDateType.create(t);case _.DuckDBTypeId.TIME:return I.DuckDBTimeType.create(t);case _.DuckDBTypeId.INTERVAL:return I.DuckDBIntervalType.create(t);case _.DuckDBTypeId.HUGEINT:return I.DuckDBHugeIntType.create(t);case _.DuckDBTypeId.UHUGEINT:return I.DuckDBUHugeIntType.create(t);case _.DuckDBTypeId.VARCHAR:return I.DuckDBVarCharType.create(t);case _.DuckDBTypeId.BLOB:return I.DuckDBBlobType.create(t);case _.DuckDBTypeId.DECIMAL:throw new Error("Expected override");case _.DuckDBTypeId.TIMESTAMP_S:return I.DuckDBTimestampSecondsType.create(t);case _.DuckDBTypeId.TIMESTAMP_MS:return I.DuckDBTimestampMillisecondsType.create(t);case _.DuckDBTypeId.TIMESTAMP_NS:return I.DuckDBTimestampNanosecondsType.create(t);case _.DuckDBTypeId.ENUM:throw new Error("Expected override");case _.DuckDBTypeId.LIST:throw new Error("Expected override");case _.DuckDBTypeId.STRUCT:throw new Error("Expected override");case _.DuckDBTypeId.MAP:throw new Error("Expected override");case _.DuckDBTypeId.ARRAY:throw new Error("Expected override");case _.DuckDBTypeId.UUID:return I.DuckDBUUIDType.create(t);case _.DuckDBTypeId.UNION:throw new Error("Expected override");case _.DuckDBTypeId.BIT:return I.DuckDBBitType.create(t);case _.DuckDBTypeId.TIME_TZ:return I.DuckDBTimeTZType.create(t);case _.DuckDBTypeId.TIMESTAMP_TZ:return I.DuckDBTimestampTZType.create(t);case _.DuckDBTypeId.ANY:return I.DuckDBAnyType.create(t);case _.DuckDBTypeId.VARINT:return I.DuckDBVarIntType.create(t);case _.DuckDBTypeId.SQLNULL:return I.DuckDBSQLNullType.create(t);default:throw new Error(`Unexpected type id: ${this.typeId}`)}}};C.DuckDBLogicalType=F;var xt=class extends F{get width(){return B.default.decimal_width(this.logical_type)}get scale(){return B.default.decimal_scale(this.logical_type)}get internalTypeId(){return B.default.decimal_internal_type(this.logical_type)}asType(){return new I.DuckDBDecimalType(this.width,this.scale,this.alias)}};C.DuckDBDecimalLogicalType=xt;var $t=class extends F{get valueCount(){return B.default.enum_dictionary_size(this.logical_type)}value(t){return B.default.enum_dictionary_value(this.logical_type,t)}values(){let t=[],e=this.valueCount;for(let r=0;r<e;r++)t.push(this.value(r));return t}get internalTypeId(){return B.default.enum_internal_type(this.logical_type)}asType(){return new I.DuckDBEnumType(this.values(),this.internalTypeId,this.alias)}};C.DuckDBEnumLogicalType=$t;var Yt=class extends F{get valueType(){return F.create(B.default.list_type_child_type(this.logical_type))}asType(){return new I.DuckDBListType(this.valueType.asType(),this.alias)}};C.DuckDBListLogicalType=Yt;var Gt=class extends F{get entryCount(){return B.default.struct_type_child_count(this.logical_type)}entryName(t){return B.default.struct_type_child_name(this.logical_type,t)}entryLogicalType(t){return F.create(B.default.struct_type_child_type(this.logical_type,t))}entryType(t){return this.entryLogicalType(t).asType()}entryNames(){let t=[],e=this.entryCount;for(let r=0;r<e;r++)t.push(this.entryName(r));return t}entryLogicalTypes(){let t=[],e=this.entryCount;for(let r=0;r<e;r++)t.push(this.entryLogicalType(r));return t}entryTypes(){let t=[],e=this.entryCount;for(let r=0;r<e;r++)t.push(this.entryType(r));return t}asType(){return new I.DuckDBStructType(this.entryNames(),this.entryTypes(),this.alias)}};C.DuckDBStructLogicalType=Gt;var Zt=class extends F{get keyType(){return F.create(B.default.map_type_key_type(this.logical_type))}get valueType(){return F.create(B.default.map_type_value_type(this.logical_type))}asType(){return new I.DuckDBMapType(this.keyType.asType(),this.valueType.asType(),this.alias)}};C.DuckDBMapLogicalType=Zt;var zt=class extends F{get valueType(){return F.create(B.default.array_type_child_type(this.logical_type))}get length(){return B.default.array_type_array_size(this.logical_type)}asType(){return new I.DuckDBArrayType(this.valueType.asType(),this.length,this.alias)}};C.DuckDBArrayLogicalType=zt;var Ht=class extends F{get memberCount(){return B.default.union_type_member_count(this.logical_type)}memberTag(t){return B.default.union_type_member_name(this.logical_type,t)}memberLogicalType(t){return F.create(B.default.union_type_member_type(this.logical_type,t))}memberType(t){return this.memberLogicalType(t).asType()}memberTags(){let t=[],e=this.memberCount;for(let r=0;r<e;r++)t.push(this.memberTag(r));return t}memberLogicalTypes(){let t=[],e=this.memberCount;for(let r=0;r<e;r++)t.push(this.memberLogicalType(r));return t}memberTypes(){let t=[],e=this.memberCount;for(let r=0;r<e;r++)t.push(this.memberType(r));return t}asType(){return new I.DuckDBUnionType(this.memberTags(),this.memberTypes(),this.alias)}};C.DuckDBUnionLogicalType=Ht});var Ir=d(mt=>{"use strict";var qa=mt&&mt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(mt,"__esModule",{value:!0});mt.DuckDBAppender=void 0;var S=qa(M()),ja=gr(),xa=ot(),G=ct(),_r=class{appender;constructor(t){this.appender=t}close(){S.default.appender_close(this.appender)}flush(){S.default.appender_flush(this.appender)}get columnCount(){return S.default.appender_column_count(this.appender)}columnType(t){return xa.DuckDBLogicalType.create(S.default.appender_column_type(this.appender,t)).asType()}endRow(){S.default.appender_end_row(this.appender)}appendDefault(){S.default.append_default(this.appender)}appendBoolean(t){S.default.append_bool(this.appender,t)}appendTinyInt(t){S.default.append_int8(this.appender,t)}appendSmallInt(t){S.default.append_int16(this.appender,t)}appendInteger(t){S.default.append_int32(this.appender,t)}appendBigInt(t){S.default.append_int64(this.appender,t)}appendHugeInt(t){S.default.append_hugeint(this.appender,t)}appendUTinyInt(t){S.default.append_uint8(this.appender,t)}appendUSmallInt(t){S.default.append_uint16(this.appender,t)}appendUInteger(t){S.default.append_uint32(this.appender,t)}appendUBigInt(t){S.default.append_uint64(this.appender,t)}appendUHugeInt(t){S.default.append_uhugeint(this.appender,t)}appendDecimal(t){this.appendValue(t,(0,G.DECIMAL)(t.width,t.scale))}appendFloat(t){S.default.append_float(this.appender,t)}appendDouble(t){S.default.append_double(this.appender,t)}appendDate(t){S.default.append_date(this.appender,t)}appendTime(t){S.default.append_time(this.appender,t)}appendTimeTZ(t){this.appendValue(t,G.TIMETZ)}appendTimestamp(t){S.default.append_timestamp(this.appender,t)}appendTimestampTZ(t){this.appendValue(t,G.TIMESTAMPTZ)}appendTimestampSeconds(t){this.appendValue(t,G.TIMESTAMP_S)}appendTimestampMilliseconds(t){this.appendValue(t,G.TIMESTAMP_MS)}appendTimestampNanoseconds(t){this.appendValue(t,G.TIMESTAMP_NS)}appendInterval(t){S.default.append_interval(this.appender,t)}appendVarchar(t){S.default.append_varchar(this.appender,t)}appendBlob(t){S.default.append_blob(this.appender,t)}appendEnum(t,e){this.appendValue(t,e)}appendList(t,e){this.appendValue(t,e)}appendStruct(t,e){this.appendValue(t,e)}appendArray(t,e){this.appendValue(t,e)}appendUUID(t){this.appendValue(t,G.UUID)}appendBit(t){this.appendValue(t,G.BIT)}appendVarInt(t){this.appendValue(t,G.VARINT)}appendNull(){S.default.append_null(this.appender)}appendValue(t,e){S.default.append_value(this.appender,(0,ja.createValue)(e,t))}appendDataChunk(t){S.default.append_data_chunk(this.appender,t.chunk)}};mt.DuckDBAppender=_r});var kr=d(c=>{"use strict";var Qs=c&&c.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(c,"__esModule",{value:!0});c.DuckDBVarIntVector=c.DuckDBTimestampTZVector=c.DuckDBTimeTZVector=c.DuckDBBitVector=c.DuckDBUnionVector=c.DuckDBUUIDVector=c.DuckDBArrayVector=c.DuckDBMapVector=c.DuckDBStructVector=c.DuckDBListVector=c.DuckDBEnum32Vector=c.DuckDBEnum16Vector=c.DuckDBEnum8Vector=c.DuckDBTimestampNanosecondsVector=c.DuckDBTimestampMillisecondsVector=c.DuckDBTimestampSecondsVector=c.DuckDBDecimal128Vector=c.DuckDBDecimal64Vector=c.DuckDBDecimal32Vector=c.DuckDBDecimal16Vector=c.DuckDBBlobVector=c.DuckDBVarCharVector=c.DuckDBUHugeIntVector=c.DuckDBHugeIntVector=c.DuckDBIntervalVector=c.DuckDBTimeVector=c.DuckDBDateVector=c.DuckDBTimestampVector=c.DuckDBDoubleVector=c.DuckDBFloatVector=c.DuckDBUBigIntVector=c.DuckDBUIntegerVector=c.DuckDBUSmallIntVector=c.DuckDBUTinyIntVector=c.DuckDBBigIntVector=c.DuckDBIntegerVector=c.DuckDBSmallIntVector=c.DuckDBTinyIntVector=c.DuckDBBooleanVector=c.DuckDBVector=void 0;var l=Qs(M()),$a=Qs(require("os")),Ya=ot(),D=ct(),p=W(),A=ut(),q=$a.default.endianness()==="LE";function Ga(i,t){return i.getUint8(t)}function Ks(i,t){return i.getInt16(t,q)}function Za(i,t){return i.getUint16(t,q)}function ci(i,t){return i.getInt32(t,q)}function za(i,t){return i.getUint32(t,q)}function zi(i,t){return i.getBigInt64(t,q)}function oi(i,t){return i.getBigUint64(t,q)}function Jt(i,t){let e=oi(i,t);return(zi(i,t+8)<<BigInt(64))+e}function Js(i,t){let e=oi(i,t),r=oi(i,t+8);return BigInt.asUintN(64,r)<<BigInt(64)|BigInt.asUintN(64,e)}function Hi(i,t){let e=i.getUint32(t,!0);return e<=12?new Uint8Array(i.buffer,i.byteOffset+t+4,e):l.default.get_data_from_pointer(i.buffer,i.byteOffset+t+8,e)}var Ha=new TextDecoder;function Ja(i,t){let e=Hi(i,t);return Ha.decode(e)}function Qa(i,t){let e=Hi(i,t);return Buffer.from(e)}function Ka(i){let e=(i[0]&128)>0,r=e?0n:0xffffffffffffffffn,s=e?0:255,n=new DataView(i.buffer,i.byteOffset+3,i.byteLength-3),u=n.byteLength-8,o=0,g=0n;for(;o<=u;)g=g<<64n|n.getBigUint64(o)^r,o+=8;for(;o<n.byteLength;)g=g<<8n|BigInt(n.getUint8(o)^s),o+=1;return e?g:-g}function Wa(i){let t=[],e=i<0;if(i===0n)t.push(0);else{let n=i<0?-i:i;for(;n!==0n;)t.push(Number(BigInt.asUintN(8,n))),n>>=8n}let r=new Uint8Array(3+t.length),s=8388608|t.length;e&&(s=~s),r[0]=255&s>>16,r[1]=255&s>>8,r[2]=255&s;for(let n=0;n<t.length;n++){let u=t[t.length-1-n];r[3+n]=e?~u:u}return r}function Xa(i,t){return Ga(i,t)!==0}function tu(i,t){return Za(i,t)!==0}function eu(i,t){return za(i,t)!==0}function iu(i,t){return oi(i,t)!==BigInt(0)}function ru(){switch(l.default.sizeof_bool){case 1:return Xa;case 2:return tu;case 4:return eu;case 8:return iu;default:throw new Error(`Unsupported boolean size: ${l.default.sizeof_bool}`)}}var su=ru();function nu(i,t,e){i.setUint8(t,e)}function au(i,t,e){i.setInt16(t,e,q)}function uu(i,t,e){i.setUint16(t,e,q)}function Br(i,t,e){i.setInt32(t,e,q)}function cu(i,t,e){i.setUint32(t,e,q)}function Ws(i,t,e){i.setBigInt64(t,e,q)}function ou(i,t,e){i.setBigUint64(t,e,q)}function Vr(i,t,e){let r=BigInt.asUintN(64,e),s=BigInt.asIntN(64,e>>BigInt(64));i.setBigUint64(t,r,q),i.setBigInt64(t+8,s,q)}function lu(i,t,e){let r=BigInt.asUintN(64,e),s=BigInt.asUintN(64,e>>BigInt(64));i.setBigUint64(t,r,q),i.setBigUint64(t+8,s,q)}function du(i,t,e){nu(i,t,e?1:0)}function hu(i,t,e){uu(i,t,e?1:0)}function fu(i,t,e){cu(i,t,e?1:0)}function mu(i,t,e){ou(i,t,BigInt(e?1:0))}function yu(){switch(l.default.sizeof_bool){case 1:return du;case 2:return hu;case 4:return fu;case 8:return mu;default:throw new Error(`Unsupported boolean size: ${l.default.sizeof_bool}`)}}var pu=yu();function Du(i,t,e){let r=Ks(i,t);return new A.DuckDBDecimalValue(BigInt(r),e.width,e.scale)}function Tu(i,t,e){let r=ci(i,t);return new A.DuckDBDecimalValue(BigInt(r),e.width,e.scale)}function gu(i,t,e){let r=zi(i,t);return new A.DuckDBDecimalValue(r,e.width,e.scale)}function wu(i,t,e){let r=Jt(i,t);return new A.DuckDBDecimalValue(r,e.width,e.scale)}function V(i,t){return l.default.vector_get_data(i,t)}var T=class i{data;offset;itemCount;constructor(t,e,r){this.data=t,this.offset=e,this.itemCount=r}static fromVector(t,e){let r=Math.ceil(e/64),s=l.default.vector_get_validity(t,r*8);if(!s)return new i(null,0,e);let n=new BigUint64Array(s.buffer,s.byteOffset,r);return new i(n,0,e)}itemValid(t){if(!this.data)return!0;let e=this.offset+t;return(this.data[Math.floor(e/64)]&BigInt(1)<<BigInt(e%64))!==BigInt(0)}setItemValid(t,e){if(!this.data&&!e){let r=Math.ceil(this.itemCount/64),s=new ArrayBuffer(r*8);this.data=new BigUint64Array(s,0,r);for(let n=0;n<this.data.length;n++)this.data[n]=0xffffffffffffffffn}if(this.data){let r=this.offset+t,s=Math.floor(r/64),n=BigInt(1)<<BigInt(r%64);e?(this.data[s]&n)===0n&&(this.data[s]|=n):(this.data[s]&n)!==0n&&(this.data[s]&=~n)}}flush(t){this.data&&(l.default.vector_ensure_validity_writable(t),l.default.copy_data_to_vector_validity(t,0,this.data.buffer,this.data.byteOffset,this.data.byteLength))}slice(t,e){return new i(this.data,this.offset+t,e)}},h=class{static standardSize(){return l.default.vector_size()}static create(t,e,r){let s=r||Ya.DuckDBLogicalType.create(l.default.vector_get_column_type(t)).asType();switch(s.typeId){case p.DuckDBTypeId.BOOLEAN:return li.fromRawVector(t,e);case p.DuckDBTypeId.TINYINT:return di.fromRawVector(t,e);case p.DuckDBTypeId.SMALLINT:return hi.fromRawVector(t,e);case p.DuckDBTypeId.INTEGER:return fi.fromRawVector(t,e);case p.DuckDBTypeId.BIGINT:return mi.fromRawVector(t,e);case p.DuckDBTypeId.UTINYINT:return yi.fromRawVector(t,e);case p.DuckDBTypeId.USMALLINT:return pi.fromRawVector(t,e);case p.DuckDBTypeId.UINTEGER:return Di.fromRawVector(t,e);case p.DuckDBTypeId.UBIGINT:return Ti.fromRawVector(t,e);case p.DuckDBTypeId.FLOAT:return gi.fromRawVector(t,e);case p.DuckDBTypeId.DOUBLE:return wi.fromRawVector(t,e);case p.DuckDBTypeId.TIMESTAMP:return _i.fromRawVector(t,e);case p.DuckDBTypeId.DATE:return Ii.fromRawVector(t,e);case p.DuckDBTypeId.TIME:return Bi.fromRawVector(t,e);case p.DuckDBTypeId.INTERVAL:return Vi.fromRawVector(t,e);case p.DuckDBTypeId.HUGEINT:return ki.fromRawVector(t,e);case p.DuckDBTypeId.UHUGEINT:return vi.fromRawVector(t,e);case p.DuckDBTypeId.VARCHAR:return bi.fromRawVector(t,e);case p.DuckDBTypeId.BLOB:return Mi.fromRawVector(t,e);case p.DuckDBTypeId.DECIMAL:if(s instanceof D.DuckDBDecimalType){let{width:n}=s;if(n<=0)throw new Error(`DECIMAL width not positive: ${n}`);if(n<=4)return Si.fromRawVector(s,t,e);if(n<=9)return Ei.fromRawVector(s,t,e);if(n<=18)return Ni.fromRawVector(s,t,e);if(n<=38)return Ai.fromRawVector(s,t,e);throw new Error(`DECIMAL width too large: ${n}`)}throw new Error("DuckDBType has DECIMAL type id but is not an instance of DuckDBDecimalType");case p.DuckDBTypeId.TIMESTAMP_S:return Ri.fromRawVector(t,e);case p.DuckDBTypeId.TIMESTAMP_MS:return Ci.fromRawVector(t,e);case p.DuckDBTypeId.TIMESTAMP_NS:return Li.fromRawVector(t,e);case p.DuckDBTypeId.ENUM:if(s instanceof D.DuckDBEnumType){let{internalTypeId:n}=s;switch(n){case p.DuckDBTypeId.UTINYINT:return Oi.fromRawVector(s,t,e);case p.DuckDBTypeId.USMALLINT:return Ui.fromRawVector(s,t,e);case p.DuckDBTypeId.UINTEGER:return Pi.fromRawVector(s,t,e);default:throw new Error(`unsupported ENUM internal type: ${n}`)}}throw new Error("DuckDBType has ENUM type id but is not an instance of DuckDBEnumType");case p.DuckDBTypeId.LIST:if(s instanceof D.DuckDBListType)return Qt.fromRawVector(s,t,e);throw new Error("DuckDBType has LIST type id but is not an instance of DuckDBListType");case p.DuckDBTypeId.STRUCT:if(s instanceof D.DuckDBStructType)return yt.fromRawVector(s,t,e);throw new Error("DuckDBType has STRUCT type id but is not an instance of DuckDBStructType");case p.DuckDBTypeId.MAP:if(s instanceof D.DuckDBMapType)return Fi.fromRawVector(s,t,e);throw new Error("DuckDBType has MAP type id but is not an instance of DuckDBMapType");case p.DuckDBTypeId.ARRAY:if(s instanceof D.DuckDBArrayType)return qi.fromRawVector(s,t,e);throw new Error("DuckDBType has ARRAY type id but is not an instance of DuckDBArrayType");case p.DuckDBTypeId.UUID:return ji.fromRawVector(t,e);case p.DuckDBTypeId.UNION:if(s instanceof D.DuckDBUnionType)return xi.fromRawVector(s,t,e);throw new Error("DuckDBType has UNION type id but is not an instance of DuckDBUnionType");case p.DuckDBTypeId.BIT:return $i.fromRawVector(t,e);case p.DuckDBTypeId.TIME_TZ:return Yi.fromRawVector(t,e);case p.DuckDBTypeId.TIMESTAMP_TZ:return Gi.fromRawVector(t,e);case p.DuckDBTypeId.ANY:throw new Error("Invalid vector type: ANY");case p.DuckDBTypeId.VARINT:return Zi.fromRawVector(t,e);case p.DuckDBTypeId.SQLNULL:throw new Error("Invalid vector type: SQLNULL");default:throw new Error(`Invalid type id: ${s.typeId}`)}}toArray(){let t=[];for(let e=0;e<this.itemCount;e++)t.push(this.getItem(e));return t}};c.DuckDBVector=h;var li=class i extends h{dataView;validity;vector;_itemCount;constructor(t,e,r,s){super(),this.dataView=t,this.validity=e,this.vector=r,this._itemCount=s}static fromRawVector(t,e){let r=V(t,e*l.default.sizeof_bool),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,e)}get type(){return D.DuckDBBooleanType.instance}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?su(this.dataView,t*l.default.sizeof_bool):null}setItem(t,e){e!=null?(pu(this.dataView,t*l.default.sizeof_bool,e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*l.default.sizeof_bool,e*l.default.sizeof_bool),this.validity.slice(t,e),this.vector,e)}};c.DuckDBBooleanVector=li;var di=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Int8Array.BYTES_PER_ELEMENT),s=new Int8Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTinyIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTinyIntVector=di;var hi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Int16Array.BYTES_PER_ELEMENT),s=new Int16Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBSmallIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBSmallIntVector=hi;var fi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Int32Array.BYTES_PER_ELEMENT),s=new Int32Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBIntegerType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBIntegerVector=fi;var mi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBBigIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBBigIntVector=mi;var yi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Uint8Array.BYTES_PER_ELEMENT),s=new Uint8Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBUTinyIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBUTinyIntVector=yi;var pi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Uint16Array.BYTES_PER_ELEMENT),s=new Uint16Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBUSmallIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBUSmallIntVector=pi;var Di=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Uint32Array.BYTES_PER_ELEMENT),s=new Uint32Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBUIntegerType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBUIntegerVector=Di;var Ti=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigUint64Array.BYTES_PER_ELEMENT),s=new BigUint64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBUBigIntType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBUBigIntVector=Ti;var gi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Float32Array.BYTES_PER_ELEMENT),s=new Float32Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBFloatType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBFloatVector=gi;var wi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Float64Array.BYTES_PER_ELEMENT),s=new Float64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBDoubleType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.items[t]:null}setItem(t,e){e!=null?(this.items[t]=e,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBDoubleVector=wi;var _i=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimestampType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimestampValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.micros,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimestampVector=_i;var Ii=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*Int32Array.BYTES_PER_ELEMENT),s=new Int32Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBDateType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBDateValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.days,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBDateVector=Ii;var Bi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimeType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimeValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.micros,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimeVector=Bi;var Vi=class i extends h{dataView;validity;vector;_itemCount;constructor(t,e,r,s){super(),this.dataView=t,this.validity=e,this.vector=r,this._itemCount=s}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,e)}get type(){return D.DuckDBIntervalType.instance}get itemCount(){return this._itemCount}getItem(t){if(!this.validity.itemValid(t))return null;let e=t*16,r=ci(this.dataView,e),s=ci(this.dataView,e+4),n=zi(this.dataView,e+8);return new A.DuckDBIntervalValue(r,s,n)}setItem(t,e){if(e!=null){let r=t*16;Br(this.dataView,r,e.months),Br(this.dataView,r+4,e.days),Ws(this.dataView,r+8,e.micros),this.validity.setItemValid(t,!0)}else this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,e)}};c.DuckDBIntervalVector=Vi;var ki=class i extends h{dataView;validity;vector;_itemCount;constructor(t,e,r,s){super(),this.dataView=t,this.validity=e,this.vector=r,this._itemCount=s}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,e)}get type(){return D.DuckDBHugeIntType.instance}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?Jt(this.dataView,t*16):null}getDouble(t){return this.validity.itemValid(t)?l.default.hugeint_to_double(Jt(this.dataView,t*16)):null}setItem(t,e){e!=null?(Vr(this.dataView,t*16,e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,e)}};c.DuckDBHugeIntVector=ki;var vi=class i extends h{dataView;validity;vector;_itemCount;constructor(t,e,r,s){super(),this.dataView=t,this.validity=e,this.vector=r,this._itemCount=s}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,e)}get type(){return D.DuckDBUHugeIntType.instance}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?Js(this.dataView,t*16):null}getDouble(t){return this.validity.itemValid(t)?l.default.uhugeint_to_double(Js(this.dataView,t*16)):null}setItem(t,e){e!=null?(lu(this.dataView,t*16,e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,e)}};c.DuckDBUHugeIntVector=vi;var bi=class i extends h{dataView;validity;vector;itemOffset;_itemCount;itemCache;itemCacheDirty;constructor(t,e,r,s,n){super(),this.dataView=t,this.validity=e,this.vector=r,this.itemOffset=s,this._itemCount=n,this.itemCache=[],this.itemCacheDirty=[]}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,0,e)}get type(){return D.DuckDBVarCharType.instance}get itemCount(){return this._itemCount}getItem(t){let e=this.itemCache[t];if(e!==void 0)return e;let r=this.validity.itemValid(t)?Ja(this.dataView,t*16):null;return this.itemCache[t]=r,r}setItem(t,e){this.itemCache[t]=e,this.validity.setItemValid(t,e!=null),this.itemCacheDirty[t]=!0}flush(){for(let t=0;t<this._itemCount;t++)if(this.itemCacheDirty[t]){let e=this.itemCache[t];e!=null&&l.default.vector_assign_string_element(this.vector,this.itemOffset+t,e),this.itemCacheDirty[t]=!1}this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,t,e)}};c.DuckDBVarCharVector=bi;var Mi=class i extends h{dataView;validity;vector;itemOffset;_itemCount;itemCache;itemCacheDirty;constructor(t,e,r,s,n){super(),this.dataView=t,this.validity=e,this.vector=r,this.itemOffset=s,this._itemCount=n,this.itemCache=[],this.itemCacheDirty=[]}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,0,e)}get type(){return D.DuckDBBlobType.instance}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?new A.DuckDBBlobValue(Qa(this.dataView,t*16)):null}setItem(t,e){this.itemCache[t]=e,this.validity.setItemValid(t,e!=null),this.itemCacheDirty[t]=!0}flush(){for(let t=0;t<this._itemCount;t++)if(this.itemCacheDirty[t]){let e=this.itemCache[t];e!=null&&l.default.vector_assign_string_element_len(this.vector,this.itemOffset+t,e.bytes),this.itemCacheDirty[t]=!1}this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,t,e)}};c.DuckDBBlobVector=Mi;var Si=class i extends h{decimalType;dataView;validity;vector;_itemCount;constructor(t,e,r,s,n){super(),this.decimalType=t,this.dataView=e,this.validity=r,this.vector=s,this._itemCount=n}static fromRawVector(t,e,r){let s=V(e,r*2),n=new DataView(s.buffer,s.byteOffset,s.byteLength),u=T.fromVector(e,r);return new i(t,n,u,e,r)}get type(){return this.decimalType}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?Du(this.dataView,t*2,this.decimalType):null}getScaledValue(t){return this.validity.itemValid(t)?Ks(this.dataView,t*2):null}setItem(t,e){e!=null?(au(this.dataView,t*2,Number(e.value)),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.decimalType,new DataView(this.dataView.buffer,this.dataView.byteOffset+t*2,e*2),this.validity.slice(t,e),this.vector,e)}};c.DuckDBDecimal16Vector=Si;var Ei=class i extends h{decimalType;dataView;validity;vector;_itemCount;constructor(t,e,r,s,n){super(),this.decimalType=t,this.dataView=e,this.validity=r,this.vector=s,this._itemCount=n}static fromRawVector(t,e,r){let s=V(e,r*4),n=new DataView(s.buffer,s.byteOffset,s.byteLength),u=T.fromVector(e,r);return new i(t,n,u,e,r)}get type(){return this.decimalType}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?Tu(this.dataView,t*4,this.decimalType):null}getScaledValue(t){return this.validity.itemValid(t)?ci(this.dataView,t*4):null}setItem(t,e){e!=null?(Br(this.dataView,t*4,Number(e.value)),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.decimalType,new DataView(this.dataView.buffer,this.dataView.byteOffset+t*4,e*4),this.validity.slice(t,e),this.vector,e)}};c.DuckDBDecimal32Vector=Ei;var Ni=class i extends h{decimalType;dataView;validity;vector;_itemCount;constructor(t,e,r,s,n){super(),this.decimalType=t,this.dataView=e,this.validity=r,this.vector=s,this._itemCount=n}static fromRawVector(t,e,r){let s=V(e,r*8),n=new DataView(s.buffer,s.byteOffset,s.byteLength),u=T.fromVector(e,r);return new i(t,n,u,e,r)}get type(){return this.decimalType}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?gu(this.dataView,t*8,this.decimalType):null}getScaledValue(t){return this.validity.itemValid(t)?zi(this.dataView,t*8):null}setItem(t,e){e!=null?(Ws(this.dataView,t*8,e.value),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.decimalType,new DataView(this.dataView.buffer,this.dataView.byteOffset+t*8,e*8),this.validity.slice(t,e),this.vector,e)}};c.DuckDBDecimal64Vector=Ni;var Ai=class i extends h{decimalType;dataView;validity;vector;_itemCount;constructor(t,e,r,s,n){super(),this.decimalType=t,this.dataView=e,this.validity=r,this.vector=s,this._itemCount=n}static fromRawVector(t,e,r){let s=V(e,r*16),n=new DataView(s.buffer,s.byteOffset,s.byteLength),u=T.fromVector(e,r);return new i(t,n,u,e,r)}get type(){return this.decimalType}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?wu(this.dataView,t*16,this.decimalType):null}getScaledValue(t){return this.validity.itemValid(t)?Jt(this.dataView,t*16):null}setItem(t,e){e!=null?(Vr(this.dataView,t*16,e.value),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.decimalType,new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,e)}};c.DuckDBDecimal128Vector=Ai;var Ri=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimestampSecondsType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimestampSecondsValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.seconds,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimestampSecondsVector=Ri;var Ci=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimestampMillisecondsType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimestampMillisecondsValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.millis,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimestampMillisecondsVector=Ci;var Li=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimestampNanosecondsType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimestampNanosecondsValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.nanos,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimestampNanosecondsVector=Li;var Oi=class i extends h{enumType;items;validity;vector;constructor(t,e,r,s){super(),this.enumType=t,this.items=e,this.validity=r,this.vector=s}static fromRawVector(t,e,r){let s=V(e,r),n=new Uint8Array(s.buffer,s.byteOffset,r),u=T.fromVector(e,r);return new i(t,n,u,e)}get type(){return this.enumType}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.enumType.values[this.items[t]]:null}setItem(t,e){e!=null?(this.items[t]=this.enumType.indexForValue(e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.enumType,this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBEnum8Vector=Oi;var Ui=class i extends h{enumType;items;validity;vector;constructor(t,e,r,s){super(),this.enumType=t,this.items=e,this.validity=r,this.vector=s}static fromRawVector(t,e,r){let s=V(e,r*2),n=new Uint16Array(s.buffer,s.byteOffset,r),u=T.fromVector(e,r);return new i(t,n,u,e)}get type(){return this.enumType}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.enumType.values[this.items[t]]:null}setItem(t,e){e!=null?(this.items[t]=this.enumType.indexForValue(e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.enumType,this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBEnum16Vector=Ui;var Pi=class i extends h{enumType;items;validity;vector;constructor(t,e,r,s){super(),this.enumType=t,this.items=e,this.validity=r,this.vector=s}static fromRawVector(t,e,r){let s=V(e,r*4),n=new Uint32Array(s.buffer,s.byteOffset,r),u=T.fromVector(e,r);return new i(t,n,u,e)}get type(){return this.enumType}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?this.enumType.values[this.items[t]]:null}setItem(t,e){e!=null?(this.items[t]=this.enumType.indexForValue(e),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.enumType,this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBEnum32Vector=Pi;var Qt=class i extends h{parentList;listType;entryData;validity;vector;childData;itemOffset;_itemCount;itemCache;constructor(t,e,r,s,n,u,o,g){super(),this.parentList=t,this.listType=e,this.entryData=r,this.validity=s,this.vector=n,this.childData=u,this.itemOffset=o,this._itemCount=g,this.itemCache=[]}static fromRawVector(t,e,r){let s=V(e,r*BigUint64Array.BYTES_PER_ELEMENT*2),n=new BigUint64Array(s.buffer,s.byteOffset,r*2),u=T.fromVector(e,r),o=l.default.list_vector_get_child(e),g=l.default.list_vector_get_size(e),j=h.create(o,g,t.valueType);return new i(null,t,n,u,e,j,0,r)}get type(){return this.listType}get itemCount(){return this._itemCount}getItemVector(t){if(!this.validity.itemValid(t))return null;let e=t*2,r=Number(this.entryData[e]),s=Number(this.entryData[e+1]);return this.childData.slice(r,s)}getItem(t){let e=this.itemCache[t];if(e!==void 0)return e;let r=this.getItemVector(t);if(!r)return null;let s=new A.DuckDBListValue(r.toArray());return this.itemCache[t]=s,s}setItem(t,e){this.itemCache[t]=e,this.parentList?this.parentList.setItem(this.itemOffset+t,e):this.validity.setItemValid(t,e!=null)}flush(){if(this.parentList){this.parentList.flush();for(let t=0;t<this.itemCount;t++)this.itemCache[t]=void 0}else{let t=0;for(let n=0;n<this._itemCount;n++){let u=n*2;this.entryData[u]=BigInt(t);let o=this.getItem(n);o?(this.entryData[u+1]=BigInt(o.items.length),t+=o.items.length):this.entryData[u+1]=0n}l.default.list_vector_set_size(this.vector,t);let e=l.default.list_vector_get_child(this.vector),r=l.default.list_vector_get_size(this.vector);this.childData=h.create(e,r,this.listType.valueType);let s=0;for(let n=0;n<this._itemCount;n++){let u=this.getItem(n);if(u)for(let o=0;o<u.items.length;o++)this.childData.setItem(s++,u.items[o])}this.childData.flush(),l.default.copy_data_to_vector(this.vector,0,this.entryData.buffer,this.entryData.byteOffset,this.entryData.byteLength),this.validity.flush(this.vector)}}slice(t,e){let r=t*2;return new i(this,this.listType,this.entryData.slice(r,r+e*2),this.validity.slice(t,e),this.vector,this.childData,t,e)}};c.DuckDBListVector=Qt;var yt=class i extends h{structType;_itemCount;entryVectors;validity;vector;constructor(t,e,r,s,n){super(),this.structType=t,this._itemCount=e,this.entryVectors=r,this.validity=s,this.vector=n}static fromRawVector(t,e,r){let s=t.entryCount,n=[];for(let o=0;o<s;o++){let g=l.default.struct_vector_get_child(e,o);n.push(h.create(g,r,t.entryTypes[o]))}let u=T.fromVector(e,r);return new i(t,r,n,u,e)}get type(){return this.structType}get itemCount(){return this._itemCount}getItem(t){if(!this.validity.itemValid(t))return null;let e={},r=this.structType.entryCount;for(let s=0;s<r;s++)e[this.structType.entryNames[s]]=this.entryVectors[s].getItem(t);return new A.DuckDBStructValue(e)}getItemValue(t,e){return this.validity.itemValid(t)?this.entryVectors[e].getItem(t):null}setItem(t,e){if(e!=null){let r=this.structType.entryCount;for(let s=0;s<r;s++)this.entryVectors[s].setItem(t,e.entries[this.structType.entryNames[s]]);this.validity.setItemValid(t,!0)}else{let r=this.structType.entryCount;for(let s=0;s<r;s++)this.entryVectors[s].setItem(t,null);this.validity.setItemValid(t,!1)}}setItemValue(t,e,r){return this.entryVectors[e].setItem(t,r)}flush(){for(let t of this.entryVectors)t.flush();this.validity.flush(this.vector)}slice(t,e){return new i(this.structType,e,this.entryVectors.map(r=>r.slice(t,e)),this.validity.slice(t,e),this.vector)}};c.DuckDBStructVector=yt;var Fi=class i extends h{mapType;listVector;constructor(t,e){super(),this.mapType=t,this.listVector=e}static fromRawVector(t,e,r){let s=new D.DuckDBListType(new D.DuckDBStructType(["key","value"],[t.keyType,t.valueType]));return new i(t,Qt.fromRawVector(s,e,r))}get type(){return this.mapType}get itemCount(){return this.listVector.itemCount}getItem(t){let e=this.listVector.getItemVector(t);if(!e)return null;if(!(e instanceof yt))throw new Error("item in map list vector is not a struct");let r=[],s=e.itemCount;for(let n=0;n<s;n++){let u=e.getItemValue(n,0),o=e.getItemValue(n,1);r.push({key:u,value:o})}return new A.DuckDBMapValue(r)}setItem(t,e){e!=null?this.listVector.setItem(t,(0,A.listValue)(e.entries.map(r=>(0,A.structValue)({key:r.key,value:r.value})))):this.listVector.setItem(t,null)}flush(){this.listVector.flush()}slice(t,e){return new i(this.mapType,this.listVector.slice(t,e))}};c.DuckDBMapVector=Fi;var qi=class i extends h{arrayType;validity;vector;childData;_itemCount;constructor(t,e,r,s,n){super(),this.arrayType=t,this.validity=e,this.vector=r,this.childData=s,this._itemCount=n}static fromRawVector(t,e,r){let s=T.fromVector(e,r),n=l.default.array_vector_get_child(e),u=i.itemSize(t)*t.length,o=h.create(n,r*u,t.valueType);return new i(t,s,e,o,r)}static itemSize(t){return t.valueType instanceof D.DuckDBArrayType?i.itemSize(t.valueType):1}get type(){return this.arrayType}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?new A.DuckDBArrayValue(this.childData.slice(t*this.arrayType.length,this.arrayType.length).toArray()):null}setItem(t,e){if(e!=null){let r=t*this.arrayType.length;for(let s=0;s<this.arrayType.length;s++)this.childData.setItem(r+s,e.items[s]);this.validity.setItemValid(t,!0)}else{let r=t*this.arrayType.length;for(let s=0;s<this.arrayType.length;s++)this.childData.setItem(r+s,null);this.validity.setItemValid(t,!1)}}flush(){this.childData.flush(),this.validity.flush(this.vector)}slice(t,e){return new i(this.arrayType,this.validity.slice(t,e),this.vector,this.childData.slice(t*this.arrayType.length,e*this.arrayType.length),e)}};c.DuckDBArrayVector=qi;var ji=class i extends h{dataView;validity;vector;_itemCount;constructor(t,e,r,s){super(),this.dataView=t,this.validity=e,this.vector=r,this._itemCount=s}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,e)}get type(){return D.DuckDBUUIDType.instance}get itemCount(){return this._itemCount}getItem(t){return this.validity.itemValid(t)?A.DuckDBUUIDValue.fromStoredHugeInt(Jt(this.dataView,t*16)):null}setItem(t,e){e!=null?(Vr(this.dataView,t*16,e.hugeint),this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,e)}};c.DuckDBUUIDVector=ji;var xi=class i extends h{unionType;structVector;constructor(t,e){super(),this.unionType=t,this.structVector=e}static fromRawVector(t,e,r){let s=["tag"],n=[D.DuckDBUTinyIntType.instance],u=t.memberCount;for(let g=0;g<u;g++)s.push(t.memberTags[g]),n.push(t.memberTypes[g]);let o=new D.DuckDBStructType(s,n);return new i(t,yt.fromRawVector(o,e,r))}get type(){return this.unionType}get itemCount(){return this.structVector.itemCount}getItem(t){let e=this.structVector.getItemValue(t,0);if(e==null)return null;let r=Number(e),s=this.unionType.memberTags[r],n=r+1,u=this.structVector.getItemValue(t,n);return new A.DuckDBUnionValue(s,u)}setItem(t,e){if(e!=null){let r=this.unionType.memberIndexForTag(e.tag);this.structVector.setItemValue(t,0,r);let s=r+1;this.structVector.setItemValue(t,s,e.value);for(let n=1;n<=this.unionType.memberCount;n++)n!==s&&this.structVector.setItemValue(t,n,null)}else for(let r=0;r<=this.unionType.memberCount;r++)this.structVector.setItemValue(t,r,null)}flush(){this.structVector.flush()}slice(t,e){return new i(this.unionType,this.structVector.slice(t,e))}};c.DuckDBUnionVector=xi;var $i=class i extends h{dataView;validity;vector;itemOffset;_itemCount;itemCache;itemCacheDirty;constructor(t,e,r,s,n){super(),this.dataView=t,this.validity=e,this.vector=r,this.itemOffset=s,this._itemCount=n,this.itemCache=[],this.itemCacheDirty=[]}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,0,e)}get type(){return D.DuckDBBitType.instance}get itemCount(){return this._itemCount}getItem(t){if(!this.validity.itemValid(t))return null;let e=Hi(this.dataView,t*16);return e?new A.DuckDBBitValue(e):null}setItem(t,e){this.itemCache[t]=e,this.validity.setItemValid(t,e!=null),this.itemCacheDirty[t]=!0}flush(){for(let t=0;t<this._itemCount;t++)if(this.itemCacheDirty[t]){let e=this.itemCache[t];e!=null&&l.default.vector_assign_string_element_len(this.vector,this.itemOffset+t,e.data),this.itemCacheDirty[t]=!1}this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,t,e)}};c.DuckDBBitVector=$i;var Yi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigUint64Array.BYTES_PER_ELEMENT),s=new BigUint64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimeTZType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?A.DuckDBTimeTZValue.fromBits(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.bits,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimeTZVector=Yi;var Gi=class i extends h{items;validity;vector;constructor(t,e,r){super(),this.items=t,this.validity=e,this.vector=r}static fromRawVector(t,e){let r=V(t,e*BigInt64Array.BYTES_PER_ELEMENT),s=new BigInt64Array(r.buffer,r.byteOffset,e),n=T.fromVector(t,e);return new i(s,n,t)}get type(){return D.DuckDBTimestampTZType.instance}get itemCount(){return this.items.length}getItem(t){return this.validity.itemValid(t)?new A.DuckDBTimestampTZValue(this.items[t]):null}setItem(t,e){e!=null?(this.items[t]=e.micros,this.validity.setItemValid(t,!0)):this.validity.setItemValid(t,!1)}flush(){l.default.copy_data_to_vector(this.vector,0,this.items.buffer,this.items.byteOffset,this.items.byteLength),this.validity.flush(this.vector)}slice(t,e){return new i(this.items.slice(t,t+e),this.validity.slice(t,e),this.vector)}};c.DuckDBTimestampTZVector=Gi;var Zi=class i extends h{dataView;validity;vector;itemOffset;_itemCount;itemCache;itemCacheDirty;constructor(t,e,r,s,n){super(),this.dataView=t,this.validity=e,this.vector=r,this.itemOffset=s,this._itemCount=n,this.itemCache=[],this.itemCacheDirty=[]}static fromRawVector(t,e){let r=V(t,e*16),s=new DataView(r.buffer,r.byteOffset,r.byteLength),n=T.fromVector(t,e);return new i(s,n,t,0,e)}get type(){return D.DuckDBVarIntType.instance}get itemCount(){return this._itemCount}getItem(t){if(!this.validity.itemValid(t))return null;let e=Hi(this.dataView,t*16);return e?Ka(e):null}setItem(t,e){this.itemCache[t]=e,this.validity.setItemValid(t,e!=null),this.itemCacheDirty[t]=!0}flush(){for(let t=0;t<this._itemCount;t++)if(this.itemCacheDirty[t]){let e=this.itemCache[t];e!=null&&l.default.vector_assign_string_element_len(this.vector,this.itemOffset+t,Wa(e)),this.itemCacheDirty[t]=!1}this.validity.flush(this.vector)}slice(t,e){return new i(new DataView(this.dataView.buffer,this.dataView.byteOffset+t*16,e*16),this.validity.slice(t,e),this.vector,t,e)}};c.DuckDBVarIntVector=Zi});var Ji=d(Dt=>{"use strict";var _u=Dt&&Dt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.DuckDBDataChunk=void 0;var pt=_u(M()),Iu=kr(),vr=class i{chunk;vectors=[];constructor(t){this.chunk=t}static create(t,e){let r=new i(pt.default.create_data_chunk(t.map(s=>s.toLogicalType().logical_type)));return e!=null&&(r.rowCount=e),r}reset(){pt.default.data_chunk_reset(this.chunk)}get columnCount(){return pt.default.data_chunk_get_column_count(this.chunk)}get rowCount(){return pt.default.data_chunk_get_size(this.chunk)}set rowCount(t){pt.default.data_chunk_set_size(this.chunk,t)}getColumnVector(t){if(this.vectors[t])return this.vectors[t];let e=Iu.DuckDBVector.create(pt.default.data_chunk_get_vector(this.chunk,t),this.rowCount);return this.vectors[t]=e,e}visitColumnValues(t,e){let r=this.getColumnVector(t),s=r.type;for(let n=0;n<r.itemCount;n++)e(r.getItem(n),n,t,s)}getColumnValues(t){let e=[];return this.visitColumnValues(t,r=>e.push(r)),e}convertColumnValues(t,e){let r=[],s=this.getColumnVector(t).type;return this.visitColumnValues(t,n=>r.push(e.convertValue(n,s))),r}setColumnValues(t,e){let r=this.getColumnVector(t);if(r.itemCount!==e.length)throw new Error("number of values must equal chunk row count");for(let s=0;s<e.length;s++)r.setItem(s,e[s]);r.flush()}visitColumns(t){let e=this.columnCount;for(let r=0;r<e;r++)t(this.getColumnValues(r),r,this.getColumnVector(r).type)}getColumns(){let t=[];return this.visitColumns(e=>t.push(e)),t}convertColumns(t){let e=[],r=this.columnCount;for(let s=0;s<r;s++)e.push(this.convertColumnValues(s,t));return e}setColumns(t){t.length>0&&(this.rowCount=t[0].length);for(let e=0;e<t.length;e++)this.setColumnValues(e,t[e])}visitColumnMajor(t){let e=this.columnCount;for(let r=0;r<e;r++)this.visitColumnValues(r,t)}visitRowValues(t,e){let r=this.columnCount;for(let s=0;s<r;s++){let n=this.getColumnVector(s);e(n.getItem(t),t,s,n.type)}}getRowValues(t){let e=[];return this.visitRowValues(t,r=>e.push(r)),e}convertRowValues(t,e){let r=[];return this.visitRowValues(t,(s,n,u)=>r.push(e.convertValue(s,this.getColumnVector(u).type))),r}visitRows(t){let e=this.rowCount;for(let r=0;r<e;r++)t(this.getRowValues(r),r)}getRows(){let t=[];return this.visitRows(e=>t.push(e)),t}convertRows(t){let e=[],r=this.rowCount;for(let s=0;s<r;s++)e.push(this.convertRowValues(s,t));return e}setRows(t){this.rowCount=t.length;let e=this.columnCount;for(let r=0;r<e;r++){let s=this.getColumnVector(r);for(let n=0;n<t.length;n++)s.setItem(n,t[n][r]);s.flush()}}visitRowMajor(t){let e=this.rowCount,r=this.columnCount;for(let s=0;s<e;s++)for(let n=0;n<r;n++){let u=this.getColumnVector(n);t(u.getItem(s),s,n,u.type)}}};Dt.DuckDBDataChunk=vr});var Ki=d(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.DuckDBValueToJsonConverter=void 0;var v=W(),Tt=ut(),br=class i{static default=new i;convertValue(t,e){if(t==null)return null;switch(e.typeId){case v.DuckDBTypeId.BOOLEAN:return!!t;case v.DuckDBTypeId.TINYINT:case v.DuckDBTypeId.SMALLINT:case v.DuckDBTypeId.INTEGER:case v.DuckDBTypeId.UTINYINT:case v.DuckDBTypeId.USMALLINT:case v.DuckDBTypeId.UINTEGER:return Number(t);case v.DuckDBTypeId.FLOAT:case v.DuckDBTypeId.DOUBLE:return Number.isFinite(t)?Number(t):String(t);case v.DuckDBTypeId.BIGINT:case v.DuckDBTypeId.UBIGINT:case v.DuckDBTypeId.HUGEINT:case v.DuckDBTypeId.UHUGEINT:return String(t);case v.DuckDBTypeId.DATE:case v.DuckDBTypeId.TIME:case v.DuckDBTypeId.TIMESTAMP:case v.DuckDBTypeId.TIMESTAMP_S:case v.DuckDBTypeId.TIMESTAMP_MS:case v.DuckDBTypeId.TIMESTAMP_NS:case v.DuckDBTypeId.TIME_TZ:case v.DuckDBTypeId.TIMESTAMP_TZ:return String(t);case v.DuckDBTypeId.INTERVAL:return t instanceof Tt.DuckDBIntervalValue?{months:t.months,days:t.days,micros:String(t.micros)}:null;case v.DuckDBTypeId.VARCHAR:case v.DuckDBTypeId.BLOB:case v.DuckDBTypeId.BIT:return String(t);case v.DuckDBTypeId.DECIMAL:case v.DuckDBTypeId.VARINT:return String(t);case v.DuckDBTypeId.ENUM:return String(t);case v.DuckDBTypeId.LIST:return t instanceof Tt.DuckDBListValue?t.items.map(r=>this.convertValue(r,e.valueType)):null;case v.DuckDBTypeId.STRUCT:if(t instanceof Tt.DuckDBStructValue){let r={};for(let s in t.entries)r[s]=this.convertValue(t.entries[s],e.typeForEntry(s));return r}return null;case v.DuckDBTypeId.MAP:return t instanceof Tt.DuckDBMapValue?t.entries.map(r=>({key:this.convertValue(r.key,e.keyType),value:this.convertValue(r.value,e.valueType)})):null;case v.DuckDBTypeId.ARRAY:return t instanceof Tt.DuckDBArrayValue?t.items.map(r=>this.convertValue(r,e.valueType)):null;case v.DuckDBTypeId.UNION:return t instanceof Tt.DuckDBUnionValue?{tag:t.tag,value:this.convertValue(t.value,e.memberTypeForTag(t.tag))}:null;case v.DuckDBTypeId.UUID:return String(t)}return null}};Qi.DuckDBValueToJsonConverter=br});var Sr=d(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.convertColumnsFromChunks=Bu;function Bu(i,t){if(i.length===0)return[];let e=i[0].convertColumns(t);for(let r=1;r<i.length;r++)for(let s=0;s<e.length;s++)i[r].visitColumnValues(s,(u,o,g,j)=>e[s].push(t.convertValue(u,j)));return e}});var Nr=d(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.convertColumnsObjectFromChunks=Vu;function Vu(i,t,e){let r={};for(let n of t)r[n]=[];if(i.length===0)return r;let s=i[0].columnCount;for(let n=0;n<i.length;n++)for(let u=0;u<s;u++)i[n].visitColumnValues(u,(o,g,j,K)=>r[t[u]].push(e.convertValue(o,K)));return r}});var Rr=d(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.convertRowObjectsFromChunks=ku;function ku(i,t,e){let r=[];for(let s of i){let n=s.rowCount;for(let u=0;u<n;u++){let o={};s.visitRowValues(u,(g,j,K,fn)=>{o[t[K]]=e.convertValue(g,fn)}),r.push(o)}}return r}});var Lr=d(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.convertRowsFromChunks=vu;function vu(i,t){let e=[];for(let r of i){let s=r.rowCount;for(let n=0;n<s;n++)e.push(r.convertRowValues(n,t))}return e}});var Ur=d(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.getColumnsFromChunks=bu;function bu(i){let t=[];if(i.length===0)return t;i[0].visitColumns(e=>t.push(e));for(let e=1;e<i.length;e++)for(let r=0;r<t.length;r++)i[e].visitColumnValues(r,s=>t[r].push(s));return t}});var Fr=d(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.getColumnsObjectFromChunks=Mu;function Mu(i,t){let e={};for(let s of t)e[s]=[];if(i.length===0)return e;let r=i[0].columnCount;for(let s=0;s<i.length;s++)for(let n=0;n<r;n++)i[s].visitColumnValues(n,u=>e[t[n]].push(u));return e}});var jr=d(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.getRowObjectsFromChunks=Su;function Su(i,t){let e=[];for(let r of i){let s=r.rowCount;for(let n=0;n<s;n++){let u={};r.visitRowValues(n,(o,g,j)=>{u[t[j]]=o}),e.push(u)}}return e}});var $r=d(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.getRowsFromChunks=Eu;function Eu(i){let t=[];for(let e of i)e.visitRows(r=>t.push(r));return t}});var Kt=d(gt=>{"use strict";var Nu=gt&&gt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(gt,"__esModule",{value:!0});gt.DuckDBResult=void 0;var $=Nu(M()),Au=Ji(),Xs=ot(),Wi=Ki(),Ru=Sr(),Cu=Nr(),Lu=Rr(),Ou=Lr(),Uu=Ur(),Pu=Fr(),Fu=jr(),qu=$r(),Yr=class{result;constructor(t){this.result=t}get returnType(){return $.default.result_return_type(this.result)}get statementType(){return $.default.result_statement_type(this.result)}get columnCount(){return $.default.column_count(this.result)}columnName(t){return $.default.column_name(this.result,t)}columnNames(){let t=[],e=this.columnCount;for(let r=0;r<e;r++)t.push(this.columnName(r));return t}deduplicatedColumnNames(){let t=[],e=this.columnCount,r={};for(let s=0;s<e;s++){let n=this.columnName(s),u=(r[n]||0)+1;r[n]=u,u>1?t.push(`${n}:${u-1}`):t.push(n)}return t}columnTypeId(t){return $.default.column_type(this.result,t)}columnLogicalType(t){return Xs.DuckDBLogicalType.create($.default.column_logical_type(this.result,t))}columnType(t){return Xs.DuckDBLogicalType.create($.default.column_logical_type(this.result,t)).asType()}columnTypes(){let t=[],e=this.columnCount;for(let r=0;r<e;r++)t.push(this.columnType(r));return t}get isStreaming(){return $.default.result_is_streaming(this.result)}get rowsChanged(){return $.default.rows_changed(this.result)}async fetchChunk(){let t=await $.default.fetch_chunk(this.result);return t?new Au.DuckDBDataChunk(t):null}async fetchAllChunks(){let t=[];for(;;){let e=await this.fetchChunk();if(!e||e.rowCount===0)return t;t.push(e)}}async getColumns(){let t=await this.fetchAllChunks();return(0,Uu.getColumnsFromChunks)(t)}async getColumnsJson(){let t=await this.fetchAllChunks();return(0,Ru.convertColumnsFromChunks)(t,Wi.DuckDBValueToJsonConverter.default)}async getColumnsObject(){let t=await this.fetchAllChunks();return(0,Pu.getColumnsObjectFromChunks)(t,this.deduplicatedColumnNames())}async getColumnsObjectJson(){let t=await this.fetchAllChunks();return(0,Cu.convertColumnsObjectFromChunks)(t,this.deduplicatedColumnNames(),Wi.DuckDBValueToJsonConverter.default)}async getRows(){let t=await this.fetchAllChunks();return(0,qu.getRowsFromChunks)(t)}async getRowsJson(){let t=await this.fetchAllChunks();return(0,Ou.convertRowsFromChunks)(t,Wi.DuckDBValueToJsonConverter.default)}async getRowObjects(){let t=await this.fetchAllChunks();return(0,Fu.getRowObjectsFromChunks)(t,this.deduplicatedColumnNames())}async getRowObjectsJson(){let t=await this.fetchAllChunks();return(0,Lu.convertRowObjectsFromChunks)(t,this.deduplicatedColumnNames(),Wi.DuckDBValueToJsonConverter.default)}};gt.DuckDBResult=Yr});var Wt=d(wt=>{"use strict";var ju=wt&&wt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(wt,"__esModule",{value:!0});wt.DuckDBMaterializedResult=void 0;var Gr=ju(M()),xu=Ji(),$u=Kt(),Zr=class extends $u.DuckDBResult{constructor(t){super(t)}get rowCount(){return Gr.default.row_count(this.result)}get chunkCount(){return Gr.default.result_chunk_count(this.result)}getChunk(t){return new xu.DuckDBDataChunk(Gr.default.result_get_chunk(this.result,t))}};wt.DuckDBMaterializedResult=Zr});var tn=d(Xt=>{"use strict";var Yu=Xt&&Xt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.createResult=Hu;var Gu=Yu(M()),Zu=Wt(),zu=Kt();function Hu(i){return Gu.default.result_is_streaming(i)?new zu.DuckDBResult(i):new Zu.DuckDBMaterializedResult(i)}});var er=d(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.DuckDBResultReader=void 0;var Ju=Sr(),Qu=Nr(),Ku=Rr(),Wu=Lr(),Xi=Ki(),Xu=Ur(),tc=Fr(),ec=jr(),ic=$r(),zr=class{result;chunks;chunkSizeRuns;currentRowCount_;done_;constructor(t){this.result=t,this.chunks=[],this.chunkSizeRuns=[],this.currentRowCount_=0,this.done_=!1}get returnType(){return this.result.returnType}get statementType(){return this.result.statementType}get columnCount(){return this.result.columnCount}columnName(t){return this.result.columnName(t)}columnNames(){return this.result.columnNames()}deduplicatedColumnNames(){return this.result.deduplicatedColumnNames()}columnTypeId(t){return this.result.columnTypeId(t)}columnLogicalType(t){return this.result.columnLogicalType(t)}columnType(t){return this.result.columnType(t)}columnTypes(){return this.result.columnTypes()}get rowsChanged(){return this.result.rowsChanged}get currentRowCount(){return this.currentRowCount_}get done(){return this.done_}value(t,e){if(this.currentRowCount_===0)throw Error("No rows have been read");let r=0,s=e;for(let n of this.chunkSizeRuns){if(s<n.rowCount){r+=Math.floor(s/n.chunkSize);let u=s%n.chunkSize;return this.chunks[r].getColumnVector(t).getItem(u)}r+=n.chunkCount,s-=n.rowCount}throw Error(`Row index ${e} requested, but only ${this.currentRowCount_} row have been read so far.`)}async readAll(){return this.fetchChunks()}async readUntil(t){return this.fetchChunks(t)}async fetchChunks(t){for(;!(this.done_||t!==void 0&&this.currentRowCount_>=t);){let e=await this.result.fetchChunk();e&&e.rowCount>0?(this.updateChunkSizeRuns(e),this.chunks.push(e),this.currentRowCount_+=e.rowCount):this.done_=!0}}updateChunkSizeRuns(t){if(this.chunkSizeRuns.length>0){let e=this.chunkSizeRuns[this.chunkSizeRuns.length-1];if(e.chunkSize===t.rowCount){e.chunkCount+=1,e.rowCount+=e.chunkSize;return}}this.chunkSizeRuns.push({chunkCount:1,chunkSize:t.rowCount,rowCount:t.rowCount})}getColumns(){return(0,Xu.getColumnsFromChunks)(this.chunks)}getColumnsJson(){return(0,Ju.convertColumnsFromChunks)(this.chunks,Xi.DuckDBValueToJsonConverter.default)}getColumnsObject(){return(0,tc.getColumnsObjectFromChunks)(this.chunks,this.deduplicatedColumnNames())}getColumnsObjectJson(){return(0,Qu.convertColumnsObjectFromChunks)(this.chunks,this.deduplicatedColumnNames(),Xi.DuckDBValueToJsonConverter.default)}getRows(){return(0,ic.getRowsFromChunks)(this.chunks)}getRowsJson(){return(0,Wu.convertRowsFromChunks)(this.chunks,Xi.DuckDBValueToJsonConverter.default)}getRowObjects(){return(0,ec.getRowObjectsFromChunks)(this.chunks,this.deduplicatedColumnNames())}getRowObjectsJson(){return(0,Ku.convertRowObjectsFromChunks)(this.chunks,this.deduplicatedColumnNames(),Xi.DuckDBValueToJsonConverter.default)}};tr.DuckDBResultReader=zr});var Qr=d(z=>{"use strict";var rc=z&&z.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(z,"__esModule",{value:!0});z.DuckDBPendingResult=z.DuckDBPendingResultState=void 0;var lt=rc(M()),sc=tn(),Hr=er(),te;(function(i){i[i.RESULT_READY=0]="RESULT_READY",i[i.RESULT_NOT_READY=1]="RESULT_NOT_READY",i[i.NO_TASKS_AVAILABLE=3]="NO_TASKS_AVAILABLE"})(te||(z.DuckDBPendingResultState=te={}));var Jr=class{pending_result;constructor(t){this.pending_result=t}runTask(){let t=lt.default.pending_execute_task(this.pending_result);switch(t){case lt.default.PendingState.RESULT_READY:return te.RESULT_READY;case lt.default.PendingState.RESULT_NOT_READY:return te.RESULT_NOT_READY;case lt.default.PendingState.ERROR:throw new Error(`Failure running pending result task: ${lt.default.pending_error(this.pending_result)}`);case lt.default.PendingState.NO_TASKS_AVAILABLE:return te.NO_TASKS_AVAILABLE;default:throw new Error(`Unexpected pending state: ${t}`)}}async getResult(){return(0,sc.createResult)(await lt.default.execute_pending(this.pending_result))}async read(){return new Hr.DuckDBResultReader(await this.getResult())}async readAll(){let t=new Hr.DuckDBResultReader(await this.getResult());return await t.readAll(),t}async readUntil(t){let e=new Hr.DuckDBResultReader(await this.getResult());return await e.readUntil(t),e}};z.DuckDBPendingResult=Jr});var en=d(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.typeForValue=dt;var N=ct(),U=ut();function dt(i){if(i===null)return N.SQLNULL;switch(typeof i){case"boolean":return N.BOOLEAN;case"number":return Math.round(i)===i?N.INTEGER:N.DOUBLE;case"bigint":return N.HUGEINT;case"string":return N.VARCHAR;case"object":if(i instanceof U.DuckDBArrayValue)return(0,N.ARRAY)(dt(i.items[0]),i.items.length);if(i instanceof U.DuckDBBitValue)return N.BIT;if(i instanceof U.DuckDBBlobValue)return N.BLOB;if(i instanceof U.DuckDBDateValue)return N.DATE;if(i instanceof U.DuckDBDecimalValue)return(0,N.DECIMAL)(i.width,i.scale);if(i instanceof U.DuckDBIntervalValue)return N.INTERVAL;if(i instanceof U.DuckDBListValue)return(0,N.LIST)(dt(i.items[0]));if(i instanceof U.DuckDBMapValue)return(0,N.MAP)(dt(i.entries[0].key),dt(i.entries[0].value));if(i instanceof U.DuckDBStructValue){let t={};for(let e in i.entries)t[e]=dt(i.entries[e]);return(0,N.STRUCT)(t)}else{if(i instanceof U.DuckDBTimestampMillisecondsValue)return N.TIMESTAMP_MS;if(i instanceof U.DuckDBTimestampNanosecondsValue)return N.TIMESTAMP_NS;if(i instanceof U.DuckDBTimestampSecondsValue)return N.TIMESTAMP_S;if(i instanceof U.DuckDBTimestampTZValue)return N.TIMESTAMPTZ;if(i instanceof U.DuckDBTimestampValue)return N.TIMESTAMP;if(i instanceof U.DuckDBTimeTZValue)return N.TIMETZ;if(i instanceof U.DuckDBTimeValue)return N.TIME;if(i instanceof U.DuckDBUnionValue)return(0,N.UNION)({[i.tag]:dt(i.value)});if(i instanceof U.DuckDBUUIDValue)return N.UUID}break}return N.ANY}});var ir=d(It=>{"use strict";var nc=It&&It.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(It,"__esModule",{value:!0});It.DuckDBPreparedStatement=void 0;var b=nc(M()),ac=gr(),uc=ot(),cc=Wt(),rn=Qr(),oc=Kt(),_t=er(),H=ct(),sn=en(),Wr=class{prepared_statement;constructor(t){this.prepared_statement=t}get statementType(){return b.default.prepared_statement_type(this.prepared_statement)}get parameterCount(){return b.default.nparams(this.prepared_statement)}parameterName(t){return b.default.parameter_name(this.prepared_statement,t)}parameterTypeId(t){return b.default.param_type(this.prepared_statement,t)}parameterType(t){return uc.DuckDBLogicalType.create(b.default.param_logical_type(this.prepared_statement,t)).asType()}clearBindings(){b.default.clear_bindings(this.prepared_statement)}parameterIndex(t){return b.default.bind_parameter_index(this.prepared_statement,t)}bindBoolean(t,e){b.default.bind_boolean(this.prepared_statement,t,e)}bindTinyInt(t,e){b.default.bind_int8(this.prepared_statement,t,e)}bindSmallInt(t,e){b.default.bind_int16(this.prepared_statement,t,e)}bindInteger(t,e){b.default.bind_int32(this.prepared_statement,t,e)}bindBigInt(t,e){b.default.bind_int64(this.prepared_statement,t,e)}bindHugeInt(t,e){b.default.bind_hugeint(this.prepared_statement,t,e)}bindUTinyInt(t,e){b.default.bind_uint8(this.prepared_statement,t,e)}bindUSmallInt(t,e){b.default.bind_uint16(this.prepared_statement,t,e)}bindUInteger(t,e){b.default.bind_uint32(this.prepared_statement,t,e)}bindUBigInt(t,e){b.default.bind_uint64(this.prepared_statement,t,e)}bindUHugeInt(t,e){b.default.bind_uhugeint(this.prepared_statement,t,e)}bindVarInt(t,e){this.bindValue(t,e,H.VARINT)}bindDecimal(t,e){b.default.bind_decimal(this.prepared_statement,t,e)}bindFloat(t,e){b.default.bind_float(this.prepared_statement,t,e)}bindDouble(t,e){b.default.bind_double(this.prepared_statement,t,e)}bindDate(t,e){b.default.bind_date(this.prepared_statement,t,e)}bindTime(t,e){b.default.bind_time(this.prepared_statement,t,e)}bindTimeTZ(t,e){this.bindValue(t,e,H.TIMETZ)}bindTimestamp(t,e){b.default.bind_timestamp(this.prepared_statement,t,e)}bindTimestampTZ(t,e){this.bindValue(t,e,H.TIMESTAMPTZ)}bindTimestampSeconds(t,e){this.bindValue(t,e,H.TIMESTAMP_S)}bindTimestampMilliseconds(t,e){this.bindValue(t,e,H.TIMESTAMP_MS)}bindTimestampNanoseconds(t,e){this.bindValue(t,e,H.TIMESTAMP_NS)}bindInterval(t,e){b.default.bind_interval(this.prepared_statement,t,e)}bindVarchar(t,e){b.default.bind_varchar(this.prepared_statement,t,e)}bindBlob(t,e){b.default.bind_blob(this.prepared_statement,t,e)}bindEnum(t,e,r){this.bindValue(t,e,r)}bindArray(t,e,r){this.bindValue(t,e,r)}bindList(t,e,r){this.bindValue(t,e,r)}bindStruct(t,e,r){this.bindValue(t,e,r)}bindUUID(t,e){this.bindValue(t,e,H.UUID)}bindBit(t,e){this.bindValue(t,e,H.BIT)}bindNull(t){b.default.bind_null(this.prepared_statement,t)}bindValue(t,e,r){b.default.bind_value(this.prepared_statement,t,(0,ac.createValue)(r,e))}bind(t,e){if(Array.isArray(t)){let r=Array.isArray(e);for(let s=0;s<t.length;s++)this.bindValue(s+1,t[s],r?e[s]:(0,sn.typeForValue)(t[s]))}else{let r=e&&!Array.isArray(e);for(let s in t){let n=this.parameterIndex(s),u=r?e[s]:void 0;u===void 0&&(u=(0,sn.typeForValue)(t[s])),this.bindValue(n,t[s],u)}}}async run(){return new cc.DuckDBMaterializedResult(await b.default.execute_prepared(this.prepared_statement))}async runAndRead(){return new _t.DuckDBResultReader(await this.run())}async runAndReadAll(){let t=new _t.DuckDBResultReader(await this.run());return await t.readAll(),t}async runAndReadUntil(t){let e=new _t.DuckDBResultReader(await this.run());return await e.readUntil(t),e}async stream(){return new oc.DuckDBResult(await b.default.execute_prepared_streaming(this.prepared_statement))}async streamAndRead(){return new _t.DuckDBResultReader(await this.stream())}async streamAndReadAll(){let t=new _t.DuckDBResultReader(await this.stream());return await t.readAll(),t}async streamAndReadUntil(t){let e=new _t.DuckDBResultReader(await this.stream());return await e.readUntil(t),e}start(){return new rn.DuckDBPendingResult(b.default.pending_prepared(this.prepared_statement))}startStream(){return new rn.DuckDBPendingResult(b.default.pending_prepared_streaming(this.prepared_statement))}};It.DuckDBPreparedStatement=Wr});var ts=d(Bt=>{"use strict";var lc=Bt&&Bt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.DuckDBExtractedStatements=void 0;var dc=lc(M()),hc=ir(),Xr=class{connection;extracted_statements;statement_count;constructor(t,e,r){this.connection=t,this.extracted_statements=e,this.statement_count=r}get count(){return this.statement_count}async prepare(t){return new hc.DuckDBPreparedStatement(await dc.default.prepare_extracted_statement(this.connection,this.extracted_statements,t))}};Bt.DuckDBExtractedStatements=Xr});var is=d(kt=>{"use strict";var fc=kt&&kt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(kt,"__esModule",{value:!0});kt.DuckDBConnection=void 0;var J=fc(M()),mc=Ir(),yc=ts(),pc=Wt(),Dc=ir(),Vt=er(),es=class{connection;constructor(t){this.connection=t}static async create(t){return t.connect()}close(){return this.disconnect()}disconnect(){return J.default.disconnect(this.connection)}interrupt(){J.default.interrupt(this.connection)}get progress(){return J.default.query_progress(this.connection)}async run(t,e,r){if(e){let s=await this.prepare(t);return s.bind(e,r),s.run()}else return new pc.DuckDBMaterializedResult(await J.default.query(this.connection,t))}async runAndRead(t,e,r){return new Vt.DuckDBResultReader(await this.run(t,e,r))}async runAndReadAll(t,e,r){let s=new Vt.DuckDBResultReader(await this.run(t,e,r));return await s.readAll(),s}async runAndReadUntil(t,e,r,s){let n=new Vt.DuckDBResultReader(await this.run(t,r,s));return await n.readUntil(e),n}async stream(t,e,r){let s=await this.prepare(t);return e&&s.bind(e,r),s.stream()}async streamAndRead(t,e,r){return new Vt.DuckDBResultReader(await this.stream(t,e,r))}async streamAndReadAll(t,e,r){let s=new Vt.DuckDBResultReader(await this.stream(t,e,r));return await s.readAll(),s}async streamAndReadUntil(t,e,r,s){let n=new Vt.DuckDBResultReader(await this.stream(t,r,s));return await n.readUntil(e),n}async start(t,e,r){let s=await this.prepare(t);return e&&s.bind(e,r),s.start()}async startStream(t,e,r){let s=await this.prepare(t);return e&&s.bind(e,r),s.startStream()}async prepare(t){return new Dc.DuckDBPreparedStatement(await J.default.prepare(this.connection,t))}async extractStatements(t){let{extracted_statements:e,statement_count:r}=await J.default.extract_statements(this.connection,t);if(r===0)throw new Error(`Failed to extract statements: ${J.default.extract_statements_error(e)}`);return new yc.DuckDBExtractedStatements(this.connection,e,r)}async createAppender(t,e,r){return new mc.DuckDBAppender(J.default.appender_create_ext(this.connection,r??null,e??null,t))}};kt.DuckDBConnection=es});var nn=d(vt=>{"use strict";var Tc=vt&&vt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(vt,"__esModule",{value:!0});vt.DuckDBInstance=void 0;var ee=Tc(M()),gc=is(),rs=class i{db;constructor(t){this.db=t}static async create(t,e){let r=ee.default.create_config();if(ee.default.set_config(r,"duckdb_api","node-neo-api"),e)for(let s in e){let n=String(e[s]);ee.default.set_config(r,s,n)}return new i(await ee.default.open(t,r))}async connect(){return new gc.DuckDBConnection(await ee.default.connect(this.db))}};vt.DuckDBInstance=rs});var un=d(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0})});var on=d(ie=>{"use strict";var wc=ie&&ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ie,"__esModule",{value:!0});ie.configurationOptionDescriptions=_c;var cn=wc(M());function _c(){let i={},t=cn.default.config_count();for(let e=0;e<t;e++){let{name:r,description:s}=cn.default.get_config_flag(e);i[r]=s}return i}});var dn=d(Q=>{"use strict";var Ic=Q&&Q.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Q,"__esModule",{value:!0});Q.StatementType=Q.ResultReturnType=void 0;var ln=Ic(M());Q.ResultReturnType=ln.default.ResultType;Q.StatementType=ln.default.StatementType});var hn=d(re=>{"use strict";var Bc=re&&re.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(re,"__esModule",{value:!0});re.version=kc;var Vc=Bc(M());function kc(){return Vc.default.library_version()}});var vc=exports&&exports.__createBinding||(Object.create?function(i,t,e,r){r===void 0&&(r=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(i,r,s)}:function(i,t,e,r){r===void 0&&(r=e),i[r]=t[e]}),L=exports&&exports.__exportStar||function(i,t){for(var e in i)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&vc(t,i,e)};Object.defineProperty(exports,"__esModule",{value:!0});exports.double_to_uhugeint=exports.uhugeint_to_double=exports.double_to_hugeint=exports.hugeint_to_double=void 0;var rr=M();Object.defineProperty(exports,"hugeint_to_double",{enumerable:!0,get:function(){return rr.hugeint_to_double}});Object.defineProperty(exports,"double_to_hugeint",{enumerable:!0,get:function(){return rr.double_to_hugeint}});Object.defineProperty(exports,"uhugeint_to_double",{enumerable:!0,get:function(){return rr.uhugeint_to_double}});Object.defineProperty(exports,"double_to_uhugeint",{enumerable:!0,get:function(){return rr.double_to_uhugeint}});L(Ir(),exports);L(is(),exports);L(Ji(),exports);L(ts(),exports);L(nn(),exports);L(ot(),exports);L(Wt(),exports);L(Qr(),exports);L(ir(),exports);L(Kt(),exports);L(ct(),exports);L(W(),exports);L(un(),exports);L(Ki(),exports);L(kr(),exports);L(on(),exports);L(dn(),exports);L(ae(),exports);L(ut(),exports);L(hn(),exports);
